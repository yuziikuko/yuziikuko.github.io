<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="/favicon.ico"><title>十一、网络相关面试题讲解 | 郁子IKUKO</title><meta name="description" content="感谢访问郁子IKUKO的个人VuePress站点">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-89c386c5.css" as="style"><link rel="stylesheet" href="/assets/style-89c386c5.css">
    <link rel="modulepreload" href="/assets/app-78203928.js"><link rel="modulepreload" href="/assets/11.html-e6139821.js"><link rel="modulepreload" href="/assets/11.html-f0ef793d.js"><link rel="modulepreload" href="/assets/Node59-13a1e0de.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/aboutMe.html-b9eb5111.js" as="script"><link rel="prefetch" href="/assets/index.html-836bdde0.js" as="script"><link rel="prefetch" href="/assets/00.html-773e226a.js" as="script"><link rel="prefetch" href="/assets/01.html-2f8f4fcf.js" as="script"><link rel="prefetch" href="/assets/02.html-f2b3ae02.js" as="script"><link rel="prefetch" href="/assets/03.html-9e86b915.js" as="script"><link rel="prefetch" href="/assets/04.html-3abc6ad0.js" as="script"><link rel="prefetch" href="/assets/05.html-a3d3af16.js" as="script"><link rel="prefetch" href="/assets/06.html-1d8909e6.js" as="script"><link rel="prefetch" href="/assets/07.html-9f871dd1.js" as="script"><link rel="prefetch" href="/assets/08.html-275e4d85.js" as="script"><link rel="prefetch" href="/assets/09.html-b2a1d38e.js" as="script"><link rel="prefetch" href="/assets/10.html-112851bd.js" as="script"><link rel="prefetch" href="/assets/11.html-e2fef7e1.js" as="script"><link rel="prefetch" href="/assets/00.html-b7cc1a2b.js" as="script"><link rel="prefetch" href="/assets/00.html-a7eb8ffb.js" as="script"><link rel="prefetch" href="/assets/BuildFrames.html-75659998.js" as="script"><link rel="prefetch" href="/assets/Components.html-dcec2de0.js" as="script"><link rel="prefetch" href="/assets/Plugins.html-bd81d6cb.js" as="script"><link rel="prefetch" href="/assets/ProjectFrames.html-7f4d24e8.js" as="script"><link rel="prefetch" href="/assets/Tools.html-17dad07a.js" as="script"><link rel="prefetch" href="/assets/01.html-374c21cd.js" as="script"><link rel="prefetch" href="/assets/02.html-f5e9179b.js" as="script"><link rel="prefetch" href="/assets/01.html-f8a3dbd3.js" as="script"><link rel="prefetch" href="/assets/02.html-9c0d2274.js" as="script"><link rel="prefetch" href="/assets/03.html-e13f4821.js" as="script"><link rel="prefetch" href="/assets/04.html-55fc9acc.js" as="script"><link rel="prefetch" href="/assets/05.html-7757a265.js" as="script"><link rel="prefetch" href="/assets/06.html-19d2e1ff.js" as="script"><link rel="prefetch" href="/assets/07.html-9624ce82.js" as="script"><link rel="prefetch" href="/assets/08.html-2f18919e.js" as="script"><link rel="prefetch" href="/assets/09.html-303785f4.js" as="script"><link rel="prefetch" href="/assets/10.html-eb750852.js" as="script"><link rel="prefetch" href="/assets/11.html-d194b71d.js" as="script"><link rel="prefetch" href="/assets/12.html-73585858.js" as="script"><link rel="prefetch" href="/assets/13.html-e6d2bf1f.js" as="script"><link rel="prefetch" href="/assets/14.html-fad6b9c2.js" as="script"><link rel="prefetch" href="/assets/15.html-fc389f8c.js" as="script"><link rel="prefetch" href="/assets/16.html-f24f69d6.js" as="script"><link rel="prefetch" href="/assets/17.html-3f6d50e2.js" as="script"><link rel="prefetch" href="/assets/18.html-57b9f165.js" as="script"><link rel="prefetch" href="/assets/19.html-1e90c833.js" as="script"><link rel="prefetch" href="/assets/20.html-a1d7df59.js" as="script"><link rel="prefetch" href="/assets/21.html-fa0186b2.js" as="script"><link rel="prefetch" href="/assets/22.html-1b54066e.js" as="script"><link rel="prefetch" href="/assets/23.html-630f8948.js" as="script"><link rel="prefetch" href="/assets/24.html-0dc6353d.js" as="script"><link rel="prefetch" href="/assets/01.html-a12c8884.js" as="script"><link rel="prefetch" href="/assets/02.html-cedc1288.js" as="script"><link rel="prefetch" href="/assets/03.html-6661142b.js" as="script"><link rel="prefetch" href="/assets/04.html-8d07fae8.js" as="script"><link rel="prefetch" href="/assets/01.html-330554e3.js" as="script"><link rel="prefetch" href="/assets/02.html-88624153.js" as="script"><link rel="prefetch" href="/assets/03.html-1fcf9313.js" as="script"><link rel="prefetch" href="/assets/04.html-70313663.js" as="script"><link rel="prefetch" href="/assets/05.html-12b2a269.js" as="script"><link rel="prefetch" href="/assets/06.html-7ba10e49.js" as="script"><link rel="prefetch" href="/assets/07.html-2340c07f.js" as="script"><link rel="prefetch" href="/assets/01.html-7c0d6122.js" as="script"><link rel="prefetch" href="/assets/02.html-305c8fd5.js" as="script"><link rel="prefetch" href="/assets/03.html-b5e6417d.js" as="script"><link rel="prefetch" href="/assets/04.html-aac1fac2.js" as="script"><link rel="prefetch" href="/assets/05.html-3e3a55c8.js" as="script"><link rel="prefetch" href="/assets/01.html-7d856632.js" as="script"><link rel="prefetch" href="/assets/02.html-d68268d6.js" as="script"><link rel="prefetch" href="/assets/03.html-218fed9b.js" as="script"><link rel="prefetch" href="/assets/04.html-2e38b05a.js" as="script"><link rel="prefetch" href="/assets/05.html-b958f23b.js" as="script"><link rel="prefetch" href="/assets/06.html-654fd004.js" as="script"><link rel="prefetch" href="/assets/07.html-dfe3422b.js" as="script"><link rel="prefetch" href="/assets/08.html-1f64b1d7.js" as="script"><link rel="prefetch" href="/assets/09.html-e48b70be.js" as="script"><link rel="prefetch" href="/assets/01.html-bc87d172.js" as="script"><link rel="prefetch" href="/assets/02.html-05ffdc0b.js" as="script"><link rel="prefetch" href="/assets/03.html-4b688697.js" as="script"><link rel="prefetch" href="/assets/04.html-172aeb27.js" as="script"><link rel="prefetch" href="/assets/05.html-7ce48abd.js" as="script"><link rel="prefetch" href="/assets/06.html-a3069710.js" as="script"><link rel="prefetch" href="/assets/07.html-fb4be51d.js" as="script"><link rel="prefetch" href="/assets/08.html-0ba4ba27.js" as="script"><link rel="prefetch" href="/assets/09.html-48f8192f.js" as="script"><link rel="prefetch" href="/assets/10.html-7f80c83f.js" as="script"><link rel="prefetch" href="/assets/11.html-b066bd00.js" as="script"><link rel="prefetch" href="/assets/12.html-ded9b710.js" as="script"><link rel="prefetch" href="/assets/13.html-64fd8776.js" as="script"><link rel="prefetch" href="/assets/14.html-8157deb5.js" as="script"><link rel="prefetch" href="/assets/15.html-8bb54e71.js" as="script"><link rel="prefetch" href="/assets/16.html-93c0d278.js" as="script"><link rel="prefetch" href="/assets/17.html-af2b90ab.js" as="script"><link rel="prefetch" href="/assets/18.html-75e70f82.js" as="script"><link rel="prefetch" href="/assets/19.html-2b8f17de.js" as="script"><link rel="prefetch" href="/assets/20.html-197990ca.js" as="script"><link rel="prefetch" href="/assets/21.html-6fa50a94.js" as="script"><link rel="prefetch" href="/assets/22.html-d10ec451.js" as="script"><link rel="prefetch" href="/assets/23.html-71e10aa8.js" as="script"><link rel="prefetch" href="/assets/24.html-f1c641f1.js" as="script"><link rel="prefetch" href="/assets/25.html-82bca559.js" as="script"><link rel="prefetch" href="/assets/01.html-bd15e5a0.js" as="script"><link rel="prefetch" href="/assets/02.html-4204a68c.js" as="script"><link rel="prefetch" href="/assets/03.html-538f0763.js" as="script"><link rel="prefetch" href="/assets/04.html-fe845aac.js" as="script"><link rel="prefetch" href="/assets/05.html-a75a9419.js" as="script"><link rel="prefetch" href="/assets/01.html-4be5ba86.js" as="script"><link rel="prefetch" href="/assets/02.html-942ec100.js" as="script"><link rel="prefetch" href="/assets/03.html-9dfd73bf.js" as="script"><link rel="prefetch" href="/assets/04.html-5a6be22b.js" as="script"><link rel="prefetch" href="/assets/05.html-15bace98.js" as="script"><link rel="prefetch" href="/assets/06.html-b490c9f9.js" as="script"><link rel="prefetch" href="/assets/07.html-7354a50d.js" as="script"><link rel="prefetch" href="/assets/08.html-04b9fe91.js" as="script"><link rel="prefetch" href="/assets/09.html-adf10ebf.js" as="script"><link rel="prefetch" href="/assets/10.html-35d1a055.js" as="script"><link rel="prefetch" href="/assets/11.html-9772e438.js" as="script"><link rel="prefetch" href="/assets/12.html-70253312.js" as="script"><link rel="prefetch" href="/assets/13.html-ce6b2a25.js" as="script"><link rel="prefetch" href="/assets/14.html-115a3ab3.js" as="script"><link rel="prefetch" href="/assets/15.html-4d1431d6.js" as="script"><link rel="prefetch" href="/assets/16.html-7028fac8.js" as="script"><link rel="prefetch" href="/assets/17.html-0c15016f.js" as="script"><link rel="prefetch" href="/assets/18.html-357ccc4a.js" as="script"><link rel="prefetch" href="/assets/19.html-b20cfded.js" as="script"><link rel="prefetch" href="/assets/20.html-598dcdc2.js" as="script"><link rel="prefetch" href="/assets/21.html-aa5d1de4.js" as="script"><link rel="prefetch" href="/assets/22.html-4c71dda5.js" as="script"><link rel="prefetch" href="/assets/23.html-ef17fa1d.js" as="script"><link rel="prefetch" href="/assets/24.html-68aa099f.js" as="script"><link rel="prefetch" href="/assets/25.html-3ccb36b5.js" as="script"><link rel="prefetch" href="/assets/26.html-c936d0e5.js" as="script"><link rel="prefetch" href="/assets/27.html-d01c62b3.js" as="script"><link rel="prefetch" href="/assets/28.html-c7d4affd.js" as="script"><link rel="prefetch" href="/assets/29.html-2f60a0b8.js" as="script"><link rel="prefetch" href="/assets/30.html-9e069dc1.js" as="script"><link rel="prefetch" href="/assets/31.html-2a685c4e.js" as="script"><link rel="prefetch" href="/assets/32.html-14213afe.js" as="script"><link rel="prefetch" href="/assets/33.html-46af7ddf.js" as="script"><link rel="prefetch" href="/assets/34.html-d0fdc037.js" as="script"><link rel="prefetch" href="/assets/35.html-75661e65.js" as="script"><link rel="prefetch" href="/assets/36.html-ee1eec45.js" as="script"><link rel="prefetch" href="/assets/37.html-16c7843b.js" as="script"><link rel="prefetch" href="/assets/38.html-02761f64.js" as="script"><link rel="prefetch" href="/assets/39.html-3c172a5b.js" as="script"><link rel="prefetch" href="/assets/40.html-f544f44c.js" as="script"><link rel="prefetch" href="/assets/41.html-2480ca92.js" as="script"><link rel="prefetch" href="/assets/01.html-1407344c.js" as="script"><link rel="prefetch" href="/assets/02.html-29f1e540.js" as="script"><link rel="prefetch" href="/assets/03.html-dc099d6b.js" as="script"><link rel="prefetch" href="/assets/04.html-b3aecc2b.js" as="script"><link rel="prefetch" href="/assets/05.html-03ecdbf1.js" as="script"><link rel="prefetch" href="/assets/06.html-0557b5be.js" as="script"><link rel="prefetch" href="/assets/07.html-33e21463.js" as="script"><link rel="prefetch" href="/assets/08.html-9e8c766e.js" as="script"><link rel="prefetch" href="/assets/09.html-a086cd54.js" as="script"><link rel="prefetch" href="/assets/10.html-4faf179b.js" as="script"><link rel="prefetch" href="/assets/11.html-da490c4e.js" as="script"><link rel="prefetch" href="/assets/12.html-defee3b7.js" as="script"><link rel="prefetch" href="/assets/01.html-dc240fdc.js" as="script"><link rel="prefetch" href="/assets/02.html-a0172438.js" as="script"><link rel="prefetch" href="/assets/03.html-f7d7859a.js" as="script"><link rel="prefetch" href="/assets/04.html-5f5d1956.js" as="script"><link rel="prefetch" href="/assets/01.html-7f02eb2d.js" as="script"><link rel="prefetch" href="/assets/02.html-342dd854.js" as="script"><link rel="prefetch" href="/assets/03.html-370fcff1.js" as="script"><link rel="prefetch" href="/assets/04.html-fb84e1a6.js" as="script"><link rel="prefetch" href="/assets/05.html-b4418933.js" as="script"><link rel="prefetch" href="/assets/06.html-31a9db15.js" as="script"><link rel="prefetch" href="/assets/001.html-8debad35.js" as="script"><link rel="prefetch" href="/assets/01.html-fe28fc8b.js" as="script"><link rel="prefetch" href="/assets/02.html-0ccc4554.js" as="script"><link rel="prefetch" href="/assets/03.html-45d80df9.js" as="script"><link rel="prefetch" href="/assets/04.html-d298b41f.js" as="script"><link rel="prefetch" href="/assets/05.html-fba298a2.js" as="script"><link rel="prefetch" href="/assets/06.html-68138f57.js" as="script"><link rel="prefetch" href="/assets/07.html-1d16fd0d.js" as="script"><link rel="prefetch" href="/assets/08.html-bcd4eed0.js" as="script"><link rel="prefetch" href="/assets/09.html-28b4047b.js" as="script"><link rel="prefetch" href="/assets/10.html-77b3cbc7.js" as="script"><link rel="prefetch" href="/assets/11.html-6733c6d5.js" as="script"><link rel="prefetch" href="/assets/12.html-43dcb854.js" as="script"><link rel="prefetch" href="/assets/13.html-e0e12961.js" as="script"><link rel="prefetch" href="/assets/14.html-d5f28e4a.js" as="script"><link rel="prefetch" href="/assets/15.html-8c85aef3.js" as="script"><link rel="prefetch" href="/assets/01.html-d5639094.js" as="script"><link rel="prefetch" href="/assets/02.html-10b018dd.js" as="script"><link rel="prefetch" href="/assets/03.html-24a6f8c6.js" as="script"><link rel="prefetch" href="/assets/04.html-e617d657.js" as="script"><link rel="prefetch" href="/assets/05.html-89eb3e87.js" as="script"><link rel="prefetch" href="/assets/06.html-054b6907.js" as="script"><link rel="prefetch" href="/assets/07.html-e0723c6a.js" as="script"><link rel="prefetch" href="/assets/08.html-1d7e0c4e.js" as="script"><link rel="prefetch" href="/assets/09.html-693044dd.js" as="script"><link rel="prefetch" href="/assets/10.html-16272841.js" as="script"><link rel="prefetch" href="/assets/12.html-ea861d22.js" as="script"><link rel="prefetch" href="/assets/13.html-b1864a96.js" as="script"><link rel="prefetch" href="/assets/14.html-74674071.js" as="script"><link rel="prefetch" href="/assets/15.html-a45f75df.js" as="script"><link rel="prefetch" href="/assets/16.html-8a0927fb.js" as="script"><link rel="prefetch" href="/assets/404.html-f04ced3e.js" as="script"><link rel="prefetch" href="/assets/index.html-486ec3b2.js" as="script"><link rel="prefetch" href="/assets/index.html-1447883c.js" as="script"><link rel="prefetch" href="/assets/index.html-9f9b2bde.js" as="script"><link rel="prefetch" href="/assets/index.html-c17bbc25.js" as="script"><link rel="prefetch" href="/assets/index.html-3ebeff2f.js" as="script"><link rel="prefetch" href="/assets/index.html-53309277.js" as="script"><link rel="prefetch" href="/assets/index.html-db01bc95.js" as="script"><link rel="prefetch" href="/assets/index.html-7ab6628d.js" as="script"><link rel="prefetch" href="/assets/index.html-172d8032.js" as="script"><link rel="prefetch" href="/assets/index.html-d36ccd46.js" as="script"><link rel="prefetch" href="/assets/index.html-77d26d84.js" as="script"><link rel="prefetch" href="/assets/index.html-0a8a3156.js" as="script"><link rel="prefetch" href="/assets/index.html-f9fcdd03.js" as="script"><link rel="prefetch" href="/assets/index.html-eaeaf55e.js" as="script"><link rel="prefetch" href="/assets/index.html-0e4dd527.js" as="script"><link rel="prefetch" href="/assets/index.html-d0c667d0.js" as="script"><link rel="prefetch" href="/assets/index.html-fcffe727.js" as="script"><link rel="prefetch" href="/assets/index.html-10fcf46d.js" as="script"><link rel="prefetch" href="/assets/index.html-e609b71c.js" as="script"><link rel="prefetch" href="/assets/index.html-04a11369.js" as="script"><link rel="prefetch" href="/assets/index.html-d1922e1a.js" as="script"><link rel="prefetch" href="/assets/index.html-c43655ce.js" as="script"><link rel="prefetch" href="/assets/index.html-b67245ca.js" as="script"><link rel="prefetch" href="/assets/index.html-f68d10cb.js" as="script"><link rel="prefetch" href="/assets/index.html-cfb7f412.js" as="script"><link rel="prefetch" href="/assets/index.html-69c2e1ec.js" as="script"><link rel="prefetch" href="/assets/index.html-cff1613f.js" as="script"><link rel="prefetch" href="/assets/index.html-dec8813f.js" as="script"><link rel="prefetch" href="/assets/index.html-745ce1e2.js" as="script"><link rel="prefetch" href="/assets/index.html-e42f371f.js" as="script"><link rel="prefetch" href="/assets/index.html-69d25315.js" as="script"><link rel="prefetch" href="/assets/index.html-66f8ec3f.js" as="script"><link rel="prefetch" href="/assets/index.html-41cfbae3.js" as="script"><link rel="prefetch" href="/assets/index.html-6d03a066.js" as="script"><link rel="prefetch" href="/assets/index.html-4d9a82e4.js" as="script"><link rel="prefetch" href="/assets/index.html-c585c970.js" as="script"><link rel="prefetch" href="/assets/index.html-1807d46c.js" as="script"><link rel="prefetch" href="/assets/index.html-b0ab55f8.js" as="script"><link rel="prefetch" href="/assets/index.html-ef5155e6.js" as="script"><link rel="prefetch" href="/assets/index.html-cf4d1f7c.js" as="script"><link rel="prefetch" href="/assets/index.html-d999584f.js" as="script"><link rel="prefetch" href="/assets/index.html-d6477813.js" as="script"><link rel="prefetch" href="/assets/index.html-b1f56885.js" as="script"><link rel="prefetch" href="/assets/index.html-8a42e456.js" as="script"><link rel="prefetch" href="/assets/index.html-6271d100.js" as="script"><link rel="prefetch" href="/assets/index.html-f87c981b.js" as="script"><link rel="prefetch" href="/assets/index.html-d6be6312.js" as="script"><link rel="prefetch" href="/assets/index.html-fbb51782.js" as="script"><link rel="prefetch" href="/assets/index.html-4fe9d7ec.js" as="script"><link rel="prefetch" href="/assets/index.html-d4dd90c5.js" as="script"><link rel="prefetch" href="/assets/index.html-7d9abe40.js" as="script"><link rel="prefetch" href="/assets/index.html-8549e6d6.js" as="script"><link rel="prefetch" href="/assets/index.html-ddc9db08.js" as="script"><link rel="prefetch" href="/assets/index.html-86cb0b5c.js" as="script"><link rel="prefetch" href="/assets/index.html-4139471e.js" as="script"><link rel="prefetch" href="/assets/index.html-89f511ee.js" as="script"><link rel="prefetch" href="/assets/index.html-8e7427e2.js" as="script"><link rel="prefetch" href="/assets/index.html-866458d4.js" as="script"><link rel="prefetch" href="/assets/index.html-f3f60bc8.js" as="script"><link rel="prefetch" href="/assets/index.html-1c318006.js" as="script"><link rel="prefetch" href="/assets/index.html-e4541426.js" as="script"><link rel="prefetch" href="/assets/index.html-b44e200b.js" as="script"><link rel="prefetch" href="/assets/index.html-bf4a2d22.js" as="script"><link rel="prefetch" href="/assets/index.html-e1272503.js" as="script"><link rel="prefetch" href="/assets/index.html-0b17dc56.js" as="script"><link rel="prefetch" href="/assets/index.html-be88dee5.js" as="script"><link rel="prefetch" href="/assets/index.html-94a8e1d7.js" as="script"><link rel="prefetch" href="/assets/index.html-cfde99b9.js" as="script"><link rel="prefetch" href="/assets/index.html-378c2473.js" as="script"><link rel="prefetch" href="/assets/index.html-027a95cc.js" as="script"><link rel="prefetch" href="/assets/index.html-42feb1d0.js" as="script"><link rel="prefetch" href="/assets/index.html-6f0904ff.js" as="script"><link rel="prefetch" href="/assets/index.html-dec65fa0.js" as="script"><link rel="prefetch" href="/assets/index.html-f5270fa2.js" as="script"><link rel="prefetch" href="/assets/index.html-dd2fae20.js" as="script"><link rel="prefetch" href="/assets/index.html-60df0079.js" as="script"><link rel="prefetch" href="/assets/index.html-1c4c34d6.js" as="script"><link rel="prefetch" href="/assets/index.html-7d761878.js" as="script"><link rel="prefetch" href="/assets/index.html-d7339742.js" as="script"><link rel="prefetch" href="/assets/index.html-ea7a6632.js" as="script"><link rel="prefetch" href="/assets/index.html-92cd749b.js" as="script"><link rel="prefetch" href="/assets/index.html-346a3160.js" as="script"><link rel="prefetch" href="/assets/index.html-308efcdc.js" as="script"><link rel="prefetch" href="/assets/index.html-c753ec2d.js" as="script"><link rel="prefetch" href="/assets/index.html-d9745392.js" as="script"><link rel="prefetch" href="/assets/index.html-e058b54e.js" as="script"><link rel="prefetch" href="/assets/index.html-b8637964.js" as="script"><link rel="prefetch" href="/assets/index.html-d027558d.js" as="script"><link rel="prefetch" href="/assets/index.html-0337e30e.js" as="script"><link rel="prefetch" href="/assets/index.html-814e0476.js" as="script"><link rel="prefetch" href="/assets/index.html-85f1c473.js" as="script"><link rel="prefetch" href="/assets/index.html-a6f64289.js" as="script"><link rel="prefetch" href="/assets/index.html-eee55acd.js" as="script"><link rel="prefetch" href="/assets/index.html-7e00beca.js" as="script"><link rel="prefetch" href="/assets/index.html-2fbdddc6.js" as="script"><link rel="prefetch" href="/assets/index.html-57eea149.js" as="script"><link rel="prefetch" href="/assets/index.html-2ad27254.js" as="script"><link rel="prefetch" href="/assets/index.html-601250f8.js" as="script"><link rel="prefetch" href="/assets/index.html-28fe159e.js" as="script"><link rel="prefetch" href="/assets/index.html-ba49a850.js" as="script"><link rel="prefetch" href="/assets/index.html-46eae5b7.js" as="script"><link rel="prefetch" href="/assets/aboutMe.html-76541cc5.js" as="script"><link rel="prefetch" href="/assets/index.html-7a88ad0e.js" as="script"><link rel="prefetch" href="/assets/00.html-9a1629df.js" as="script"><link rel="prefetch" href="/assets/01.html-431de653.js" as="script"><link rel="prefetch" href="/assets/02.html-b7ae4f1a.js" as="script"><link rel="prefetch" href="/assets/03.html-4c6c3acf.js" as="script"><link rel="prefetch" href="/assets/04.html-6bd86af4.js" as="script"><link rel="prefetch" href="/assets/05.html-7f90f194.js" as="script"><link rel="prefetch" href="/assets/06.html-e30afb2c.js" as="script"><link rel="prefetch" href="/assets/07.html-46d0f88a.js" as="script"><link rel="prefetch" href="/assets/08.html-df9142d0.js" as="script"><link rel="prefetch" href="/assets/09.html-d70664cd.js" as="script"><link rel="prefetch" href="/assets/10.html-4f087b96.js" as="script"><link rel="prefetch" href="/assets/11.html-1d52f77f.js" as="script"><link rel="prefetch" href="/assets/00.html-2779072f.js" as="script"><link rel="prefetch" href="/assets/00.html-4ba51873.js" as="script"><link rel="prefetch" href="/assets/BuildFrames.html-9c02e0dc.js" as="script"><link rel="prefetch" href="/assets/Components.html-eae84385.js" as="script"><link rel="prefetch" href="/assets/Plugins.html-2e2312e1.js" as="script"><link rel="prefetch" href="/assets/ProjectFrames.html-a02310ff.js" as="script"><link rel="prefetch" href="/assets/Tools.html-4da62a19.js" as="script"><link rel="prefetch" href="/assets/01.html-06e60bfa.js" as="script"><link rel="prefetch" href="/assets/02.html-003a2b91.js" as="script"><link rel="prefetch" href="/assets/01.html-20aab63f.js" as="script"><link rel="prefetch" href="/assets/02.html-3c32ce58.js" as="script"><link rel="prefetch" href="/assets/03.html-7b49aba1.js" as="script"><link rel="prefetch" href="/assets/04.html-c30e1c3c.js" as="script"><link rel="prefetch" href="/assets/05.html-99157eb7.js" as="script"><link rel="prefetch" href="/assets/06.html-4ea3542b.js" as="script"><link rel="prefetch" href="/assets/07.html-0c8f84c8.js" as="script"><link rel="prefetch" href="/assets/08.html-c1e0f241.js" as="script"><link rel="prefetch" href="/assets/09.html-2dccf8c4.js" as="script"><link rel="prefetch" href="/assets/10.html-022631b8.js" as="script"><link rel="prefetch" href="/assets/11.html-3303c2ed.js" as="script"><link rel="prefetch" href="/assets/12.html-07cab5a8.js" as="script"><link rel="prefetch" href="/assets/13.html-64e56249.js" as="script"><link rel="prefetch" href="/assets/14.html-b786151f.js" as="script"><link rel="prefetch" href="/assets/15.html-1818a85f.js" as="script"><link rel="prefetch" href="/assets/16.html-2a61ab8e.js" as="script"><link rel="prefetch" href="/assets/17.html-b1f1fdc8.js" as="script"><link rel="prefetch" href="/assets/18.html-e0f95eed.js" as="script"><link rel="prefetch" href="/assets/19.html-d2fb6906.js" as="script"><link rel="prefetch" href="/assets/20.html-e5185c38.js" as="script"><link rel="prefetch" href="/assets/21.html-dc3e4251.js" as="script"><link rel="prefetch" href="/assets/22.html-81e811b3.js" as="script"><link rel="prefetch" href="/assets/23.html-6a2fed6d.js" as="script"><link rel="prefetch" href="/assets/24.html-0e2599c9.js" as="script"><link rel="prefetch" href="/assets/01.html-8a3ba322.js" as="script"><link rel="prefetch" href="/assets/02.html-253ac46f.js" as="script"><link rel="prefetch" href="/assets/03.html-69a5e7ff.js" as="script"><link rel="prefetch" href="/assets/04.html-296411e8.js" as="script"><link rel="prefetch" href="/assets/01.html-a324ce8d.js" as="script"><link rel="prefetch" href="/assets/02.html-55dd94df.js" as="script"><link rel="prefetch" href="/assets/03.html-359a4dec.js" as="script"><link rel="prefetch" href="/assets/04.html-78bedd00.js" as="script"><link rel="prefetch" href="/assets/05.html-8dd462ba.js" as="script"><link rel="prefetch" href="/assets/06.html-da5748f2.js" as="script"><link rel="prefetch" href="/assets/07.html-8589cc15.js" as="script"><link rel="prefetch" href="/assets/01.html-243f6552.js" as="script"><link rel="prefetch" href="/assets/02.html-6762e43a.js" as="script"><link rel="prefetch" href="/assets/03.html-aeba4e3a.js" as="script"><link rel="prefetch" href="/assets/04.html-9df816da.js" as="script"><link rel="prefetch" href="/assets/05.html-4a2e4874.js" as="script"><link rel="prefetch" href="/assets/01.html-f273b8d5.js" as="script"><link rel="prefetch" href="/assets/02.html-ce5061ed.js" as="script"><link rel="prefetch" href="/assets/03.html-e505af88.js" as="script"><link rel="prefetch" href="/assets/04.html-b8571be0.js" as="script"><link rel="prefetch" href="/assets/05.html-29fbac44.js" as="script"><link rel="prefetch" href="/assets/06.html-b6349aca.js" as="script"><link rel="prefetch" href="/assets/07.html-40aa0936.js" as="script"><link rel="prefetch" href="/assets/08.html-4abf0e69.js" as="script"><link rel="prefetch" href="/assets/09.html-e280580a.js" as="script"><link rel="prefetch" href="/assets/01.html-ae73ad13.js" as="script"><link rel="prefetch" href="/assets/02.html-8be1a1b3.js" as="script"><link rel="prefetch" href="/assets/03.html-b5f29a5a.js" as="script"><link rel="prefetch" href="/assets/04.html-ffe59a96.js" as="script"><link rel="prefetch" href="/assets/05.html-6d4eed3e.js" as="script"><link rel="prefetch" href="/assets/06.html-6b3fb323.js" as="script"><link rel="prefetch" href="/assets/07.html-82ccc042.js" as="script"><link rel="prefetch" href="/assets/08.html-24943dd8.js" as="script"><link rel="prefetch" href="/assets/09.html-cd76da71.js" as="script"><link rel="prefetch" href="/assets/10.html-975746de.js" as="script"><link rel="prefetch" href="/assets/11.html-1a141598.js" as="script"><link rel="prefetch" href="/assets/12.html-f8cddf75.js" as="script"><link rel="prefetch" href="/assets/13.html-c67ebb9b.js" as="script"><link rel="prefetch" href="/assets/14.html-ad1db251.js" as="script"><link rel="prefetch" href="/assets/15.html-9f81b565.js" as="script"><link rel="prefetch" href="/assets/16.html-8067e2b1.js" as="script"><link rel="prefetch" href="/assets/17.html-3e2e370a.js" as="script"><link rel="prefetch" href="/assets/18.html-dff46f5e.js" as="script"><link rel="prefetch" href="/assets/19.html-376c9c69.js" as="script"><link rel="prefetch" href="/assets/20.html-5dc987f8.js" as="script"><link rel="prefetch" href="/assets/21.html-abe97601.js" as="script"><link rel="prefetch" href="/assets/22.html-868d7d6e.js" as="script"><link rel="prefetch" href="/assets/23.html-4b16431b.js" as="script"><link rel="prefetch" href="/assets/24.html-57e87081.js" as="script"><link rel="prefetch" href="/assets/25.html-17571416.js" as="script"><link rel="prefetch" href="/assets/01.html-41eb553a.js" as="script"><link rel="prefetch" href="/assets/02.html-d8a2a8c3.js" as="script"><link rel="prefetch" href="/assets/03.html-aa93a3a6.js" as="script"><link rel="prefetch" href="/assets/04.html-ba8917b4.js" as="script"><link rel="prefetch" href="/assets/05.html-86e5a47a.js" as="script"><link rel="prefetch" href="/assets/01.html-b4e389cb.js" as="script"><link rel="prefetch" href="/assets/02.html-d1d9738c.js" as="script"><link rel="prefetch" href="/assets/03.html-218f4802.js" as="script"><link rel="prefetch" href="/assets/04.html-ee1b44f7.js" as="script"><link rel="prefetch" href="/assets/05.html-0c697e4c.js" as="script"><link rel="prefetch" href="/assets/06.html-ad1dfd82.js" as="script"><link rel="prefetch" href="/assets/07.html-bbd757ac.js" as="script"><link rel="prefetch" href="/assets/08.html-7df5581b.js" as="script"><link rel="prefetch" href="/assets/09.html-93f77e34.js" as="script"><link rel="prefetch" href="/assets/10.html-97819710.js" as="script"><link rel="prefetch" href="/assets/11.html-ad75a1b3.js" as="script"><link rel="prefetch" href="/assets/12.html-3d2b216c.js" as="script"><link rel="prefetch" href="/assets/13.html-872e6426.js" as="script"><link rel="prefetch" href="/assets/14.html-5ebab0af.js" as="script"><link rel="prefetch" href="/assets/15.html-764dc5a0.js" as="script"><link rel="prefetch" href="/assets/16.html-1e68ea37.js" as="script"><link rel="prefetch" href="/assets/17.html-193c2885.js" as="script"><link rel="prefetch" href="/assets/18.html-fd0172e9.js" as="script"><link rel="prefetch" href="/assets/19.html-177236e9.js" as="script"><link rel="prefetch" href="/assets/20.html-2fea1a80.js" as="script"><link rel="prefetch" href="/assets/21.html-2172008c.js" as="script"><link rel="prefetch" href="/assets/22.html-b82920dd.js" as="script"><link rel="prefetch" href="/assets/23.html-2faa8907.js" as="script"><link rel="prefetch" href="/assets/24.html-e6b7de17.js" as="script"><link rel="prefetch" href="/assets/25.html-1030a680.js" as="script"><link rel="prefetch" href="/assets/26.html-2d016c83.js" as="script"><link rel="prefetch" href="/assets/27.html-99c26439.js" as="script"><link rel="prefetch" href="/assets/28.html-0645be5c.js" as="script"><link rel="prefetch" href="/assets/29.html-7a1837fd.js" as="script"><link rel="prefetch" href="/assets/30.html-7e59fabc.js" as="script"><link rel="prefetch" href="/assets/31.html-023df70f.js" as="script"><link rel="prefetch" href="/assets/32.html-b4000deb.js" as="script"><link rel="prefetch" href="/assets/33.html-ec7c1801.js" as="script"><link rel="prefetch" href="/assets/34.html-0a88d41b.js" as="script"><link rel="prefetch" href="/assets/35.html-bca0e750.js" as="script"><link rel="prefetch" href="/assets/36.html-04e359c3.js" as="script"><link rel="prefetch" href="/assets/37.html-0cc25875.js" as="script"><link rel="prefetch" href="/assets/38.html-0b81e18a.js" as="script"><link rel="prefetch" href="/assets/39.html-56a13d2d.js" as="script"><link rel="prefetch" href="/assets/40.html-38a072bd.js" as="script"><link rel="prefetch" href="/assets/41.html-b50bfaa7.js" as="script"><link rel="prefetch" href="/assets/01.html-7ad4a1ef.js" as="script"><link rel="prefetch" href="/assets/02.html-d82b01c4.js" as="script"><link rel="prefetch" href="/assets/03.html-3b2fdaa9.js" as="script"><link rel="prefetch" href="/assets/04.html-be30928a.js" as="script"><link rel="prefetch" href="/assets/05.html-e65aebb1.js" as="script"><link rel="prefetch" href="/assets/06.html-1af8a70e.js" as="script"><link rel="prefetch" href="/assets/07.html-e7137918.js" as="script"><link rel="prefetch" href="/assets/08.html-b8b6b70d.js" as="script"><link rel="prefetch" href="/assets/09.html-2b125e03.js" as="script"><link rel="prefetch" href="/assets/10.html-b0c75e1e.js" as="script"><link rel="prefetch" href="/assets/11.html-45cbea17.js" as="script"><link rel="prefetch" href="/assets/12.html-6ac506d8.js" as="script"><link rel="prefetch" href="/assets/01.html-d503a2d6.js" as="script"><link rel="prefetch" href="/assets/02.html-82fcecc8.js" as="script"><link rel="prefetch" href="/assets/03.html-432f1fbc.js" as="script"><link rel="prefetch" href="/assets/04.html-14c2ab80.js" as="script"><link rel="prefetch" href="/assets/01.html-605281d0.js" as="script"><link rel="prefetch" href="/assets/02.html-a37ab52e.js" as="script"><link rel="prefetch" href="/assets/03.html-71bb3061.js" as="script"><link rel="prefetch" href="/assets/04.html-66327e83.js" as="script"><link rel="prefetch" href="/assets/05.html-899f0721.js" as="script"><link rel="prefetch" href="/assets/06.html-2de3a450.js" as="script"><link rel="prefetch" href="/assets/001.html-fcb70e1d.js" as="script"><link rel="prefetch" href="/assets/01.html-cedd4d78.js" as="script"><link rel="prefetch" href="/assets/02.html-781f7ec2.js" as="script"><link rel="prefetch" href="/assets/03.html-5e907cfd.js" as="script"><link rel="prefetch" href="/assets/04.html-686c2a05.js" as="script"><link rel="prefetch" href="/assets/05.html-a2b49cbb.js" as="script"><link rel="prefetch" href="/assets/06.html-89c4cf23.js" as="script"><link rel="prefetch" href="/assets/07.html-b5e7a01d.js" as="script"><link rel="prefetch" href="/assets/08.html-e3da9279.js" as="script"><link rel="prefetch" href="/assets/09.html-452a6282.js" as="script"><link rel="prefetch" href="/assets/10.html-ebacc03f.js" as="script"><link rel="prefetch" href="/assets/11.html-1105ddeb.js" as="script"><link rel="prefetch" href="/assets/12.html-c72a1174.js" as="script"><link rel="prefetch" href="/assets/13.html-7ae35269.js" as="script"><link rel="prefetch" href="/assets/14.html-ad88a78b.js" as="script"><link rel="prefetch" href="/assets/15.html-351eb64b.js" as="script"><link rel="prefetch" href="/assets/01.html-bad3c04c.js" as="script"><link rel="prefetch" href="/assets/02.html-d8267cc0.js" as="script"><link rel="prefetch" href="/assets/03.html-58a48aab.js" as="script"><link rel="prefetch" href="/assets/04.html-b27430ca.js" as="script"><link rel="prefetch" href="/assets/05.html-f9b13d8a.js" as="script"><link rel="prefetch" href="/assets/06.html-b4623eac.js" as="script"><link rel="prefetch" href="/assets/07.html-6d328451.js" as="script"><link rel="prefetch" href="/assets/08.html-edef41f6.js" as="script"><link rel="prefetch" href="/assets/09.html-f96d8ccd.js" as="script"><link rel="prefetch" href="/assets/10.html-88917be9.js" as="script"><link rel="prefetch" href="/assets/12.html-ce3f2c9c.js" as="script"><link rel="prefetch" href="/assets/13.html-e4b06cc7.js" as="script"><link rel="prefetch" href="/assets/14.html-a399de75.js" as="script"><link rel="prefetch" href="/assets/15.html-b4ce078e.js" as="script"><link rel="prefetch" href="/assets/16.html-8505b062.js" as="script"><link rel="prefetch" href="/assets/404.html-af064c1c.js" as="script"><link rel="prefetch" href="/assets/index.html-e16d941a.js" as="script"><link rel="prefetch" href="/assets/index.html-c62116c7.js" as="script"><link rel="prefetch" href="/assets/index.html-17e87708.js" as="script"><link rel="prefetch" href="/assets/index.html-b766e037.js" as="script"><link rel="prefetch" href="/assets/index.html-f4ca18d5.js" as="script"><link rel="prefetch" href="/assets/index.html-bb2758a8.js" as="script"><link rel="prefetch" href="/assets/index.html-20260678.js" as="script"><link rel="prefetch" href="/assets/index.html-24b31f9d.js" as="script"><link rel="prefetch" href="/assets/index.html-1f4173a2.js" as="script"><link rel="prefetch" href="/assets/index.html-10b5de2c.js" as="script"><link rel="prefetch" href="/assets/index.html-56a0cb36.js" as="script"><link rel="prefetch" href="/assets/index.html-2347f37c.js" as="script"><link rel="prefetch" href="/assets/index.html-3dc0bb62.js" as="script"><link rel="prefetch" href="/assets/index.html-b4714df6.js" as="script"><link rel="prefetch" href="/assets/index.html-ec870518.js" as="script"><link rel="prefetch" href="/assets/index.html-e61b4348.js" as="script"><link rel="prefetch" href="/assets/index.html-418403f4.js" as="script"><link rel="prefetch" href="/assets/index.html-5f50f4da.js" as="script"><link rel="prefetch" href="/assets/index.html-3f501aec.js" as="script"><link rel="prefetch" href="/assets/index.html-406bb1e7.js" as="script"><link rel="prefetch" href="/assets/index.html-07a41f7b.js" as="script"><link rel="prefetch" href="/assets/index.html-90cb062d.js" as="script"><link rel="prefetch" href="/assets/index.html-fa6c2cea.js" as="script"><link rel="prefetch" href="/assets/index.html-b0027c30.js" as="script"><link rel="prefetch" href="/assets/index.html-bec57dfd.js" as="script"><link rel="prefetch" href="/assets/index.html-91662fea.js" as="script"><link rel="prefetch" href="/assets/index.html-9f972cd8.js" as="script"><link rel="prefetch" href="/assets/index.html-e75f521b.js" as="script"><link rel="prefetch" href="/assets/index.html-17c741bb.js" as="script"><link rel="prefetch" href="/assets/index.html-7523a321.js" as="script"><link rel="prefetch" href="/assets/index.html-d4490298.js" as="script"><link rel="prefetch" href="/assets/index.html-3e7fe1ad.js" as="script"><link rel="prefetch" href="/assets/index.html-730c2641.js" as="script"><link rel="prefetch" href="/assets/index.html-f01d8e6e.js" as="script"><link rel="prefetch" href="/assets/index.html-90980fa5.js" as="script"><link rel="prefetch" href="/assets/index.html-3f370a3d.js" as="script"><link rel="prefetch" href="/assets/index.html-4568dbb9.js" as="script"><link rel="prefetch" href="/assets/index.html-cf5873df.js" as="script"><link rel="prefetch" href="/assets/index.html-b97db553.js" as="script"><link rel="prefetch" href="/assets/index.html-b88e30e4.js" as="script"><link rel="prefetch" href="/assets/index.html-b9505224.js" as="script"><link rel="prefetch" href="/assets/index.html-90dd9e4e.js" as="script"><link rel="prefetch" href="/assets/index.html-46b65208.js" as="script"><link rel="prefetch" href="/assets/index.html-f19a1923.js" as="script"><link rel="prefetch" href="/assets/index.html-b4de9fbe.js" as="script"><link rel="prefetch" href="/assets/index.html-a9e39c0b.js" as="script"><link rel="prefetch" href="/assets/index.html-aff07cc4.js" as="script"><link rel="prefetch" href="/assets/index.html-91587e5c.js" as="script"><link rel="prefetch" href="/assets/index.html-babc8a76.js" as="script"><link rel="prefetch" href="/assets/index.html-feaf78fe.js" as="script"><link rel="prefetch" href="/assets/index.html-e0ac3e02.js" as="script"><link rel="prefetch" href="/assets/index.html-1d73e39f.js" as="script"><link rel="prefetch" href="/assets/index.html-94c790b2.js" as="script"><link rel="prefetch" href="/assets/index.html-5eca2b6c.js" as="script"><link rel="prefetch" href="/assets/index.html-23468f22.js" as="script"><link rel="prefetch" href="/assets/index.html-b0468e92.js" as="script"><link rel="prefetch" href="/assets/index.html-a6d50ebc.js" as="script"><link rel="prefetch" href="/assets/index.html-bfb5b66e.js" as="script"><link rel="prefetch" href="/assets/index.html-4f910410.js" as="script"><link rel="prefetch" href="/assets/index.html-159f6a76.js" as="script"><link rel="prefetch" href="/assets/index.html-aab80686.js" as="script"><link rel="prefetch" href="/assets/index.html-305542ec.js" as="script"><link rel="prefetch" href="/assets/index.html-f17f384b.js" as="script"><link rel="prefetch" href="/assets/index.html-a9c24574.js" as="script"><link rel="prefetch" href="/assets/index.html-00eb6bac.js" as="script"><link rel="prefetch" href="/assets/index.html-cef241ba.js" as="script"><link rel="prefetch" href="/assets/index.html-aae9d8aa.js" as="script"><link rel="prefetch" href="/assets/index.html-c0c48426.js" as="script"><link rel="prefetch" href="/assets/index.html-2b61aab7.js" as="script"><link rel="prefetch" href="/assets/index.html-792a241e.js" as="script"><link rel="prefetch" href="/assets/index.html-5e342414.js" as="script"><link rel="prefetch" href="/assets/index.html-c9edea5e.js" as="script"><link rel="prefetch" href="/assets/index.html-6890f245.js" as="script"><link rel="prefetch" href="/assets/index.html-e7671174.js" as="script"><link rel="prefetch" href="/assets/index.html-83e01b6c.js" as="script"><link rel="prefetch" href="/assets/index.html-9f61cb95.js" as="script"><link rel="prefetch" href="/assets/index.html-6eebbe4e.js" as="script"><link rel="prefetch" href="/assets/index.html-74e64d68.js" as="script"><link rel="prefetch" href="/assets/index.html-fe6ce508.js" as="script"><link rel="prefetch" href="/assets/index.html-4bcc60fb.js" as="script"><link rel="prefetch" href="/assets/index.html-d8f4df5c.js" as="script"><link rel="prefetch" href="/assets/index.html-5d0cd931.js" as="script"><link rel="prefetch" href="/assets/index.html-b4062352.js" as="script"><link rel="prefetch" href="/assets/index.html-bb80247d.js" as="script"><link rel="prefetch" href="/assets/index.html-d9943503.js" as="script"><link rel="prefetch" href="/assets/index.html-06604e8f.js" as="script"><link rel="prefetch" href="/assets/index.html-6d081c18.js" as="script"><link rel="prefetch" href="/assets/index.html-e91f7d31.js" as="script"><link rel="prefetch" href="/assets/index.html-3e637d65.js" as="script"><link rel="prefetch" href="/assets/index.html-b602016e.js" as="script"><link rel="prefetch" href="/assets/index.html-5d96e324.js" as="script"><link rel="prefetch" href="/assets/index.html-675cf633.js" as="script"><link rel="prefetch" href="/assets/index.html-565ff018.js" as="script"><link rel="prefetch" href="/assets/index.html-30ad1c67.js" as="script"><link rel="prefetch" href="/assets/index.html-f8bf4a35.js" as="script"><link rel="prefetch" href="/assets/index.html-d99eebc6.js" as="script"><link rel="prefetch" href="/assets/index.html-557cec8d.js" as="script"><link rel="prefetch" href="/assets/index.html-0faa49b3.js" as="script"><link rel="prefetch" href="/assets/index.html-27495a28.js" as="script"><link rel="prefetch" href="/assets/index.html-6e251a25.js" as="script"><link rel="prefetch" href="/assets/index.html-5d4b5c46.js" as="script"><link rel="prefetch" href="/assets/giscus-52604b1e.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-6293320d.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-2450701e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="郁子IKUKO"><!----><span class="site-name hide-in-pad">郁子IKUKO</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/websites/00.html" class="nav-link" aria-label="网站合集"><span class="font-icon icon iconfont icon-websites" style=""></span>网站合集<!----></a></div><div class="nav-item hide-in-mobile"><a href="/notes/00.html" class="nav-link" aria-label="学习笔记"><span class="font-icon icon iconfont icon-notes" style=""></span>学习笔记<!----></a></div><div class="nav-item hide-in-mobile"><a href="/articles/00.html" class="nav-link" aria-label="原创随笔"><span class="font-icon icon iconfont icon-articles" style=""></span>原创随笔<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item"><a class="repo-link" href="https://gitee.com/ikuko/vite2-vue3-element-plus.git" target="_blank" rel="noopener noreferrer" aria-label="Gitee"><svg xmlns="http://www.w3.org/2000/svg" class="icon gitee-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="gitee icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm242.97-533.34H482.39a23.7 23.7 0 0 0-23.7 23.7l-.03 59.28c0 13.08 10.59 23.7 23.7 23.7h165.96a23.7 23.7 0 0 1 23.7 23.7v11.85a71.1 71.1 0 0 1-71.1 71.1H375.71a23.7 23.7 0 0 1-23.7-23.7V423.11a71.1 71.1 0 0 1 71.1-71.1h331.8a23.7 23.7 0 0 0 23.7-23.7l.06-59.25a23.73 23.73 0 0 0-23.7-23.73H423.11a177.78 177.78 0 0 0-177.78 177.75v331.83c0 13.08 10.62 23.7 23.7 23.7h349.62a159.99 159.99 0 0 0 159.99-159.99V482.33a23.7 23.7 0 0 0-23.7-23.7z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-notes" style=""></span><a href="/notes/00.html" class="nav-link title" aria-label="学习笔记"><!---->学习笔记<!----></a><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/HTML_CSS_JS/01.html" class="nav-link title" aria-label="HTML/CSS/JS"><!---->HTML/CSS/JS<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/ECMAScript6-11/01.html" class="nav-link title" aria-label="ECMAScript 6-11"><!---->ECMAScript 6-11<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/TypeScript/01.html" class="nav-link title" aria-label="TypeScript"><!---->TypeScript<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Vue2/01.html" class="nav-link title" aria-label="Vue 2.x"><!---->Vue 2.x<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Vue3/01.html" class="nav-link title" aria-label="Vue 3.x"><!---->Vue 3.x<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/React16/01.html" class="nav-link title" aria-label="React 16.8"><!---->React 16.8<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/React18/01.html" class="nav-link title" aria-label="React 18"><!---->React 18<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/NextJS/01.html" class="nav-link title" aria-label="NextJS 12"><!---->NextJS 12<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Nginx/01.html" class="nav-link title" aria-label="Nginx(2019)"><!---->Nginx(2019)<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Algorithm/01.html" class="nav-link title" aria-label="数据结构和算法"><!---->数据结构和算法<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/01Basic/01.html" class="nav-link title" aria-label="渡一教育-语言基础"><!---->渡一教育-语言基础<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/02Central/01.html" class="nav-link title" aria-label="渡一教育-中枢课"><!---->渡一教育-中枢课<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/03Strengthen/01.html" class="nav-link title" aria-label="渡一教育-强化课"><!---->渡一教育-强化课<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable exact active" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/04Interview/01.html" class="nav-link title" aria-label="渡一教育-笔面试题甄选"><!---->渡一教育-笔面试题甄选<!----></a><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/notes/DuYi/04Interview/01.html" class="nav-link sidebar-link sidebar-page" aria-label="一、HTML相关面试题讲解"><!---->一、HTML相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/02.html" class="nav-link sidebar-link sidebar-page" aria-label="二、HTML相关面试题汇总"><!---->二、HTML相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/03.html" class="nav-link sidebar-link sidebar-page" aria-label="三、CSS相关面试题讲解"><!---->三、CSS相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/04.html" class="nav-link sidebar-link sidebar-page" aria-label="四、CSS相关面试题汇总"><!---->四、CSS相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/05.html" class="nav-link sidebar-link sidebar-page" aria-label="五、JavaScript相关面试题讲解"><!---->五、JavaScript相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/06.html" class="nav-link sidebar-link sidebar-page" aria-label="六、JavaScript相关面试题汇总"><!---->六、JavaScript相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/07.html" class="nav-link sidebar-link sidebar-page" aria-label="七、Promise相关面试题讲解"><!---->七、Promise相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/08.html" class="nav-link sidebar-link sidebar-page" aria-label="八、Promise相关面试题汇总"><!---->八、Promise相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/09.html" class="nav-link sidebar-link sidebar-page" aria-label="九、浏览器相关面试题讲解"><!---->九、浏览器相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/10.html" class="nav-link sidebar-link sidebar-page" aria-label="十、浏览器相关面试题汇总"><!---->十、浏览器相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/notes/DuYi/04Interview/11.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="十一、网络相关面试题讲解"><!---->十一、网络相关面试题讲解<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#一-五层网络模型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（一）五层网络模型"><!---->（一）五层网络模型<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-分层的意义" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.分层的意义"><!---->1.分层的意义<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-五层网络模型" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.五层网络模型"><!---->2.五层网络模型<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-数据的封装和解封装" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.数据的封装和解封装"><!---->3.数据的封装和解封装<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-四层、七层、五层" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.四层、七层、五层"><!---->4.四层、七层、五层<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.面试题"><!---->5.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二-常见请求方法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二）常见请求方法"><!---->（二）常见请求方法<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-请求方法的本质" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.请求方法的本质"><!---->1.请求方法的本质<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-get-和-post-的区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.GET 和 POST 的区别"><!---->2.GET 和 POST 的区别<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.面试题"><!---->3.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#三-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（三）Cookie"><!---->（三）Cookie<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-cookie-的组成" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.cookie 的组成"><!---->1.cookie 的组成<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-cookie-的条件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.cookie 的条件"><!---->2.cookie 的条件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-设置-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.设置 cookie"><!---->3.设置 cookie<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-服务器端设置-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.服务器端设置 cookie"><!---->4.服务器端设置 cookie<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-客户端设置-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.客户端设置 cookie"><!---->5.客户端设置 cookie<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.总结"><!---->6.总结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#四-cookie-和-storage-的区别" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（四）Cookie 和 Storage 的区别"><!---->（四）Cookie 和 Storage 的区别<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.面试题"><!---->1.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#五-加密算法" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（五）加密算法"><!---->（五）加密算法<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-密钥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.密钥"><!---->1.密钥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-对称加密" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.对称加密"><!---->2.对称加密<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-非对称加密" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.非对称加密"><!---->3.非对称加密<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-摘要-哈希-散列" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.摘要/哈希/散列"><!---->4.摘要/哈希/散列<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.面试题"><!---->5.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#六-jwt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（六）JWT"><!---->（六）JWT<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.概述"><!---->1.概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-令牌的组成" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.令牌的组成"><!---->2.令牌的组成<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-令牌的验证" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.令牌的验证"><!---->3.令牌的验证<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-jwt-的特点" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.JWT 的特点"><!---->4.JWT 的特点<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.面试题"><!---->5.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#七-同源策略" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（七）同源策略"><!---->（七）同源策略<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.概述"><!---->1.概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-跨域限制对象" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.跨域限制对象"><!---->2.跨域限制对象<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-解决跨域问题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.解决跨域问题"><!---->3.解决跨域问题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#八-跨域-——-代理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（八）跨域 —— 代理"><!---->（八）跨域 —— 代理<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-代理适用的场景" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.代理适用的场景"><!---->1.代理适用的场景<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-配置开发代理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.配置开发代理"><!---->2.配置开发代理<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#九-跨域-——-cors" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（九）跨域 —— CORS"><!---->（九）跨域 —— CORS<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.概述"><!---->1.概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-简单请求" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.简单请求"><!---->2.简单请求<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-需要预检的请求" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.需要预检的请求"><!---->3.需要预检的请求<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-附带身份凭证的请求" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.附带身份凭证的请求"><!---->4.附带身份凭证的请求<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-js-访问指定的响应头" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.JS 访问指定的响应头"><!---->5.JS 访问指定的响应头<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十-跨域-——-jsonp" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十）跨域 —— JSONP"><!---->（十）跨域 —— JSONP<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十一-文件上传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十一）文件上传"><!---->（十一）文件上传<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-文件上传的消息格式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.文件上传的消息格式"><!---->1.文件上传的消息格式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-实现文件上传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.实现文件上传"><!---->2.实现文件上传<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-统一上传接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.统一上传接口"><!---->3.统一上传接口<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-用户注册接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.用户注册接口"><!---->4.用户注册接口<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十二-输入-url-地址后" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十二）输入 URL 地址后"><!---->（十二）输入 URL 地址后<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.面试题"><!---->1.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十三-文件下载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十三）文件下载"><!---->（十三）文件下载<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-文件下载的消息格式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.文件下载的消息格式"><!---->1.文件下载的消息格式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-启用迅雷下载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.启用迅雷下载"><!---->2.启用迅雷下载<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-服务器下载接口" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.服务器下载接口"><!---->3.服务器下载接口<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十四-session" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十四）session"><!---->（十四）session<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-cookie-的缺陷" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.cookie 的缺陷"><!---->1.cookie 的缺陷<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-session-流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.session 流程"><!---->2.session 流程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.面试题"><!---->3.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十五-http-缓存协议" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十五）HTTP 缓存协议"><!---->（十五）HTTP 缓存协议<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-缓存的基本原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.缓存的基本原理"><!---->1.缓存的基本原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-来自服务器的缓存指令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.来自服务器的缓存指令"><!---->2.来自服务器的缓存指令<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-来自客户端的缓存指令" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.来自客户端的缓存指令"><!---->3.来自客户端的缓存指令<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-cache-control" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.Cache-Control"><!---->4.Cache-Control<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-expires" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.Expires"><!---->5.Expires<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-记录缓存时的有效期" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.记录缓存时的有效期"><!---->6.记录缓存时的有效期<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_7-pragma" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.Pragma"><!---->7.Pragma<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_8-vary" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.Vary"><!---->8.Vary<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_9-使用版本号或-hash" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.使用版本号或 hash"><!---->9.使用版本号或 hash<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_10-总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.总结"><!---->10.总结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十六-tcp-协议" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十六）TCP 协议"><!---->（十六）TCP 协议<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-tcp-收发数据流程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.TCP 收发数据流程"><!---->1.TCP 收发数据流程<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-tcp-如何收发数据" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.TCP 如何收发数据"><!---->2.TCP 如何收发数据<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-连接的建立-三次握手" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.连接的建立（三次握手）"><!---->3.连接的建立（三次握手）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-连接的销毁-四次挥手" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.连接的销毁（四次挥手）"><!---->4.连接的销毁（四次挥手）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-http-和-tcp-的关系" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.HTTP 和 TCP 的关系"><!---->5.HTTP 和 TCP 的关系<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.面试题"><!---->6.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十七-csrf-攻击" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十七）CSRF 攻击"><!---->（十七）CSRF 攻击<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-防御方式" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.防御方式"><!---->1.防御方式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.面试题"><!---->2.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十八-xss-攻击" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十八）XSS 攻击"><!---->（十八）XSS 攻击<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-防御方式-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.防御方式"><!---->1.防御方式<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.面试题"><!---->2.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十九-网络性能优化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（十九）网络性能优化"><!---->（十九）网络性能优化<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.面试题"><!---->1.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十-断点续传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十）断点续传"><!---->（二十）断点续传<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-实现下载时的断点续传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.实现下载时的断点续传"><!---->1.实现下载时的断点续传<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-实现上传时的断点续传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.实现上传时的断点续传"><!---->2.实现上传时的断点续传<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-下载断点续传示例-服务器" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.下载断点续传示例（服务器）"><!---->3.下载断点续传示例（服务器）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-分片上传示例" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.分片上传示例"><!---->4.分片上传示例<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十一-域名和-dns" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十一）域名和 DNS"><!---->（二十一）域名和 DNS<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-域名" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.域名"><!---->1.域名<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-dns" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.DNS"><!---->2.DNS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.面试题"><!---->3.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十二-ssl、tls、https" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十二）SSL、TLS、HTTPS"><!---->（二十二）SSL、TLS、HTTPS<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-三者关系" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.三者关系"><!---->1.三者关系<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题-2" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.面试题"><!---->2.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十三-http-各版本的差异" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十三）HTTP 各版本的差异"><!---->（二十三）HTTP 各版本的差异<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-http1-0" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.HTTP1.0"><!---->1.HTTP1.0<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-http1-1" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.HTTP1.1"><!---->2.HTTP1.1<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-http2-0" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.HTTP2.0"><!---->3.HTTP2.0<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-面试题" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.面试题"><!---->4.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十四-websocket" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十四）WebSocket"><!---->（二十四）WebSocket<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-实时场景的旧处理方案" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.实时场景的旧处理方案"><!---->1.实时场景的旧处理方案<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-短轮询-short-polling" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.短轮询 Short Polling"><!---->2.短轮询 Short Polling<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-长轮询-long-polling" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.长轮询 Long Polling"><!---->3.长轮询 Long Polling<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-websocket" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.WebSocket"><!---->4.WebSocket<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-3" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.面试题"><!---->5.面试题<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十五-websocket-实战" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二十五）WebSocket 实战"><!---->（二十五）WebSocket 实战<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-websocket-api" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.WebSocket API"><!---->1.WebSocket API<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-socket-io" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.Socket.io"><!---->2.Socket.io<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-接口文档" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.接口文档"><!---->3.接口文档<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/12.html" class="nav-link sidebar-link sidebar-page" aria-label="十二、网络相关面试题汇总"><!---->十二、网络相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/13.html" class="nav-link sidebar-link sidebar-page" aria-label="十三、工程化相关面试题讲解"><!---->十三、工程化相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/14.html" class="nav-link sidebar-link sidebar-page" aria-label="十四、工程化相关面试题汇总"><!---->十四、工程化相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/15.html" class="nav-link sidebar-link sidebar-page" aria-label="十五、Vue相关面试题讲解"><!---->十五、Vue相关面试题讲解<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/notes/DuYi/04Interview/16.html" class="nav-link sidebar-link sidebar-page" aria-label="十六、Vue相关面试题汇总"><!---->十六、Vue相关面试题汇总<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->十一、网络相关面试题讲解</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/aboutMe" target="_blank" rel="noopener noreferrer">郁子</a></span><span property="author" content="郁子"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-11-22T00:00:00.000Z"></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 90 分钟</span><meta property="timeRequired" content="PT90M"></span><span class="page-word-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 27124 字</span><meta property="wordCount" content="27124"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category8 clickable" role="navigation">笔记</span><span class="page-category-item category2 clickable" role="navigation">渡一教育</span><span class="page-category-item category3 clickable" role="navigation">笔面试题甄选</span><!--]--><meta property="articleSection" content="笔记,渡一教育,笔面试题甄选"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag6 clickable" role="navigation">袁进</span><!--]--><meta property="keywords" content="袁进"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#一-五层网络模型" class="router-link-active router-link-exact-active toc-link level2">（一）五层网络模型</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-分层的意义" class="router-link-active router-link-exact-active toc-link level3">1.分层的意义</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-五层网络模型" class="router-link-active router-link-exact-active toc-link level3">2.五层网络模型</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-数据的封装和解封装" class="router-link-active router-link-exact-active toc-link level3">3.数据的封装和解封装</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-四层、七层、五层" class="router-link-active router-link-exact-active toc-link level3">4.四层、七层、五层</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题" class="router-link-active router-link-exact-active toc-link level3">5.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二-常见请求方法" class="router-link-active router-link-exact-active toc-link level2">（二）常见请求方法</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-请求方法的本质" class="router-link-active router-link-exact-active toc-link level3">1.请求方法的本质</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-get-和-post-的区别" class="router-link-active router-link-exact-active toc-link level3">2.GET 和 POST 的区别</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题" class="router-link-active router-link-exact-active toc-link level3">3.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#三-cookie" class="router-link-active router-link-exact-active toc-link level2">（三）Cookie</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-cookie-的组成" class="router-link-active router-link-exact-active toc-link level3">1.cookie 的组成</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-cookie-的条件" class="router-link-active router-link-exact-active toc-link level3">2.cookie 的条件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-设置-cookie" class="router-link-active router-link-exact-active toc-link level3">3.设置 cookie</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-服务器端设置-cookie" class="router-link-active router-link-exact-active toc-link level3">4.服务器端设置 cookie</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-客户端设置-cookie" class="router-link-active router-link-exact-active toc-link level3">5.客户端设置 cookie</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-总结" class="router-link-active router-link-exact-active toc-link level3">6.总结</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#四-cookie-和-storage-的区别" class="router-link-active router-link-exact-active toc-link level2">（四）Cookie 和 Storage 的区别</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题" class="router-link-active router-link-exact-active toc-link level3">1.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#五-加密算法" class="router-link-active router-link-exact-active toc-link level2">（五）加密算法</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-密钥" class="router-link-active router-link-exact-active toc-link level3">1.密钥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-对称加密" class="router-link-active router-link-exact-active toc-link level3">2.对称加密</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-非对称加密" class="router-link-active router-link-exact-active toc-link level3">3.非对称加密</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-摘要-哈希-散列" class="router-link-active router-link-exact-active toc-link level3">4.摘要/哈希/散列</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-1" class="router-link-active router-link-exact-active toc-link level3">5.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#六-jwt" class="router-link-active router-link-exact-active toc-link level2">（六）JWT</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述" class="router-link-active router-link-exact-active toc-link level3">1.概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-令牌的组成" class="router-link-active router-link-exact-active toc-link level3">2.令牌的组成</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-令牌的验证" class="router-link-active router-link-exact-active toc-link level3">3.令牌的验证</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-jwt-的特点" class="router-link-active router-link-exact-active toc-link level3">4.JWT 的特点</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-2" class="router-link-active router-link-exact-active toc-link level3">5.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#七-同源策略" class="router-link-active router-link-exact-active toc-link level2">（七）同源策略</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述-1" class="router-link-active router-link-exact-active toc-link level3">1.概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-跨域限制对象" class="router-link-active router-link-exact-active toc-link level3">2.跨域限制对象</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-解决跨域问题" class="router-link-active router-link-exact-active toc-link level3">3.解决跨域问题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#八-跨域-——-代理" class="router-link-active router-link-exact-active toc-link level2">（八）跨域 —— 代理</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-代理适用的场景" class="router-link-active router-link-exact-active toc-link level3">1.代理适用的场景</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-配置开发代理" class="router-link-active router-link-exact-active toc-link level3">2.配置开发代理</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#九-跨域-——-cors" class="router-link-active router-link-exact-active toc-link level2">（九）跨域 —— CORS</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-概述-2" class="router-link-active router-link-exact-active toc-link level3">1.概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-简单请求" class="router-link-active router-link-exact-active toc-link level3">2.简单请求</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-需要预检的请求" class="router-link-active router-link-exact-active toc-link level3">3.需要预检的请求</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-附带身份凭证的请求" class="router-link-active router-link-exact-active toc-link level3">4.附带身份凭证的请求</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-js-访问指定的响应头" class="router-link-active router-link-exact-active toc-link level3">5.JS 访问指定的响应头</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十-跨域-——-jsonp" class="router-link-active router-link-exact-active toc-link level2">（十）跨域 —— JSONP</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十一-文件上传" class="router-link-active router-link-exact-active toc-link level2">（十一）文件上传</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-文件上传的消息格式" class="router-link-active router-link-exact-active toc-link level3">1.文件上传的消息格式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-实现文件上传" class="router-link-active router-link-exact-active toc-link level3">2.实现文件上传</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-统一上传接口" class="router-link-active router-link-exact-active toc-link level3">3.统一上传接口</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-用户注册接口" class="router-link-active router-link-exact-active toc-link level3">4.用户注册接口</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十二-输入-url-地址后" class="router-link-active router-link-exact-active toc-link level2">（十二）输入 URL 地址后</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题-1" class="router-link-active router-link-exact-active toc-link level3">1.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十三-文件下载" class="router-link-active router-link-exact-active toc-link level2">（十三）文件下载</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-文件下载的消息格式" class="router-link-active router-link-exact-active toc-link level3">1.文件下载的消息格式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-启用迅雷下载" class="router-link-active router-link-exact-active toc-link level3">2.启用迅雷下载</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-服务器下载接口" class="router-link-active router-link-exact-active toc-link level3">3.服务器下载接口</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十四-session" class="router-link-active router-link-exact-active toc-link level2">（十四）session</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-cookie-的缺陷" class="router-link-active router-link-exact-active toc-link level3">1.cookie 的缺陷</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-session-流程" class="router-link-active router-link-exact-active toc-link level3">2.session 流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题-1" class="router-link-active router-link-exact-active toc-link level3">3.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十五-http-缓存协议" class="router-link-active router-link-exact-active toc-link level2">（十五）HTTP 缓存协议</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-缓存的基本原理" class="router-link-active router-link-exact-active toc-link level3">1.缓存的基本原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-来自服务器的缓存指令" class="router-link-active router-link-exact-active toc-link level3">2.来自服务器的缓存指令</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-来自客户端的缓存指令" class="router-link-active router-link-exact-active toc-link level3">3.来自客户端的缓存指令</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-cache-control" class="router-link-active router-link-exact-active toc-link level3">4.Cache-Control</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-expires" class="router-link-active router-link-exact-active toc-link level3">5.Expires</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-记录缓存时的有效期" class="router-link-active router-link-exact-active toc-link level3">6.记录缓存时的有效期</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_7-pragma" class="router-link-active router-link-exact-active toc-link level3">7.Pragma</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_8-vary" class="router-link-active router-link-exact-active toc-link level3">8.Vary</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_9-使用版本号或-hash" class="router-link-active router-link-exact-active toc-link level3">9.使用版本号或 hash</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_10-总结" class="router-link-active router-link-exact-active toc-link level3">10.总结</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十六-tcp-协议" class="router-link-active router-link-exact-active toc-link level2">（十六）TCP 协议</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-tcp-收发数据流程" class="router-link-active router-link-exact-active toc-link level3">1.TCP 收发数据流程</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-tcp-如何收发数据" class="router-link-active router-link-exact-active toc-link level3">2.TCP 如何收发数据</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-连接的建立-三次握手" class="router-link-active router-link-exact-active toc-link level3">3.连接的建立（三次握手）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-连接的销毁-四次挥手" class="router-link-active router-link-exact-active toc-link level3">4.连接的销毁（四次挥手）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-http-和-tcp-的关系" class="router-link-active router-link-exact-active toc-link level3">5.HTTP 和 TCP 的关系</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_6-面试题" class="router-link-active router-link-exact-active toc-link level3">6.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十七-csrf-攻击" class="router-link-active router-link-exact-active toc-link level2">（十七）CSRF 攻击</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-防御方式" class="router-link-active router-link-exact-active toc-link level3">1.防御方式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题" class="router-link-active router-link-exact-active toc-link level3">2.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十八-xss-攻击" class="router-link-active router-link-exact-active toc-link level2">（十八）XSS 攻击</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-防御方式-1" class="router-link-active router-link-exact-active toc-link level3">1.防御方式</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题-1" class="router-link-active router-link-exact-active toc-link level3">2.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#十九-网络性能优化" class="router-link-active router-link-exact-active toc-link level2">（十九）网络性能优化</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-面试题-2" class="router-link-active router-link-exact-active toc-link level3">1.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十-断点续传" class="router-link-active router-link-exact-active toc-link level2">（二十）断点续传</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-实现下载时的断点续传" class="router-link-active router-link-exact-active toc-link level3">1.实现下载时的断点续传</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-实现上传时的断点续传" class="router-link-active router-link-exact-active toc-link level3">2.实现上传时的断点续传</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-下载断点续传示例-服务器" class="router-link-active router-link-exact-active toc-link level3">3.下载断点续传示例（服务器）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-分片上传示例" class="router-link-active router-link-exact-active toc-link level3">4.分片上传示例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十一-域名和-dns" class="router-link-active router-link-exact-active toc-link level2">（二十一）域名和 DNS</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-域名" class="router-link-active router-link-exact-active toc-link level3">1.域名</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-dns" class="router-link-active router-link-exact-active toc-link level3">2.DNS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-面试题-2" class="router-link-active router-link-exact-active toc-link level3">3.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十二-ssl、tls、https" class="router-link-active router-link-exact-active toc-link level2">（二十二）SSL、TLS、HTTPS</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-三者关系" class="router-link-active router-link-exact-active toc-link level3">1.三者关系</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-面试题-2" class="router-link-active router-link-exact-active toc-link level3">2.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十三-http-各版本的差异" class="router-link-active router-link-exact-active toc-link level2">（二十三）HTTP 各版本的差异</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-http1-0" class="router-link-active router-link-exact-active toc-link level3">1.HTTP1.0</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-http1-1" class="router-link-active router-link-exact-active toc-link level3">2.HTTP1.1</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-http2-0" class="router-link-active router-link-exact-active toc-link level3">3.HTTP2.0</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-面试题" class="router-link-active router-link-exact-active toc-link level3">4.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十四-websocket" class="router-link-active router-link-exact-active toc-link level2">（二十四）WebSocket</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-实时场景的旧处理方案" class="router-link-active router-link-exact-active toc-link level3">1.实时场景的旧处理方案</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-短轮询-short-polling" class="router-link-active router-link-exact-active toc-link level3">2.短轮询 Short Polling</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-长轮询-long-polling" class="router-link-active router-link-exact-active toc-link level3">3.长轮询 Long Polling</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_4-websocket" class="router-link-active router-link-exact-active toc-link level3">4.WebSocket</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_5-面试题-3" class="router-link-active router-link-exact-active toc-link level3">5.面试题</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#二十五-websocket-实战" class="router-link-active router-link-exact-active toc-link level2">（二十五）WebSocket 实战</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_1-websocket-api" class="router-link-active router-link-exact-active toc-link level3">1.WebSocket API</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_2-socket-io" class="router-link-active router-link-exact-active toc-link level3">2.Socket.io</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/04Interview/11.html#_3-接口文档" class="router-link-active router-link-exact-active toc-link level3">3.接口文档</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p><img src="/assets/网络相关面试题40-bf94c68c.png" alt=""></p><h2 id="一-五层网络模型" tabindex="-1"><a class="header-anchor" href="#一-五层网络模型" aria-hidden="true">#</a> （一）五层网络模型</h2><h3 id="_1-分层的意义" tabindex="-1"><a class="header-anchor" href="#_1-分层的意义" aria-hidden="true">#</a> 1.分层的意义</h3><ul><li>当遇到一个复杂问题的时候，可以使用分层的思想把问题简单化</li></ul><blockquote><p>如：有半杯 82 年的可乐，想分享给朋友王富贵，但已经 10 年没有联系了。要完成这件事，可能要考虑：</p><ul><li><p>我用什么装可乐？</p><p>可能的方案：塑料瓶、玻璃瓶、煤气罐</p></li><li><p>怎么保证可乐始终处于低温？</p><p>可能的方案：保温杯、小冰箱、冰盒</p></li><li><p>如何保证可乐不被运输的人偷喝？</p><p>可能的方案：封条、在上面写「毒药」</p></li><li><p>如何获取王富贵的地址？</p><p>可能的方案：报案失踪、联系私人侦探、联系物流公司的朋友</p></li><li><p>如何运输？</p><p>可能的方案：自行车、汽车、火车、高铁、飞机、火箭</p></li></ul><p>这就形成了一个分层结构</p></blockquote><p><img src="/assets/网络相关面试题01-9d8489c8.png" alt=""></p><ul><li>每层相对独立，只需解决自己的问题</li><li>每层无须考虑上层的交付，仅需把自己的结果交给下层即可</li><li>每层有多种方案可供选择，选择不同的方案不会对上下层造成影响</li><li>每一层会在上一层的基础上增加一些额外信息</li></ul><h3 id="_2-五层网络模型" tabindex="-1"><a class="header-anchor" href="#_2-五层网络模型" aria-hidden="true">#</a> 2.五层网络模型</h3><p><img src="/assets/网络相关面试题02-102c5c7b.png" alt=""></p><h3 id="_3-数据的封装和解封装" tabindex="-1"><a class="header-anchor" href="#_3-数据的封装和解封装" aria-hidden="true">#</a> 3.数据的封装和解封装</h3><p><img src="/assets/网络相关面试题03-4e280e61.png" alt=""></p><h3 id="_4-四层、七层、五层" tabindex="-1"><a class="header-anchor" href="#_4-四层、七层、五层" aria-hidden="true">#</a> 4.四层、七层、五层</h3><p><img src="/assets/网络相关面试题04-1f6c2119.png" alt=""></p><h3 id="_5-面试题" tabindex="-1"><a class="header-anchor" href="#_5-面试题" aria-hidden="true">#</a> 5.面试题</h3><h4 id="_1-说说网络的五层模型-寺库" tabindex="-1"><a class="header-anchor" href="#_1-说说网络的五层模型-寺库" aria-hidden="true">#</a> 1）说说网络的五层模型（寺库）</h4><blockquote><p>从上到下分别为：应用层、传输层、网络层、数据链路层、物理层。在发送消息时，消息从上到下进行打包，每一层会在上一层基础上加包，而接受消息时，从下到上进行解包，最终得到原始信息</p><ol><li>应用层主要面向互联网中的应用场景，比如网页、邮件、文件中心等等，它的代表协议有 http、smtp、pop3、ftp、DNS 等等</li><li>传输层主要面向传输过程，比如 TCP 协议是为了保证可靠的传输，而 UDP 协议则是一种无连接的广播，它们提供了不同的传输方式</li><li>网络层主要解决如何定位目标以及如何寻找最优路径的问题，比如 IP 等等</li><li>数据链路层的作用是将数据在一个子网（广播域）内有效传输，MAC 地址、交换机都是属于该层的</li><li>物理层是要解决二进制数据到信号之间的互转问题，集线器、双绞线、同轴电缆等都是属于该层的设备</li></ol></blockquote><h2 id="二-常见请求方法" tabindex="-1"><a class="header-anchor" href="#二-常见请求方法" aria-hidden="true">#</a> （二）常见请求方法</h2><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://study.duyiedu.com/api/user/login<span class="token punctuation">&quot;</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>POST<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>用POST方法提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    账号：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loginId<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    密码：
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loginPwd<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-请求方法的本质" tabindex="-1"><a class="header-anchor" href="#_1-请求方法的本质" aria-hidden="true">#</a> 1.请求方法的本质</h3><ul><li>请求方法是请求行中的第一个单词</li><li>向服务器描述了客户端发出请求的动作类型</li><li>在 HTTP 协议中，不同的请求方法只是包含了不同的语义，但服务器和浏览器的一些约定俗成的行为造成了它们具体的区别</li></ul><p><img src="/assets/网络相关面试题05-324c0c9a.png" alt=""></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;heiheihei&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 告诉百度，我这次请求是来嘿嘿嘿的</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>使用了自定义方法 <code>heiheihei</code>，虽然百度服务器无法理解这样的请求是在干什么，但这样的请求也是可以正常发送到百度服务器的</p></blockquote><ul><li>在实践中，客户端和服务器慢慢的形成了一个共识</li><li>约定俗成地规定了一些常见的请求方法</li></ul><table><thead><tr><th>请求方法</th><th>含义</th></tr></thead><tbody><tr><td>GET</td><td>表示向服务器获取资源<br>业务数据在请求行中，无须请求体</td></tr><tr><td>POST</td><td>表示向服务器提交信息，通常用于产生新的数据，如：注册<br>业务数据在请求体中</td></tr><tr><td>PUT</td><td>表示希望修改服务器的数据，通常用于修改<br>业务数据在请求体中</td></tr><tr><td>DELETE</td><td>表示希望删除服务器的数据<br>业务数据在请求行中，无须请求体</td></tr><tr><td>OPTIONS</td><td>发生在跨域的预检请求中<br>表示客户端向服务器申请跨域提交</td></tr><tr><td>TRACE</td><td>回显服务器收到的请求<br>主要用于测试和诊断</td></tr><tr><td>CONNECT</td><td>用于建立连接管道，通常在代理场景中使用<br>网页中很少用到</td></tr></tbody></table><h3 id="_2-get-和-post-的区别" tabindex="-1"><a class="header-anchor" href="#_2-get-和-post-的区别" aria-hidden="true">#</a> 2.GET 和 POST 的区别</h3><blockquote><p><mark>由于浏览器和服务器约定俗称的规则</mark>，造成了 GET 和 POST 请求在 web 中的区别</p><ol><li>浏览器在发送 GET 请求时，不会附带请求体</li><li>GET 请求的传递信息量有限，适合传递少量数据；POST 请求的传递信息量是没有限制的，适合传输大量数据</li><li>GET 请求只能传递 ASCII 数据，遇到非 ASCII 数据需要进行编码；POST 请求没有限制</li><li>大部分 GET 请求传递的数据都附带在 path 参数中，能够通过分享地址完整的重现页面，但同时也暴露了数据，若有敏感数据传递，不应该使用 GET 请求，至少不应该放到 path 中</li><li>刷新页面时，若当前的页面是通过 POST 请求得到的，则浏览器会提示用户是否重新提交。若是 GET 请求得到的页面则没有提示</li><li>GET 请求的地址可以被保存为浏览器书签，POST 不可以</li></ol></blockquote><h3 id="_3-面试题" tabindex="-1"><a class="header-anchor" href="#_3-面试题" aria-hidden="true">#</a> 3.面试题</h3><h4 id="_1-http-常见请求方法有哪些" tabindex="-1"><a class="header-anchor" href="#_1-http-常见请求方法有哪些" aria-hidden="true">#</a> 1）http 常见请求方法有哪些？</h4><blockquote><ul><li>GET，表示向服务器获取资源</li><li>POST，表示向服务器提交信息，通常用于产生新的数据，比如注册</li><li>PUT，表示希望修改服务器的数据，通常用于修改</li><li>DELETE，表示希望删除服务器的数据</li><li>OPTIONS，发生在跨域的预检请求中，表示客户端向服务器申请跨域提交</li><li>TRACE，回显服务器收到的请求，主要用于测试和诊断</li><li>CONNECT，用于建立连接管道，通常在代理场景中使用，网页中很少用到</li></ul></blockquote><h4 id="_2-get-和-post-的区别-流利说" tabindex="-1"><a class="header-anchor" href="#_2-get-和-post-的区别-流利说" aria-hidden="true">#</a> 2）GET 和 POST 的区别（流利说）</h4><blockquote><p>从 HTTP 协议的角度来说，GET 和 POST 它们都只是请求行中的第一个单词，除了语义不同，其实没有本质的区别</p><p>之所以在实际开发中会产生各种区别，主要是因为浏览器的默认行为造成的</p><p>受浏览器的影响，在实际开发中，GET 和 POST 有以下区别：</p><ol><li>浏览器在发送 GET 请求时，不会附带请求体</li><li>GET 请求的传递信息量有限，适合传递少量数据；POST 请求的传递信息量是没有限制的，适合传输大量数据</li><li>GET 请求只能传递 ASCII 数据，遇到非 ASCII 数据需要进行编码；POST 请求没有限制</li><li>大部分 GET 请求传递的数据都附带在 path 参数中，能够通过分享地址完整的重现页面，但同时也暴露了数据，若有敏感数据传递，不应该使用 GET 请求，至少不应该放到 path 中</li><li>刷新页面时，若当前的页面是通过 POST 请求得到的，则浏览器会提示用户是否重新提交。若是 GET 请求得到的页面则没有提示</li><li>GET 请求的地址可以被保存为浏览器书签，POST 不可以</li></ol></blockquote><h2 id="三-cookie" tabindex="-1"><a class="header-anchor" href="#三-cookie" aria-hidden="true">#</a> （三）Cookie</h2><h3 id="_1-cookie-的组成" tabindex="-1"><a class="header-anchor" href="#_1-cookie-的组成" aria-hidden="true">#</a> 1.cookie 的组成</h3><blockquote><p>cookie 是浏览器中特有的一个概念，管理各个网站的身份信息</p><p>每个 cookie 就相当于是属于某个网站的一个卡片，记录了下面的信息</p></blockquote><h4 id="_1-key" tabindex="-1"><a class="header-anchor" href="#_1-key" aria-hidden="true">#</a> 1）key</h4><ul><li>键</li><li>如：身份编号</li></ul><h4 id="_2-value" tabindex="-1"><a class="header-anchor" href="#_2-value" aria-hidden="true">#</a> 2）value</h4><ul><li>值</li><li>如：袁小进的身份编号 14563D1550F2F76D69ECBF4DD54ABC95</li><li>可以是任何信息</li></ul><h4 id="_3-domain" tabindex="-1"><a class="header-anchor" href="#_3-domain" aria-hidden="true">#</a> 3）domain</h4><ul><li>域</li><li>表达这个 cookie 是属于哪个网站的</li><li>如：<code>yuanjin.tech</code> 表示这个 cookie 是属于 <code>yuanjin.tech</code> 这个网站的</li></ul><h4 id="_4-path" tabindex="-1"><a class="header-anchor" href="#_4-path" aria-hidden="true">#</a> 4）path</h4><ul><li>路径</li><li>表达这个 cookie 是属于该网站的哪个基路径的</li><li>如：同一家公司不同部门会颁发不同的出入证</li><li>如：<code>/news</code> 表示这个 cookie 属于 <code>/news</code> 这个路径</li></ul><h4 id="_5-secure" tabindex="-1"><a class="header-anchor" href="#_5-secure" aria-hidden="true">#</a> 5）secure</h4><ul><li>是否使用安全传输</li></ul><h4 id="_6-expire" tabindex="-1"><a class="header-anchor" href="#_6-expire" aria-hidden="true">#</a> 6）expire</h4><ul><li>过期时间</li><li>表示该 cookie 在什么时候过期</li></ul><h3 id="_2-cookie-的条件" tabindex="-1"><a class="header-anchor" href="#_2-cookie-的条件" aria-hidden="true">#</a> 2.cookie 的条件</h3><blockquote><p>当浏览器向服务器发送一个请求的时候，会判断哪些 cookie 适合附带给服务器</p><p>如果一个 cookie <mark>同时满足</mark> 以下条件，则这个 cookie 会被附带到请求中</p></blockquote><h4 id="_1-cookie-没有过期" tabindex="-1"><a class="header-anchor" href="#_1-cookie-没有过期" aria-hidden="true">#</a> 1）cookie 没有过期</h4><h4 id="_2-cookie-中的域和这次请求的域是匹配的" tabindex="-1"><a class="header-anchor" href="#_2-cookie-中的域和这次请求的域是匹配的" aria-hidden="true">#</a> 2）cookie 中的域和这次请求的域是匹配的</h4><ul><li>如：cookie 中的域是 <code>yuanjin.tech</code>，则可以匹配的请求域是 <code>yuanjin.tech</code>、<code>www.yuanjin.tech</code>、<code>blogs.yuanjin.tech</code> 等等</li><li>如：cookie 中的域是 <code>www.yuanjin.tech</code>，则只能匹配 <code>www.yuanjin.tech</code> 这样的请求域</li><li>cookie 是不在乎端口的，只要域匹配即可</li></ul><h4 id="_3-cookie-中的-path-和这次请求的-path-是匹配的" tabindex="-1"><a class="header-anchor" href="#_3-cookie-中的-path-和这次请求的-path-是匹配的" aria-hidden="true">#</a> 3）cookie 中的 path 和这次请求的 path 是匹配的</h4><ul><li>如：cookie 中的 path 是 <code>/news</code>，则可以匹配的请求路径可以是 <code>/news</code>、<code>/news/detail</code>、<code>/news/a/b/c</code> 等等，但不能匹配 <code>/blogs</code></li><li>如果 cookie 的 path 是 <code>/</code>，可以想象，能够匹配所有的路径</li></ul><h4 id="_4-验证-cookie-的安全传输" tabindex="-1"><a class="header-anchor" href="#_4-验证-cookie-的安全传输" aria-hidden="true">#</a> 4）验证 cookie 的安全传输</h4><ul><li>如果 cookie 的 secure 属性是 true，则请求协议必须是 <code>https</code>，否则不会发送该 cookie</li><li>如果 cookie 的 secure 属性是 false，则请求协议可以是 <code>http</code>，也可以是 <code>https</code></li></ul><h4 id="_5-加入请求的方式" tabindex="-1"><a class="header-anchor" href="#_5-加入请求的方式" aria-hidden="true">#</a> 5）加入请求的方式</h4><ul><li>如果一个 cookie 满足了上述的所有条件，则浏览器会把它自动加入到这次请求中</li><li><mark>浏览器会将符合条件的 cookie，自动放置到请求头中</mark></li><li>格式是 <code>键=值; 键=值; 键=值; ...</code><ul><li>每一个键值对就是一个符合条件的 cookie</li></ul></li></ul><blockquote><p>cookie 中包含了重要的身份信息，永远不要把你的 cookie 泄露给别人</p><p>否则，他人就拿到了你的证件，有了证件，就具备了为所欲为的可能性</p></blockquote><h3 id="_3-设置-cookie" tabindex="-1"><a class="header-anchor" href="#_3-设置-cookie" aria-hidden="true">#</a> 3.设置 cookie</h3><blockquote><p>cookie 是保存在浏览器端的，同时，很多证件又是服务器颁发的</p><p>所以，cookie 的设置有两种模式</p></blockquote><h4 id="_1-服务器响应" tabindex="-1"><a class="header-anchor" href="#_1-服务器响应" aria-hidden="true">#</a> 1）服务器响应</h4><ul><li>这种模式非常普遍</li><li>当服务器决定给客户端颁发一个证件时，会在响应的消息中包含 cookie，浏览器会自动的把 cookie 保存到卡包中</li></ul><h4 id="_2-客户端自行设置" tabindex="-1"><a class="header-anchor" href="#_2-客户端自行设置" aria-hidden="true">#</a> 2）客户端自行设置</h4><ul><li>这种模式少见一些，不过也有可能会发生</li><li>如：用户关闭了某个广告，并选择了【以后不要再弹出】，此时就可以把这种小信息直接通过浏览器的 JS 代码保存到 cookie 中</li><li>后续请求服务器时，服务器会看到客户端不想要再次弹出广告的 cookie，于是就不会再发送广告过来了</li></ul><h3 id="_4-服务器端设置-cookie" tabindex="-1"><a class="header-anchor" href="#_4-服务器端设置-cookie" aria-hidden="true">#</a> 4.服务器端设置 cookie</h3><ul><li>服务器可以通过设置响应头，来告诉浏览器应该如何设置 cookie</li></ul><h4 id="_1-响应头的格式" tabindex="-1"><a class="header-anchor" href="#_1-响应头的格式" aria-hidden="true">#</a> 1）响应头的格式</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie1
<span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie2
<span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie3
<span class="token comment"># ...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-每个-cookie-的格式" tabindex="-1"><a class="header-anchor" href="#_2-每个-cookie-的格式" aria-hidden="true">#</a> 2）每个 cookie 的格式</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>键=值; path=<span class="token punctuation">?</span>; domain=<span class="token punctuation">?</span>; expire=<span class="token punctuation">?</span>; max<span class="token punctuation">-</span>age=<span class="token punctuation">?</span>; secure; httponly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>每个 cookie 除了键值对是必须要设置的，其他的属性都是可选的，并且顺序不限</li><li>当这样的响应头到达客户端后， <ul><li><mark>浏览器会自动的将 cookie 保存到卡包中</mark></li><li><mark>如果卡包中已经存在一模一样的卡片（其他 path、domain 相同），则会自动的覆盖之前的设置</mark></li></ul></li></ul><h4 id="_3-cookie-属性值" tabindex="-1"><a class="header-anchor" href="#_3-cookie-属性值" aria-hidden="true">#</a> 3）cookie 属性值</h4><h5 id="a-path" tabindex="-1"><a class="header-anchor" href="#a-path" aria-hidden="true">#</a> a）path</h5><ul><li>设置 cookie 的路径</li><li>如果不设置，浏览器会将其自动设置为 <mark>当前请求的路径</mark></li><li>如：浏览器请求的地址是 <code>/login</code>，服务器响应了一个 <code>set-cookie: a=1</code><ul><li>浏览器会将该 cookie 的 path 设置为请求的路径 <code>/login</code></li></ul></li></ul><h5 id="b-domain" tabindex="-1"><a class="header-anchor" href="#b-domain" aria-hidden="true">#</a> b）domain</h5><ul><li>设置 cookie 的域</li><li>如果不设置，浏览器会自动将其设置为当前的请求域</li><li>如：浏览器请求的地址是 <code>http://www.yuanjin.tech</code>，服务器响应了一个 <code>set-cookie: a=1</code><ul><li>浏览器会将该 cookie 的 domain 设置为请求的域 <code>www.yuanjin.tech</code></li></ul></li><li>这里值得注意的是，如果服务器响应了一个无效的域，浏览器是不认的</li><li>无效的域，响应的域连根域都不一样 <ul><li>如：浏览器请求的域是 <code>yuanjin.tech</code>，服务器响应的 cookie 是 <code>set-cookie: a=1; domain=baidu.com</code>，这样的域浏览器是不认的</li><li>如果浏览器连这样的情况都允许，就意味着张三的服务器，有权利给用户一个 cookie，用于访问李四的服务器，这会造成很多安全性的问题</li></ul></li></ul><h5 id="c-expire" tabindex="-1"><a class="header-anchor" href="#c-expire" aria-hidden="true">#</a> c）expire</h5><ul><li>设置 cookie 的过期时间</li><li>必须是一个有效的 GMT 时间，即格林威治标准时间字符串 <ul><li>如 <code>Fri, 17 Apr 2020 09:35:59 GMT</code></li><li>表示格林威治时间的 <code>2020-04-17 09:35:59</code></li><li>即北京时间的 <code>2020-04-17 17:35:59</code></li></ul></li><li>当客户端的时间达到这个时间点后，会自动销毁该 cookie</li></ul><h5 id="d-max-age" tabindex="-1"><a class="header-anchor" href="#d-max-age" aria-hidden="true">#</a> d）max-age</h5><ul><li>设置 cookie 的相对有效期</li><li>expire 和 max-age 通常仅设置一个即可</li><li>如：设置 <code>max-age</code> 为 <code>1000</code>，浏览器在添加 cookie 时，会自动设置它的 <code>expire</code> 为当前时间加上 1000 秒，作为过期时间</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><ul><li>如果不设置 expire，又没有设置 max-age，则表示会话结束后过期</li><li>对于大部分浏览器而言，关闭所有浏览器窗口意味着会话结束</li></ul></div><h5 id="e-secure" tabindex="-1"><a class="header-anchor" href="#e-secure" aria-hidden="true">#</a> e）secure</h5><ul><li>设置 cookie 是否是安全连接</li><li>如果设置了该值，则表示该 cookie 后续只能随着 <code>https</code> 请求发送</li><li>如果不设置，则表示该 cookie 会随着所有请求发送</li></ul><h5 id="f-httponly" tabindex="-1"><a class="header-anchor" href="#f-httponly" aria-hidden="true">#</a> f）httponly</h5><ul><li>设置 cookie 是否仅能用于传输</li><li>如果设置了该值，表示该 cookie 仅能用于传输，而不允许在客户端通过 JS 获取</li><li>这对防止跨站脚本攻击（XSS）会很有用</li></ul><h4 id="_4-设置示例" tabindex="-1"><a class="header-anchor" href="#_4-设置示例" aria-hidden="true">#</a> 4）设置示例</h4><ul><li>客户端通过 <code>post</code> 请求服务器 <code>http://yuanjin.tech/login</code>，并在消息体中给予了账号和密码</li><li>服务器验证登录成功后，在响应头中加入了以下内容</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> token=123456; path=/; max<span class="token punctuation">-</span>age=3600; httponly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>当该响应到达浏览器后，浏览器会创建下面的 cookie</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">key</span><span class="token punctuation">:</span> token
<span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token number">123456</span>
<span class="token key atrule">domain</span><span class="token punctuation">:</span> yuanjin.tech
<span class="token key atrule">path</span><span class="token punctuation">:</span> /
<span class="token key atrule">expire</span><span class="token punctuation">:</span> <span class="token datetime number">2020-04-17 18:55:00</span> <span class="token comment"># 假设当前时间是2020-04-17 17:55:00</span>
<span class="token key atrule">secure</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 任何请求都可以附带这个cookie，只要满足其他要求</span>
<span class="token key atrule">httponly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 不允许JS获取该cookie</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>随着浏览器后续对服务器的请求，只要满足要求，这个 cookie 就会被附带到请求头中传给服务器</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">cookie</span><span class="token punctuation">:</span> token=123456; 其他cookie<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_5-删除浏览器的-cookie" tabindex="-1"><a class="header-anchor" href="#_5-删除浏览器的-cookie" aria-hidden="true">#</a> 5）删除浏览器的 cookie</h5><ul><li>只需要让服务器响应一个同样的域、同样的路径、同样的 key，只是时间过期的 cookie 即可</li><li>删除 cookie 其实就是 <mark>修改 cookie</mark></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> token=; domain=yuanjin.tech; path=/; max<span class="token punctuation">-</span>age=<span class="token punctuation">-</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>浏览器按照要求修改了 cookie 后，会发现 cookie 已经过期，于是自然就会删除了</li></ul><blockquote><p>无论是修改还是删除，都要注意 cookie 的域和路径，因为完全可能存在域或路径不同，但 key 相同的 cookie</p><p>因此无法仅通过 key 确定是哪一个 cookie</p></blockquote><h3 id="_5-客户端设置-cookie" tabindex="-1"><a class="header-anchor" href="#_5-客户端设置-cookie" aria-hidden="true">#</a> 5.客户端设置 cookie</h3><ul><li>浏览器向 JS 公开了接口，让其可以设置 cookie</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">&quot;键=值; path=?; domain=?; expire=?; max-age=?; secure&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在客户端设置 cookie，和服务器设置 cookie 的格式一样，只是有下面的不同</li></ul><h4 id="_1-没有-httponly" tabindex="-1"><a class="header-anchor" href="#_1-没有-httponly" aria-hidden="true">#</a> 1）没有 httponly</h4><ul><li>因为 httponly 本来就是为了限制在客户端访问的</li><li>既然是在客户端配置，自然失去了限制的意义</li></ul><h4 id="_2-path-的默认值" tabindex="-1"><a class="header-anchor" href="#_2-path-的默认值" aria-hidden="true">#</a> 2）path 的默认值</h4><ul><li>在服务器端设置 cookie 时，如果没有写 path，使用的是 <mark>请求的 path</mark></li><li>而在客户端设置 cookie 时，也许根本没有请求发生</li><li>因此，path 在客户端设置时的默认值是 <mark>当前网页的 path</mark></li></ul><h4 id="_3-domain-的默认值" tabindex="-1"><a class="header-anchor" href="#_3-domain-的默认值" aria-hidden="true">#</a> 3）domain 的默认值</h4><ul><li>和 path 同理，客户端设置时的默认值是 <mark>当前网页的 domain</mark></li></ul><h4 id="_4-其他" tabindex="-1"><a class="header-anchor" href="#_4-其他" aria-hidden="true">#</a> 4）其他</h4><ul><li>和服务器设置时一样</li></ul><h4 id="_5-删除-cookie" tabindex="-1"><a class="header-anchor" href="#_5-删除-cookie" aria-hidden="true">#</a> 5）删除 cookie</h4><ul><li>和服务器设置时一样，修改 cookie 的过期时间即可</li></ul><h3 id="_6-总结" tabindex="-1"><a class="header-anchor" href="#_6-总结" aria-hidden="true">#</a> 6.总结</h3><ul><li>Cookie 用于登录场景的流程</li></ul><h4 id="_1-登录请求" tabindex="-1"><a class="header-anchor" href="#_1-登录请求" aria-hidden="true">#</a> 1）登录请求</h4><blockquote><ol><li>浏览器发送请求到服务器，附带账号密码</li><li>服务器验证账号密码是否正确，如果不正确，响应错误，如果正确，在响应头中设置 cookie，附带登录认证信息（至于登录认证信息是设么样的，如何设计，要考虑哪些问题，就是另一个话题了，可以百度 jwt）</li><li>客户端收到 cookie，浏览器自动记录下来</li></ol></blockquote><h4 id="_2-后续请求" tabindex="-1"><a class="header-anchor" href="#_2-后续请求" aria-hidden="true">#</a> 2）后续请求</h4><blockquote><ol><li>浏览器发送请求到服务器，希望添加一个管理员，并将 cookie 自动附带到请求中</li><li>服务器先获取 cookie，验证 cookie 中的信息是否正确，如果不正确，不予以操作，如果正确，完成正常的业务流程</li></ol></blockquote><h2 id="四-cookie-和-storage-的区别" tabindex="-1"><a class="header-anchor" href="#四-cookie-和-storage-的区别" aria-hidden="true">#</a> （四）Cookie 和 Storage 的区别</h2><h3 id="_1-面试题" tabindex="-1"><a class="header-anchor" href="#_1-面试题" aria-hidden="true">#</a> 1.面试题</h3><h4 id="_1-cookie-sessionstorage-localstorage-的区别" tabindex="-1"><a class="header-anchor" href="#_1-cookie-sessionstorage-localstorage-的区别" aria-hidden="true">#</a> 1）cookie/sessionStorage/localStorage 的区别</h4><blockquote><p>cookie、sessionStorage、localStorage 都是保存本地数据的方式</p><ol><li>cookie 兼容性较好，所有浏览器均支持</li></ol><ul><li>浏览器针对 cookie 会有一些默认行为 <ul><li>如：当响应头中出现 <code>set-cookie</code> 字段时，浏览器会自动保存 cookie 的值</li><li>如：浏览器发送请求时，会附带匹配的 cookie 到请求头中</li></ul></li><li>这些默认行为，使得 cookie 长期以来担任着维持登录状态的责任</li><li>与此同时，也正是因为浏览器的默认行为，给了恶意攻击者可乘之机，CSRF 攻击就是一个典型的利用 cookie 的攻击方式</li><li>虽然 cookie 不断的改进，但前端仍然需要另一种更加安全的保存数据的方式</li></ul><ol start="2"><li>HTML5 新增了 sessionStorage 和 localStorage</li></ol><ul><li>前者用于保存会话级别的数据，后者用于更持久的保存数据</li><li>浏览器针对它们 <mark>没有任何默认行为</mark> ，这样一来，就把保存数据、读取数据的工作交给了前端开发者，这就让恶意攻击者难以针对登录状态进行攻击</li></ul><ol start="3"><li>cookie 的大小是有限制的，一般浏览器会限制同一个域下的 cookie 总量为 4M，而针对同一个域名，其下的 sessionStorage 和 localStorage 只有总量限制（官方为 5M，不同浏览器有差异）</li><li>cookie 会与 domain、path 关联，而 sessionStorage 和 localStorage 只与 domain 关联</li></ol></blockquote><h2 id="五-加密算法" tabindex="-1"><a class="header-anchor" href="#五-加密算法" aria-hidden="true">#</a> （五）加密算法</h2><h3 id="_1-密钥" tabindex="-1"><a class="header-anchor" href="#_1-密钥" aria-hidden="true">#</a> 1.密钥</h3><ul><li>是一种参数，在明文转换为密文或将密文转换为明文的算法中输入的参数</li><li>密钥分为对称密钥与非对称密钥，分别应用在对称加密和非对称加密上</li></ul><h3 id="_2-对称加密" tabindex="-1"><a class="header-anchor" href="#_2-对称加密" aria-hidden="true">#</a> 2.对称加密</h3><ul><li>又叫私钥加密</li><li>信息的发送方和接收方使用 <mark>同一个密钥</mark> 加密和解密数据</li><li>如果一方的密钥遭泄露，那么整个通信就会被破解</li></ul><p><img src="/assets/网络相关面试题06-1091768b.png" alt=""></p><h4 id="_1-常见算法" tabindex="-1"><a class="header-anchor" href="#_1-常见算法" aria-hidden="true">#</a> 1）常见算法</h4><ul><li>DES</li><li>3DES</li><li>TDEA</li><li>Blowfish</li><li>RC5</li><li>IDEA</li></ul><h4 id="_2-优点" tabindex="-1"><a class="header-anchor" href="#_2-优点" aria-hidden="true">#</a> 2）优点</h4><ul><li>加密、解密速度快</li><li>适合对大数据量进行加密</li></ul><h4 id="_3-缺点" tabindex="-1"><a class="header-anchor" href="#_3-缺点" aria-hidden="true">#</a> 3）缺点</h4><ul><li>在网络中需要分发密钥</li><li>增加了密钥被窃取的风险</li></ul><h3 id="_3-非对称加密" tabindex="-1"><a class="header-anchor" href="#_3-非对称加密" aria-hidden="true">#</a> 3.非对称加密</h3><ul><li>又叫公钥加密</li><li>使用一对密钥，即公钥和私钥，且二者成对出现 <ul><li>私钥被自己保存，不能对外泄露</li><li>公钥指的是公共的密钥，任何人都可以获得该密钥</li></ul></li><li>用公钥或私钥中的任何一个进行加密，用另一个进行解密</li></ul><p><img src="/assets/网络相关面试题07-d4e21a5e.png" alt=""></p><h4 id="_1-常见算法-1" tabindex="-1"><a class="header-anchor" href="#_1-常见算法-1" aria-hidden="true">#</a> 1）常见算法</h4><ul><li>RSA</li><li>Rabin</li><li>DSA</li><li>ECC</li><li>Elgamal</li><li>D-H</li></ul><h4 id="_2-优点-1" tabindex="-1"><a class="header-anchor" href="#_2-优点-1" aria-hidden="true">#</a> 2）优点</h4><ul><li>安全性更好</li><li>私钥仅被一方保存，不用于网络传输</li></ul><h4 id="_3-缺点-1" tabindex="-1"><a class="header-anchor" href="#_3-缺点-1" aria-hidden="true">#</a> 3）缺点</h4><ul><li>仅能一方进行解密</li></ul><h3 id="_4-摘要-哈希-散列" tabindex="-1"><a class="header-anchor" href="#_4-摘要-哈希-散列" aria-hidden="true">#</a> 4.摘要/哈希/散列</h3><ul><li>通过一个函数，把任意长度的数据转换为一个长度固定的数据串</li><li>通常用 16 进制的字符串表示</li></ul><p><img src="/assets/网络相关面试题08-6d51c835.png" alt=""></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> md5 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;md5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> origin <span class="token operator">=</span>
  <span class="token string">&quot;sdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfdsdfasdfasdfasfd&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-常见算法-2" tabindex="-1"><a class="header-anchor" href="#_1-常见算法-2" aria-hidden="true">#</a> 1）常见算法</h4><ul><li>MD4</li><li>MD5</li><li>SHA1</li></ul><h4 id="_2-优点-2" tabindex="-1"><a class="header-anchor" href="#_2-优点-2" aria-hidden="true">#</a> 2）优点</h4><ul><li>密文占用空间小（定长的短字符串）</li><li>难以被破解</li></ul><h4 id="_3-缺点-2" tabindex="-1"><a class="header-anchor" href="#_3-缺点-2" aria-hidden="true">#</a> 3）缺点</h4><ul><li>无法解密（算法不可逆）</li></ul><h3 id="_5-面试题-1" tabindex="-1"><a class="header-anchor" href="#_5-面试题-1" aria-hidden="true">#</a> 5.面试题</h3><h4 id="_1-请解释一下对称加密-非对称加密-摘要的概念" tabindex="-1"><a class="header-anchor" href="#_1-请解释一下对称加密-非对称加密-摘要的概念" aria-hidden="true">#</a> 1）请解释一下对称加密，非对称加密，摘要的概念</h4><blockquote><ol><li>密钥</li></ol><p>密钥是一种参数，它是在明文转换为密文或将密文转换为明文的算法中输入的参数。密钥分为对称密钥与非对称密钥，分别应用在对称加密和非对称加密上</p><ol start="2"><li>对称加密</li></ol><p>对称加密又叫做私钥加密，即信息的发送方和接收方使用同一个密钥去加密和解密数据。对称加密的特点是算法公开、加密和解密速度快，适合于对大数据量进行加密，常见的对称加密算法有 DES、3DES、TDEA、Blowfish、RC5 和 IDEA</p><ol start="3"><li>非对称加密</li></ol><p>非对称加密也叫做公钥加密。非对称加密与对称加密相比，其安全性更好。对称加密的通信双方使用相同的密钥，如果一方的密钥遭泄露，那么整个通信就会被破解。而非对称加密使用一对密钥，即公钥和私钥，且二者成对出现。私钥被自己保存，不能对外泄露。公钥指的是公共的密钥，任何人都可以获得该密钥。用公钥或私钥中的任何一个进行加密，用另一个进行解密</p><ol start="4"><li>摘要</li></ol><p>摘要算法又称哈希/散列算法。它通过一个函数，把任意长度的数据转换为一个长度固定的数据串（通常用 16 进制的字符串表示）。算法不可逆</p></blockquote><h2 id="六-jwt" tabindex="-1"><a class="header-anchor" href="#六-jwt" aria-hidden="true">#</a> （六）JWT</h2><h3 id="_1-概述" tabindex="-1"><a class="header-anchor" href="#_1-概述" aria-hidden="true">#</a> 1.概述</h3><ul><li>JWT，Json Web Token，本质就是一个字符串</li><li>在互联网环境中，提供 <mark>统一的、安全的</mark> 令牌格式</li><li>可以存储到 cookie，也可以存储到 localStorage，没有任何限制</li><li>可以使用任何传输方式来传输 JWT <ul><li>一般会使用 <mark>消息头</mark> 来传输它</li></ul></li></ul><h4 id="_1-服务器响应-jwt" tabindex="-1"><a class="header-anchor" href="#_1-服务器响应-jwt" aria-hidden="true">#</a> 1）服务器响应 JWT</h4><ul><li>当登录成功后，服务器可以给客户端响应一个 JWT</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token punctuation">---</span>
set<span class="token punctuation">-</span>cookie<span class="token punctuation">:</span>token=jwt令牌
authentication<span class="token punctuation">:</span>jwt令牌
<span class="token punctuation">---</span>
<span class="token punctuation">{</span> <span class="token punctuation">...</span><span class="token punctuation">,</span> token<span class="token punctuation">:</span>jwt令牌 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>JWT 令牌可以出现在响应的任何一个地方，客户端和服务器自行约定即可</li><li>也可以出现在响应的多个地方 <ul><li>如：为了充分利用浏览器的 cookie，同时为了照顾其他设备</li><li>可以让 JWT 出现在 <code>set-cookie</code> 和 <code>authorization或body</code> 中</li><li>尽管这会增加额外的传输量</li></ul></li></ul><h4 id="_2-客户端存储-jwt" tabindex="-1"><a class="header-anchor" href="#_2-客户端存储-jwt" aria-hidden="true">#</a> 2）客户端存储 JWT</h4><ul><li>可以存储到任何位置 <ul><li>如：手机文件、PC 文件、localStorage、cookie</li></ul></li><li>当后续请求发生时，只需要将它作为请求的一部分发送到服务器即可</li><li>虽然 JWT 没有明确要求应该如何附带到请求中，但通常会使用如下的格式</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>GET /api/resources HTTP/1.1
<span class="token punctuation">---</span>
<span class="token key atrule">authorization</span><span class="token punctuation">:</span> bearer jwt令牌
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>服务器收到令牌后，通过对令牌的验证，即可知道该令牌是否有效</li></ul><h4 id="_3-完整交互流程" tabindex="-1"><a class="header-anchor" href="#_3-完整交互流程" aria-hidden="true">#</a> 3）完整交互流程</h4><p><img src="/assets/Node48-afce9773.png" alt=""></p><h3 id="_2-令牌的组成" tabindex="-1"><a class="header-anchor" href="#_2-令牌的组成" aria-hidden="true">#</a> 2.令牌的组成</h3><blockquote><p>为了保证令牌的安全性，JWT 令牌由三个部分组成</p></blockquote><table><thead><tr><th>组成</th><th>说明</th></tr></thead><tbody><tr><td>header</td><td>令牌头部，记录了整个令牌的类型和签名算法</td></tr><tr><td>payload</td><td>令牌负荷，记录了保存的主体信息<br>如：用户信息</td></tr><tr><td>signature</td><td>令牌签名，按照头部固定的签名算法对整个令牌进行签名<br>该签名的作用是：保证令牌不被伪造和篡改</td></tr></tbody></table><ul><li>完整格式：<code>header.payload.signature</code></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9.BCwUy3jnUQ_E6TqCayc7rCHkx<span class="token punctuation">-</span>vxxdagUwPOWqwYCFc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>各个部分的值 <ul><li>header：<code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</code></li><li>payload：<code>eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</code></li><li>signature: <code>BCwUy3jnUQ_E6TqCayc7rCHkx-vxxdagUwPOWqwYCFc</code></li></ul></li></ul><h4 id="_1-header" tabindex="-1"><a class="header-anchor" href="#_1-header" aria-hidden="true">#</a> 1）header</h4><ul><li>令牌头部，记录了整个令牌的类型和签名算法</li><li>格式是一个 json 对象</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="a-alg" tabindex="-1"><a class="header-anchor" href="#a-alg" aria-hidden="true">#</a> a）alg</h5><ul><li>signature 部分使用的签名算法，通常可以取两个值</li><li>HS256 <ul><li>一种对称加密算法</li><li>使用同一个秘钥对 signature 加密解密</li></ul></li><li>RS256 <ul><li>一种非对称加密算法</li><li>使用私钥签名，公钥验证</li></ul></li></ul><h5 id="b-typ" tabindex="-1"><a class="header-anchor" href="#b-typ" aria-hidden="true">#</a> b）typ</h5><ul><li>整个令牌的类型</li><li>固定写 <code>JWT</code> 即可</li></ul><h5 id="c-生成-header" tabindex="-1"><a class="header-anchor" href="#c-生成-header" aria-hidden="true">#</a> c）生成 header</h5><ul><li>将 header 部分使用 <code>base64 url</code> 编码即可</li></ul><blockquote><p><code>base64 url</code> 不是一个加密算法，而是一种编码方式</p><p>是在 <code>base64</code> 算法的基础上对 <code>+</code> 、 <code>=</code> 、 <code>/</code> 三个字符做出特殊处理的算法</p><p>而 <code>base64</code> 是使用 64 个可打印字符来表示一个二进制数据</p><p>具体的做法参考 <a href="https://baike.baidu.com/item/base64/8545775?fr=aladdin" target="_blank" rel="noopener noreferrer">百度百科<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>浏览器提供了 <code>btoa</code> 函数编码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">alg</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">typ</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 得到字符串：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>浏览器提供了 <code>atob</code> 函数解码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">atob</span><span class="token punctuation">(</span><span class="token string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 得到字符串：{&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>nodejs 中没有提供这两个函数，可以安装第三方库 <code>atob</code> 和 <code>btoa</code> 搞定</p><p>或者，手动搞定</p></blockquote><h4 id="_2-payload" tabindex="-1"><a class="header-anchor" href="#_2-payload" aria-hidden="true">#</a> 2）payload</h4><ul><li>是 JWT 的主体信息</li><li>仍然是一个 JSON 对象</li><li>可以包含以下内容</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;ss&quot;</span>：<span class="token string">&quot;发行者&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;iat&quot;</span>：<span class="token string">&quot;发布时间&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;exp&quot;</span>：<span class="token string">&quot;到期时间&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;sub&quot;</span>：<span class="token string">&quot;主题&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;aud&quot;</span>：<span class="token string">&quot;听众&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;nbf&quot;</span>：<span class="token string">&quot;在此之前不可用&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;jti&quot;</span>：<span class="token string">&quot;JWT ID&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>以上属性可以全写，也可以一个都不写，只是一个规范</p><p>就算写了，也需要在将来验证这个 JWT 令牌时手动处理才能发挥作用</p></blockquote><table><thead><tr><th>属性</th><th>含义</th></tr></thead><tbody><tr><td>ss</td><td>发行该 jwt 的是谁<br>可以写公司名字，也可以写服务名称</td></tr><tr><td>iat</td><td>该 jwt 的发放时间<br>通常写当前时间的时间戳</td></tr><tr><td>exp</td><td>该 jwt 的到期时间<br>通常写时间戳</td></tr><tr><td>sub</td><td>该 jwt 是用于干嘛的</td></tr><tr><td>aud</td><td>该 jwt 是发放给哪个终端的<br>可以是终端类型，也可以是用户名称</td></tr><tr><td>nbf</td><td>一个时间点<br>在该时间点到达之前，这个令牌是不可用的</td></tr><tr><td>jti</td><td>jwt 的唯一编号<br>设置此项的目的是为了防止重放攻击</td></tr></tbody></table><blockquote><p>重放攻击是在某些场景下，用户使用之前的令牌发送到服务器，被服务器正确的识别，从而导致不可预期的行为发生</p></blockquote><ul><li>可以向 payload 对象中加入任何想要加入的信息</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;foo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;iat&quot;</span><span class="token operator">:</span> <span class="token number">1587548215</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>最终需要通过 <code>base64 url</code> 编码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">iat</span><span class="token operator">:</span> <span class="token number">1587548215</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 得到字符串：eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-signature" tabindex="-1"><a class="header-anchor" href="#_3-signature" aria-hidden="true">#</a> 3）signature</h4><ul><li>JWT 的签名，保证了整个 JWT 不被篡改</li><li>这部分的生成，是 <mark>对前面两个部分的编码结果，按照头部指定的方式进行加密</mark></li><li>指定一个秘钥，如：<code>shhhhh</code></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token constant">HS256</span><span class="token punctuation">(</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token string">&quot;shhhhh&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 得到：BCwUy3jnUQ_E6TqCayc7rCHkx-vxxdagUwPOWqwYCFc</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-组合" tabindex="-1"><a class="header-anchor" href="#_4-组合" aria-hidden="true">#</a> 4）组合</h4><ul><li>将三部分组合在一起，就得到了完整的 jwt</li><li>由于签名使用的秘钥保存在服务器，客户端就无法伪造出签名，因为拿不到秘钥</li><li>而前面两部分并没有加密，只是一个编码结果而已，可以认为几乎是明文传输</li></ul><blockquote><p>这不会造成太大的问题，因为既然用户登陆成功了，当然有权力查看自己的用户信息</p><p>甚至在某些网站，用户的基本信息可以被任何人查看</p><p>要保证的是不要把敏感的信息存放到 JWT 中，如：密码</p></blockquote><h3 id="_3-令牌的验证" tabindex="-1"><a class="header-anchor" href="#_3-令牌的验证" aria-hidden="true">#</a> 3.令牌的验证</h3><ul><li>服务器要验证令牌是否被篡改过 <ul><li>就是对 <code>header + payload</code> 用同样的秘钥和加密算法进行重新加密</li></ul></li><li>然后把加密的结果和传入 JWT 的 <code>signature</code> 进行对比 <ul><li>如果完全相同，则表示前面两部分没有动过，就是自己颁发的</li><li>如果不同，肯定是被篡改过了</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>传入的header.传入的payload.传入的signature

新的signature = header中的加密算法(传入的header.传入的payload<span class="token punctuation">,</span> 秘钥)
<span class="token comment"># 验证：新的signature == 传入的signature</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>当令牌验证为没有被篡改后，服务器可以进行其他验证 <ul><li>如：是否过期、听众是否满足要求等等</li></ul></li></ul><blockquote><p>这些验证都需要服务器手动完成，没有哪个服务器会自动验证</p><p>当然，可以借助第三方库来完成</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;jsonwebtoken&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> key <span class="token operator">=</span> <span class="token string">&quot;yuanjinhenshuai&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// const token = jwt.sign({ a: 1, b: 2 }, key);</span>
<span class="token comment">// console.log(token);</span>

<span class="token keyword">const</span> token <span class="token operator">=</span>
  <span class="token string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ7.eyJhIjoxLCJiIjoyLCJpYXQiOjE2MzQ4MDg1Mzh9.EH6KLP-yegEN5H5As7JUzziOenlT5kuHM1Pxj6cJ9C8&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>token<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-jwt-的特点" tabindex="-1"><a class="header-anchor" href="#_4-jwt-的特点" aria-hidden="true">#</a> 4.JWT 的特点</h3><ul><li>JWT 本质上是一种令牌格式 <ul><li>和终端设备、服务器、如何传输无关</li><li>只是规范了令牌的格式而已</li></ul></li><li>JWT 由三部分组成 <ul><li>header、payload、signature</li><li>主体信息在 payload</li></ul></li><li>JWT 难以被篡改和伪造 <ul><li>因为有第三部分签名的存在</li></ul></li></ul><h3 id="_5-面试题-2" tabindex="-1"><a class="header-anchor" href="#_5-面试题-2" aria-hidden="true">#</a> 5.面试题</h3><h4 id="_1-请阐述-jwt-的令牌格式" tabindex="-1"><a class="header-anchor" href="#_1-请阐述-jwt-的令牌格式" aria-hidden="true">#</a> 1）请阐述 JWT 的令牌格式</h4><blockquote><p>token 分为三段，分别是 header、payload、signature</p><ol><li>header 标识签名算法和令牌类型</li><li>payload 标识主体信息，包含令牌过期时间、发布时间、发行者、主体内容等</li><li>signature 是使用特定的算法对前面两部分进行加密，得到的加密结果</li></ol><p>token 有防篡改的特点，如果攻击者改动了前面两个部分，就会导致和第三部分对应不上，使得 token 失效，而攻击者不知道加密秘钥，因此又无法修改第三部分的值</p><p>所以，在秘钥不被泄露的前提下，一个验证通过的 token 是值得被信任的</p></blockquote><h2 id="七-同源策略" tabindex="-1"><a class="header-anchor" href="#七-同源策略" aria-hidden="true">#</a> （七）同源策略</h2><h3 id="_1-概述-1" tabindex="-1"><a class="header-anchor" href="#_1-概述-1" aria-hidden="true">#</a> 1.概述</h3><ul><li>浏览器特有的一个重要的安全策略</li><li>源 = 协议 + 主机 + 端口</li><li>同源：两个源相同</li><li>跨源/跨域：两个源不同</li></ul><table><thead><tr><th>源 1</th><th>源 2</th><th>是否同源</th></tr></thead><tbody><tr><td>http://www.baidu.com</td><td>http://www.baidu.com/news</td><td>✅</td></tr><tr><td>https://www.baidu.com</td><td>http://www.baidu.com</td><td>❌</td></tr><tr><td>http://localhost:5000</td><td>http://localhost:7000</td><td>❌</td></tr><tr><td>http://localhost:5000</td><td>http://127.0.0.1:5000</td><td>❌</td></tr><tr><td>http://www.baidu.com</td><td>http://baidu.com</td><td>❌</td></tr></tbody></table><ul><li>同源策略是指，<mark>若页面的源和页面运行过程中加载的源不一致时，出于安全考虑，浏览器会对跨域的资源访问进行一些限制</mark></li></ul><p><img src="/assets/网络相关面试题09-50fc1514.png" alt=""></p><h3 id="_2-跨域限制对象" tabindex="-1"><a class="header-anchor" href="#_2-跨域限制对象" aria-hidden="true">#</a> 2.跨域限制对象</h3><ul><li>同源策略对 ajax 的跨域限制的最为凶狠</li><li>默认情况下，不允许 ajax 访问跨域资源</li></ul><p><img src="/assets/网络相关面试题10-f21cf712.png" alt=""></p><blockquote><p>通常所说的跨域问题，就是同源策略对 ajax 产生的影响</p></blockquote><h3 id="_3-解决跨域问题" tabindex="-1"><a class="header-anchor" href="#_3-解决跨域问题" aria-hidden="true">#</a> 3.解决跨域问题</h3><ul><li>代理【常用】</li><li>CORS【常用】</li><li>JSONP</li></ul><blockquote><p>无论使用哪一种方式，都是要让浏览器知道，这次跨域请求的是自己人，就不要拦截了</p></blockquote><h2 id="八-跨域-——-代理" tabindex="-1"><a class="header-anchor" href="#八-跨域-——-代理" aria-hidden="true">#</a> （八）跨域 —— 代理</h2><ul><li>对于前端开发而言，大部分的跨域问题，都是通过 <mark>代理</mark> 解决的</li></ul><h3 id="_1-代理适用的场景" tabindex="-1"><a class="header-anchor" href="#_1-代理适用的场景" aria-hidden="true">#</a> 1.代理适用的场景</h3><ul><li>生产环境不发生跨域，开发环境发生跨域</li><li>只需要在开发环境使用代理解决跨域即可，这种代理又称为开发代理</li></ul><p><img src="/assets/网络相关面试题11-c16d0640.png" alt=""></p><h3 id="_2-配置开发代理" tabindex="-1"><a class="header-anchor" href="#_2-配置开发代理" aria-hidden="true">#</a> 2.配置开发代理</h3><ul><li>在实际开发中，只需要对开发服务器稍加配置即可</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// vue 的开发服务器代理配置</span>
<span class="token comment">// vue.config.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 配置开发服务器</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 配置代理</span>
      <span class="token string-property property">&quot;/api&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">// 若请求路径以 /api 开头</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">&quot;http://dev.taobao.com&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 将其转发到 http://dev.taobao.com</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="九-跨域-——-cors" tabindex="-1"><a class="header-anchor" href="#九-跨域-——-cors" aria-hidden="true">#</a> （九）跨域 —— CORS</h2><h3 id="_1-概述-2" tabindex="-1"><a class="header-anchor" href="#_1-概述-2" aria-hidden="true">#</a> 1.概述</h3><ul><li>CORS，Cross-Origin Resource Sharing，跨域资源共享</li><li>是基于 HTTP1.1 的一种跨域解决方案</li><li>总体思路是：<mark>如果浏览器要跨域访问服务器的资源，需要获得服务器的允许</mark></li><li>一个请求可以附带很多信息，从而会对服务器造成不同程度的影响 <ul><li>有的请求只是获取一些新闻</li><li>有的请求会改动服务器的数据</li></ul></li><li>针对不同的请求，CORS 规定了三种不同的交互模式 <ul><li>简单请求</li><li>需要预检的请求</li><li>附带身份凭证的请求</li></ul></li><li>这三种模式从上到下层层递进，请求可以做的事越来越多，要求也越来越严格</li></ul><h3 id="_2-简单请求" tabindex="-1"><a class="header-anchor" href="#_2-简单请求" aria-hidden="true">#</a> 2.简单请求</h3><ul><li>当浏览器端运行了一段 ajax 代码 <ul><li>无论是使用 XMLHttpRequest 还是 fetch api</li></ul></li><li>浏览器会首先判断它属于哪一种请求模式</li></ul><h4 id="_1-简单请求的判定" tabindex="-1"><a class="header-anchor" href="#_1-简单请求的判定" aria-hidden="true">#</a> 1）简单请求的判定</h4><ul><li>当请求 <mark>同时满足</mark> 以下条件时，浏览器会认为是一个简单请求</li></ul><h5 id="a-请求方法属于下面的一种" tabindex="-1"><a class="header-anchor" href="#a-请求方法属于下面的一种" aria-hidden="true">#</a> a）请求方法属于下面的一种</h5><ul><li>get</li><li>post</li><li>head</li></ul><h5 id="b-请求头仅包含安全的字段" tabindex="-1"><a class="header-anchor" href="#b-请求头仅包含安全的字段" aria-hidden="true">#</a> b）请求头仅包含安全的字段</h5><ul><li>常见的安全字段 <ul><li>Accept</li><li>Accept-Language</li><li>Content-Language</li><li>Content-Type</li><li>DPR</li><li>Downlink</li><li>Save-Data</li><li>Viewport-Width</li><li>Width</li></ul></li></ul><h5 id="c-请求头如果包含-content-type-仅限下面的值之一" tabindex="-1"><a class="header-anchor" href="#c-请求头如果包含-content-type-仅限下面的值之一" aria-hidden="true">#</a> c）请求头如果包含 <code>Content-Type</code> ，仅限下面的值之一</h5><ul><li>text/plain</li><li>multipart/form-data</li><li>application/x-www-form-urlencoded（默认）</li></ul><h5 id="d-示例" tabindex="-1"><a class="header-anchor" href="#d-示例" aria-hidden="true">#</a> d）示例</h5><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 请求方法不满足要求，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 加入了额外的请求头，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// content-type不满足要求，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-简单请求的交互规范" tabindex="-1"><a class="header-anchor" href="#_2-简单请求的交互规范" aria-hidden="true">#</a> 2）简单请求的交互规范</h4><ul><li>当浏览器判定某个 <mark>ajax 跨域请求</mark> 是简单请求时</li></ul><h5 id="a-请求头中会自动添加-origin-字段" tabindex="-1"><a class="header-anchor" href="#a-请求头中会自动添加-origin-字段" aria-hidden="true">#</a> a）请求头中会自动添加 <code>Origin</code> 字段</h5><ul><li>如：在页面 <code>http://my.com/index.html</code> 中有以下代码造成了跨域</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>请求发出后，请求头会是下面的格式</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>GET /api/news/ HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive
<span class="token punctuation">...</span>
<span class="token key atrule">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com/index.html
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>最后一行 <code>Origin</code> 字段会告诉服务器，是哪个源地址在跨域请求</li></ul><h5 id="b-服务器响应头中应包含-access-control-allow-origin" tabindex="-1"><a class="header-anchor" href="#b-服务器响应头中应包含-access-control-allow-origin" aria-hidden="true">#</a> b）服务器响应头中应包含 <code>Access-Control-Allow-Origin</code></h5><ul><li>当服务器收到请求后，如果允许该请求跨域访问，需要在响应头中添加 <code>Access-Control-Allow-Origin</code> 字段</li><li>该字段的值可以是 <ul><li><code>*</code> ：表示我很开放，什么人我都允许访问</li><li>具体的源：如：<code>http://my.com</code>，表示就允许该源访问</li></ul></li></ul><blockquote><p>实际上，这两个值对于客户端 <code>http://my.com</code> 而言都一样，因为客户端才不会管其他源服务器允不允许，就关心自己是否被允许</p><p>当然，服务器也可以维护一个可被允许的源列表，如果请求的 <code>Origin</code> 命中该列表，才响应 <code>*</code> 或具体的源</p><p><mark>为了避免后续的麻烦，强烈推荐响应具体的源</mark></p></blockquote><p><img src="/assets/Node44-6858658c.png" alt=""></p><h3 id="_3-需要预检的请求" tabindex="-1"><a class="header-anchor" href="#_3-需要预检的请求" aria-hidden="true">#</a> 3.需要预检的请求</h3><blockquote><p>简单的请求对服务器的威胁不大，所以允许使用上述的简单交互即可完成</p><p>但是，如果浏览器不认为这是一种简单请求，就会按照下面的流程进行</p></blockquote><ul><li>浏览器发送预检请求，询问服务器是否允许</li><li>服务器允许</li><li>浏览器发送真实请求</li><li>服务器完成真实的响应</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 需要预检的请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/user&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token comment">// post 请求</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置请求头</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;袁小进&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 设置请求体</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>浏览器发现它不是一个简单请求，则会按照下面的流程与服务器交互</li></ul><h4 id="_1-浏览器发送预检请求-询问服务器是否允许" tabindex="-1"><a class="header-anchor" href="#_1-浏览器发送预检请求-询问服务器是否允许" aria-hidden="true">#</a> 1）浏览器发送预检请求，询问服务器是否允许</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>OPTIONS /api/user HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token punctuation">...</span>
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token key atrule">Access-Control-Request-Method</span><span class="token punctuation">:</span> POST
<span class="token key atrule">Access-Control-Request-Headers</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> content<span class="token punctuation">-</span>type
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>这并非想要发出的真实请求，请求中不包含请求头，也没有消息体</li><li>这是一个预检请求，目的是询问服务器，是否允许后续的真实请求</li><li>预检请求 <mark>没有请求体</mark> ，包含了后续真实请求要做的事情</li><li>预检请求有以下特征</li></ul><h5 id="a-请求方法为-options" tabindex="-1"><a class="header-anchor" href="#a-请求方法为-options" aria-hidden="true">#</a> a）请求方法为 <code>OPTIONS</code></h5><h5 id="b-没有请求体" tabindex="-1"><a class="header-anchor" href="#b-没有请求体" aria-hidden="true">#</a> b）没有请求体</h5><h5 id="c-请求头中包含" tabindex="-1"><a class="header-anchor" href="#c-请求头中包含" aria-hidden="true">#</a> c）请求头中包含</h5><ul><li><code>Origin</code>：请求的源，和简单请求的含义一致</li><li><code>Access-Control-Request-Method</code>：后续的真实请求将使用的请求方法</li><li><code>Access-Control-Request-Headers</code>：后续的真实请求会改动的请求头</li></ul><h4 id="_2-服务器允许" tabindex="-1"><a class="header-anchor" href="#_2-服务器允许" aria-hidden="true">#</a> 2）服务器允许</h4><ul><li>服务器收到预检请求后，可以检查预检请求中包含的信息</li><li>如果允许这样的请求，需要响应下面的消息格式</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Tue<span class="token punctuation">,</span> 21 Apr 2020 08<span class="token punctuation">:</span>03<span class="token punctuation">:</span>35 GMT
<span class="token punctuation">...</span>
<span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token key atrule">Access-Control-Allow-Methods</span><span class="token punctuation">:</span> POST
<span class="token key atrule">Access-Control-Allow-Headers</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> content<span class="token punctuation">-</span>type
<span class="token key atrule">Access-Control-Max-Age</span><span class="token punctuation">:</span> <span class="token number">86400</span>
<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>对于预检请求，不需要响应任何的消息体，只需要在响应头中添加 <ul><li><code>Access-Control-Allow-Origin</code>：和简单请求一样，表示允许的源</li><li><code>Access-Control-Allow-Methods</code>：表示允许的后续真实的请求方法</li><li><code>Access-Control-Allow-Headers</code>：表示允许改动的请求头</li><li><code>Access-Control-Max-Age</code>：告诉浏览器，多少秒内，对于同样的请求源、方法、头，都不需要再发送预检请求了</li></ul></li></ul><h4 id="_3-浏览器发送真实请求" tabindex="-1"><a class="header-anchor" href="#_3-浏览器发送真实请求" aria-hidden="true">#</a> 3）浏览器发送真实请求</h4><ul><li>预检被服务器允许后，浏览器就会发送真实请求</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>POST /api/user HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive
<span class="token punctuation">...</span>
<span class="token key atrule">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com/index.html
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com

<span class="token punctuation">{</span><span class="token key atrule">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;袁小进&quot;</span><span class="token punctuation">,</span> <span class="token key atrule">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-服务器响应真实请求" tabindex="-1"><a class="header-anchor" href="#_4-服务器响应真实请求" aria-hidden="true">#</a> 4）服务器响应真实请求</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Tue<span class="token punctuation">,</span> 21 Apr 2020 08<span class="token punctuation">:</span>03<span class="token punctuation">:</span>35 GMT
<span class="token punctuation">...</span>
<span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token punctuation">...</span>

添加用户成功
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>完成预检后，后续的处理与简单请求相同</li></ul><p><img src="/assets/Node45-b0ac45ab.png" alt=""></p><h3 id="_4-附带身份凭证的请求" tabindex="-1"><a class="header-anchor" href="#_4-附带身份凭证的请求" aria-hidden="true">#</a> 4.附带身份凭证的请求</h3><ul><li>默认情况下，ajax 的跨域请求并不会附带 cookie，某些需要权限的操作就无法进行</li><li>可以通过简单的配置实现附带 cookie</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// xhr</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// fetch api</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>该跨域的 ajax 请求就是一个附带身份凭证的请求</li><li>当一个请求需要附带 cookie 时，无论它是简单请求，还是预检请求，都会在请求头中添加 <code>cookie</code> 字段</li><li>而服务器响应时，需要明确告知客户端：服务器允许这样的凭据 <ul><li>只需要在响应头中添加： <code>Access-Control-Allow-Credentials: true</code></li></ul></li><li>对于一个附带身份凭证的请求，若服务器没有明确告知，浏览器仍然视为跨域被拒绝</li><li><mark>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin</code> 的值为 <code>*</code></mark><ul><li>这就是为什么不推荐使用 <code>*</code> 的原因</li></ul></li></ul><h3 id="_5-js-访问指定的响应头" tabindex="-1"><a class="header-anchor" href="#_5-js-访问指定的响应头" aria-hidden="true">#</a> 5.JS 访问指定的响应头</h3><ul><li>在跨域访问时，JS 只能拿到一些最基本的响应头 <ul><li>如：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma</li></ul></li><li>如果要访问其他头，则需要服务器设置本响应头</li><li><code>Access-Control-Expose-Headers</code> 头让服务器把允许浏览器访问的头放入白名单</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Expose-Headers</span><span class="token punctuation">:</span> authorization<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="十-跨域-——-jsonp" tabindex="-1"><a class="header-anchor" href="#十-跨域-——-jsonp" aria-hidden="true">#</a> （十）跨域 —— JSONP</h2><blockquote><p>在 CORS 出现之前，人们想了一种奇妙的办法来实现跨域，这就是 JSONP</p><p>要实现 JSONP，需要浏览器和服务器来一个天衣无缝的绝妙配合</p></blockquote><ul><li>当需要跨域请求时，不使用 AJAX，转而生成一个 script 元素去请求服务器</li><li>由于浏览器并不阻止 script 元素的请求，这样请求可以到达服务器</li><li>服务器拿到请求后，响应一段 JS 代码，这段代码实际上是一个函数调用</li><li>调用的是客户端预先生成好的函数，并把浏览器需要的数据作为参数传递到函数中</li><li>从而间接的把数据传递给客户端</li></ul><p><img src="/assets/网络相关面试题12-862485f0.png" alt=""></p><ul><li>JSONP 有着明显的缺点，<mark>只能支持 GET 请求</mark></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>点击获取用户<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;script&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    script<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
    script<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      script<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">request</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000/api/user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token string">&quot;/api/user&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;monica&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">&quot;female&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;姬成&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">&quot;male&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;邓旭明&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">&quot;male&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;content-type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/javascript&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">callback(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>users<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">8000</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server listen on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">request for users: http://localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="十一-文件上传" tabindex="-1"><a class="header-anchor" href="#十一-文件上传" aria-hidden="true">#</a> （十一）文件上传</h2><h3 id="_1-文件上传的消息格式" tabindex="-1"><a class="header-anchor" href="#_1-文件上传的消息格式" aria-hidden="true">#</a> 1.文件上传的消息格式</h3><ul><li>文件上传的本质仍然是一个数据提交，无非就是数据量大一些而已</li></ul><blockquote><p>在实践中，人们逐渐的形成了一种共识</p><p>自行规定，文件上传默认使用下面的请求格式</p></blockquote><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>POST 上传地址 HTTP/1.1
其他请求头
<span class="token key atrule">Content-Type</span><span class="token punctuation">:</span> multipart/form<span class="token punctuation">-</span>data; boundary=<span class="token punctuation">---</span><span class="token punctuation">-</span>WebKitFormBoundary7MA4YWxkTrZu0gW

<span class="token punctuation">---</span><span class="token punctuation">-</span>WebKitFormBoundary7MA4YWxkTrZu0gW
<span class="token key atrule">Content-Disposition</span><span class="token punctuation">:</span> form<span class="token punctuation">-</span>data; name=&quot;avatar&quot;; filename=&quot;小仙女.jpg&quot;
<span class="token key atrule">Content-Type</span><span class="token punctuation">:</span> image/jpeg

(文件二进制数据)
<span class="token punctuation">---</span><span class="token punctuation">-</span>WebKitFormBoundary7MA4YWxkTrZu0gW
<span class="token key atrule">Content-Disposition</span><span class="token punctuation">:</span> form<span class="token punctuation">-</span>data; name=&quot;username&quot;

admin
<span class="token punctuation">---</span><span class="token punctuation">-</span>WebKitFormBoundary7MA4YWxkTrZu0gW
<span class="token key atrule">Content-Disposition</span><span class="token punctuation">:</span> form<span class="token punctuation">-</span>data; name=&quot;password&quot;

123123
<span class="token punctuation">---</span><span class="token punctuation">-</span>WebKitFormBoundary7MA4YWxkTrZu0gW
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>除非接口文档特别说明，文件上传一般使用 <mark>POST 请求</mark></li><li>接口文档中会规定上传地址，一般 <mark>一个站点会有一个统一的上传地址</mark></li><li>除非接口文档特别说明，一般设置 <code>content-type: multipart/form-data</code><ul><li>浏览器会自动分配一个定界符 <code>boundary</code></li></ul></li><li>请求体的格式是一个被定界符 <code>boundary</code> 分割的消息，每个分割区域本质就是 <mark>一个键值对</mark></li><li>除了键值对外，<code>multipart/form-data</code> 允许添加其他额外信息 <ul><li>如：文件数据区域</li><li>一般会把 <mark>文件在本地的名称</mark> 和 <mark>文件 MIME 类型</mark> 告诉服务器</li></ul></li></ul><h3 id="_2-实现文件上传" tabindex="-1"><a class="header-anchor" href="#_2-实现文件上传" aria-hidden="true">#</a> 2.实现文件上传</h3><ul><li>在现代的网页交互中，带表单的文件上传通常使用下面的方式实现</li></ul><p><img src="/assets/网络相关面试题13-696e4d3e.png" alt=""></p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>文件上传<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
      <span class="token selector">*</span> <span class="token punctuation">{</span>
        <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.form-container</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.form-item</span> <span class="token punctuation">{</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 1.5em 0<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.title</span> <span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">input</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">img</span> <span class="token punctuation">{</span>
        <span class="token property">max-width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
        <span class="token property">max-height</span><span class="token punctuation">:</span> 250px<span class="token punctuation">;</span>
        <span class="token property">margin-top</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.submit</span> <span class="token punctuation">{</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">background</span><span class="token punctuation">:</span> #0057d8<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #0141a0<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> 0.2s<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.submit:hover</span> <span class="token punctuation">{</span>
        <span class="token property">background</span><span class="token punctuation">:</span> #0061f3<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #0057d8<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>账号<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          头像
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnupload<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>上传文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileUploader<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>avatar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>提交注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">const</span> doms <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">password</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#password&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">btnUpload</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#btnupload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">fileUploader</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#fileUploader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">submit</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.submit&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">avatar</span><span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#avatar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      doms<span class="token punctuation">.</span>btnUpload<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        doms<span class="token punctuation">.</span>fileUploader<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      doms<span class="token punctuation">.</span>fileUploader<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 一般先会在这里对文件进行验证</span>
        <span class="token comment">// console.log(doms.fileUploader.files);</span>

        <span class="token comment">// 上传文件</span>
        <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> doms<span class="token punctuation">.</span>fileUploader<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加一个键值对</span>

        <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000/api/upload&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">body</span><span class="token operator">:</span> formData<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doms<span class="token punctuation">.</span>avatar<span class="token punctuation">.</span>src <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      doms<span class="token punctuation">.</span>submit<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000/api/user/reg&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> doms<span class="token punctuation">.</span>username<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
            <span class="token literal-property property">password</span><span class="token operator">:</span> doms<span class="token punctuation">.</span>password<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
            <span class="token literal-property property">avatar</span><span class="token operator">:</span> doms<span class="token punctuation">.</span>avatar<span class="token punctuation">.</span>src<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-统一上传接口" tabindex="-1"><a class="header-anchor" href="#_3-统一上传接口" aria-hidden="true">#</a> 3.统一上传接口</h3><h4 id="_1-接口文档" tabindex="-1"><a class="header-anchor" href="#_1-接口文档" aria-hidden="true">#</a> 1）接口文档</h4><table><thead><tr><th>参数</th><th>取值</th></tr></thead><tbody><tr><td>请求路径</td><td>/api/upload</td></tr><tr><td>请求方法</td><td>POST</td></tr><tr><td>字段名</td><td>file</td></tr><tr><td>尺寸限制</td><td>1M</td></tr><tr><td>支持的文件后缀</td><td>.jpg, .jpeg, .gif, .png, .bmp, .webp</td></tr></tbody></table><ul><li>上传成功的响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8000/upload/a32d18.jpg&quot;</span> <span class="token comment">// 访问路径</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>可能发生的失败响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;文件超过了限制&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;无效的文件类型&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-实现" tabindex="-1"><a class="header-anchor" href="#_2-实现" aria-hidden="true">#</a> 2）实现</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">fieldName</span><span class="token operator">:</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">sizeLimit</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.jpeg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.gif&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.png&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.bmp&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;.webp&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">saveDir</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./public/upload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">createFilename</span><span class="token punctuation">(</span><span class="token parameter">ext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ext<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ext <span class="token operator">=</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> ext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> rad <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> rad <span class="token operator">+</span> time <span class="token operator">+</span> ext<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> multer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;multer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> storage <span class="token operator">=</span> multer<span class="token punctuation">.</span><span class="token function">diskStorage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">destination</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> file<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span>saveDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">filename</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> file<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ext <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> config<span class="token punctuation">.</span><span class="token function">createFilename</span><span class="token punctuation">(</span>ext<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ExtendNameError</span> <span class="token keyword">extends</span> <span class="token class-name">Error</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">const</span> upload <span class="token operator">=</span> <span class="token function">multer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  storage<span class="token punctuation">,</span>
  <span class="token function">fileFilter</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> file<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ext <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>originalname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>extends<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>ext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">cb</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ExtendNameError</span><span class="token punctuation">(</span><span class="token string">&quot;无效的文件类型&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">limits</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">fileSize</span><span class="token operator">:</span> config<span class="token punctuation">.</span>sizeLimit<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">single</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>fieldName<span class="token punctuation">)</span><span class="token punctuation">;</span>

router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">upload</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> msg<span class="token punctuation">;</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>err<span class="token punctuation">.</span>message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;File too large&quot;</span><span class="token operator">:</span>
          msg <span class="token operator">=</span> <span class="token string">&quot;文件大小超过了限制&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;Unexpected field&quot;</span><span class="token operator">:</span>
          msg <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">无法找到</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fieldName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">字段</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
          <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err <span class="token keyword">instanceof</span> <span class="token class-name">ExtendNameError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        msg <span class="token operator">=</span> err<span class="token punctuation">.</span>message<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
        msg<span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>protocol<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>hostname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>
          <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port
        <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/upload/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span>file<span class="token punctuation">.</span>filename<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-用户注册接口" tabindex="-1"><a class="header-anchor" href="#_4-用户注册接口" aria-hidden="true">#</a> 4.用户注册接口</h3><h4 id="_1-接口文档-1" tabindex="-1"><a class="header-anchor" href="#_1-接口文档-1" aria-hidden="true">#</a> 1）接口文档</h4><table><thead><tr><th>参数</th><th>取值</th></tr></thead><tbody><tr><td>请求路径</td><td>/api/user/reg</td></tr><tr><td>请求方法</td><td>POST</td></tr><tr><td>支持的消息类型</td><td>x-www-form-urlencoded<br>json</td></tr></tbody></table><ul><li>字段</li></ul><table><thead><tr><th>字段名</th><th>含义</th><th>是否必须</th></tr></thead><tbody><tr><td>username</td><td>账号</td><td>是</td></tr><tr><td>password</td><td>密码</td><td>是</td></tr><tr><td>avatar</td><td>头像</td><td>是</td></tr></tbody></table><ul><li>注册成功的响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;username&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monica&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;avatar&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8000/upload/a234wq1.jpg&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-实现-1" tabindex="-1"><a class="header-anchor" href="#_2-实现-1" aria-hidden="true">#</a> 2）实现</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/reg&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  users<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">username</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">,</span>
      <span class="token literal-property property">avatar</span><span class="token operator">:</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>avatar<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="十二-输入-url-地址后" tabindex="-1"><a class="header-anchor" href="#十二-输入-url-地址后" aria-hidden="true">#</a> （十二）输入 URL 地址后</h2><h3 id="_1-面试题-1" tabindex="-1"><a class="header-anchor" href="#_1-面试题-1" aria-hidden="true">#</a> 1.面试题</h3><h4 id="_1-在浏览器地址栏输入地址-并按下回车键后-发生了哪些事情" tabindex="-1"><a class="header-anchor" href="#_1-在浏览器地址栏输入地址-并按下回车键后-发生了哪些事情" aria-hidden="true">#</a> 1）在浏览器地址栏输入地址，并按下回车键后，发生了哪些事情？</h4><blockquote><ol><li>浏览器自动补全协议、端口</li><li>浏览器自动完成 url 编码</li><li>浏览器根据 url 地址查找本地缓存，根据缓存规则看是否命中缓存，若命中缓存则直接使用缓存，不再发出请求</li><li>通过 DNS 解析找到服务器的 IP 地址</li><li>浏览器向服务器发出建立 TCP 连接的申请，完成三次握手后，连接通道建立</li><li>若使用了 HTTPS 协议，则还会进行 SSL 握手，建立加密信道。使用 SSL 握手时，会确定是否使用 HTTP2</li><li>浏览器决定要附带哪些 cookie 到请求头中</li><li>浏览器自动设置好请求头、协议版本、cookie，发出 GET 请求</li><li>服务器处理请求，进入后端处理流程。完成处理后，服务器响应一个 HTTP 报文给浏览器</li><li>浏览器根据使用的协议版本，以及 Connection 字段的约定，决定是否要保留 TCP 连接</li><li>浏览器根据响应状态码决定如何处理这一次响应</li><li>浏览器根据响应头中的 Content-Type 字段识别响应类型，如果是 text/html，则对响应体的内容进行 HTML 解析，否则做其他处理</li><li>浏览器根据响应头的其他内容完成缓存、cookie 的设置</li><li>浏览器开始从上到下解析 HTML，若遇到外部资源链接，则进一步请求资源</li><li>解析过程中生成 DOM 树、CSSOM 树，然后一边生成，一边把二者合并为渲染树（rendering tree），随后对渲染树中的每个节点计算位置和大小（reflow），最后把每个节点利用 GPU 绘制到屏幕（repaint）</li><li>在解析过程中还会触发一系列的事件，当 DOM 树完成后会触发 DOMContentLoaded 事件，当所有资源加载完毕后会触发 load 事件</li></ol></blockquote><h2 id="十三-文件下载" tabindex="-1"><a class="header-anchor" href="#十三-文件下载" aria-hidden="true">#</a> （十三）文件下载</h2><h3 id="_1-文件下载的消息格式" tabindex="-1"><a class="header-anchor" href="#_1-文件下载的消息格式" aria-hidden="true">#</a> 1.文件下载的消息格式</h3><ul><li>服务器触发浏览器的下载功能，只需要在响应头中加入</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Content-Disposition</span><span class="token punctuation">:</span> attachment; filename=&quot;xxx&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_1-attachment" tabindex="-1"><a class="header-anchor" href="#_1-attachment" aria-hidden="true">#</a> 1）attachment</h4><ul><li>表示附件</li><li>浏览器看到此字段，触发下载行为</li><li>不同的浏览器下载行为有所区别</li></ul><h4 id="_2-filename-xxx" tabindex="-1"><a class="header-anchor" href="#_2-filename-xxx" aria-hidden="true">#</a> 2）filename=&quot;xxx&quot;</h4><ul><li>告诉浏览器，保存文件时使用的默认文件名</li></ul><h3 id="_2-启用迅雷下载" tabindex="-1"><a class="header-anchor" href="#_2-启用迅雷下载" aria-hidden="true">#</a> 2.启用迅雷下载</h3><blockquote><p>用户可能安装了某些下载工具，这些下载工具在安装时，都会自动安装相应的浏览器插件</p><p>只要对下载地址稍作修改，就会触发浏览器使用插件进行下载</p><p>不同插件的地址规则不同</p></blockquote><ul><li>迅雷的下载地址规则为</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>thunder<span class="token punctuation">:</span>//base64(AA地址ZZ)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">data-res</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>thunder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:8000/download/Wallpaper1.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  下载桌面壁纸1
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">data-res</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>thunder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://localhost:8000/download/Wallpaper2.jpg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  下载桌面壁纸2
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">const</span> links <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;[data-res=thunder]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> link <span class="token keyword">of</span> links<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> base64 <span class="token operator">=</span> <span class="token function">btoa</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">AA</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>link<span class="token punctuation">.</span>href<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ZZ</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> href <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">thunder://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>base64<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    link<span class="token punctuation">.</span>href <span class="token operator">=</span> href<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-服务器下载接口" tabindex="-1"><a class="header-anchor" href="#_3-服务器下载接口" aria-hidden="true">#</a> 3.服务器下载接口</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token number">8000</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/download/:filename&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./res&quot;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

  res<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server listen on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="十四-session" tabindex="-1"><a class="header-anchor" href="#十四-session" aria-hidden="true">#</a> （十四）session</h2><h3 id="_1-cookie-的缺陷" tabindex="-1"><a class="header-anchor" href="#_1-cookie-的缺陷" aria-hidden="true">#</a> 1.cookie 的缺陷</h3><ul><li>cookie 是保存在客户端的，虽然为服务器减少了很多压力，但某些情况下，会出现麻烦</li><li>如：验证码</li></ul><p><img src="/assets/网络相关面试题14-31d65a21.png" alt=""></p><blockquote><p>如果这样做，客户端可以随便填写一个别人的手机号</p><p>然后从 cookie 中获取到验证码，从而绕开整个验证</p><p>因此，有些敏感数据是万万不能发送给客户端的</p></blockquote><h3 id="_2-session-流程" tabindex="-1"><a class="header-anchor" href="#_2-session-流程" aria-hidden="true">#</a> 2.session 流程</h3><p><img src="/assets/网络相关面试题15-f5376136.png" alt=""></p><ul><li>session 也是键值对</li><li>保存在服务器端，通过 sessionid 和客户端关联</li></ul><h3 id="_3-面试题-1" tabindex="-1"><a class="header-anchor" href="#_3-面试题-1" aria-hidden="true">#</a> 3.面试题</h3><h4 id="_1-cookie-和-session-的区别是什么" tabindex="-1"><a class="header-anchor" href="#_1-cookie-和-session-的区别是什么" aria-hidden="true">#</a> 1）cookie 和 session 的区别是什么？</h4><blockquote><ol><li>cookie 的数据保存在浏览器端；session 的数据保存在服务器</li><li>cookie 的存储空间有限；session 的存储空间不限</li><li>cookie 只能保存字符串；session 可以保存任何类型的数据</li><li>cookie 中的数据容易被获取；session 中的数据难以获取</li></ol></blockquote><h4 id="_2-如何消除-session" tabindex="-1"><a class="header-anchor" href="#_2-如何消除-session" aria-hidden="true">#</a> 2）如何消除 session</h4><blockquote><ol><li>过期时间</li></ol><p>当客户端长时间没有传递 sessionid 过来时，服务器可以在过期时间之后自动清除 session</p><ol start="2"><li>客户端主动通知</li></ol><p>可以使用 JS 监听客户端页面关闭或其他退出操作，然后通知服务器清除 session</p></blockquote><h2 id="十五-http-缓存协议" tabindex="-1"><a class="header-anchor" href="#十五-http-缓存协议" aria-hidden="true">#</a> （十五）HTTP 缓存协议</h2><h3 id="_1-缓存的基本原理" tabindex="-1"><a class="header-anchor" href="#_1-缓存的基本原理" aria-hidden="true">#</a> 1.缓存的基本原理</h3><ul><li>在一个 C/S 结构中，最基本的缓存分为两种 <ul><li>客户端缓存</li><li>服务器缓存</li></ul></li></ul><h4 id="_1-客户端缓存" tabindex="-1"><a class="header-anchor" href="#_1-客户端缓存" aria-hidden="true">#</a> 1）客户端缓存</h4><ul><li>将某一次的响应结果保存在客户端（如：浏览器）中</li><li>而后续的请求仅需要从缓存中读取即可</li><li>极大的降低了服务器的处理压力</li></ul><h4 id="_2-客户端缓存的原理" tabindex="-1"><a class="header-anchor" href="#_2-客户端缓存的原理" aria-hidden="true">#</a> 2）客户端缓存的原理</h4><p><img src="/assets/Node51-63f83bac.png" alt=""></p><h4 id="_3-缓存策略的问题" tabindex="-1"><a class="header-anchor" href="#_3-缓存策略的问题" aria-hidden="true">#</a> 3）缓存策略的问题</h4><ul><li>哪些资源需要加入到缓存，哪些不需要？</li><li>缓存的时间是多久呢？</li><li>如果服务器的资源有改动，客户端如何更新缓存呢？</li><li>如果缓存过期了，可是服务器上的资源并没有发生变动，又该如何处理呢？</li><li>.......</li></ul><h3 id="_2-来自服务器的缓存指令" tabindex="-1"><a class="header-anchor" href="#_2-来自服务器的缓存指令" aria-hidden="true">#</a> 2.来自服务器的缓存指令</h3><p><img src="/assets/Node52-4a08e02d.png" alt=""></p><h3 id="_3-来自客户端的缓存指令" tabindex="-1"><a class="header-anchor" href="#_3-来自客户端的缓存指令" aria-hidden="true">#</a> 3.来自客户端的缓存指令</h3><blockquote><p>客户端会到缓存中去寻找是否有缓存的资源</p><p>寻找的过程如下</p><ol><li>缓存中是否有匹配的请求方法和路径？</li><li>如果有，该缓存资源是否还有效呢？</li></ol><p>以上两个验证会导致浏览器产生不同的行为</p></blockquote><p><img src="/assets/Node53-adeb6a24.png" alt=""></p><p><img src="/assets/Node54-c6d9c186.png" alt=""></p><h4 id="_1-验证是否有匹配的缓存" tabindex="-1"><a class="header-anchor" href="#_1-验证是否有匹配的缓存" aria-hidden="true">#</a> 1）验证是否有匹配的缓存</h4><ul><li>只需要验证当前的请求方法 <code>GET</code> 和当前的请求路径 <code>/index.js</code> 是否有对应的缓存存在即可</li><li>如果没有，就直接请求服务器</li></ul><h4 id="_2-验证缓存是否有效" tabindex="-1"><a class="header-anchor" href="#_2-验证缓存是否有效" aria-hidden="true">#</a> 2）验证缓存是否有效</h4><ul><li><code>max-age + Date</code>，得到一个过期时间</li><li>看看这个过期时间是否大于当前时间</li><li>如果是，则表示缓存还没有过期，仍然有效</li><li>如果不是，则表示缓存失效</li></ul><h4 id="_3-缓存有效" tabindex="-1"><a class="header-anchor" href="#_3-缓存有效" aria-hidden="true">#</a> 3）缓存有效</h4><ul><li>当浏览器发现缓存有效时，完全不会请求服务器，直接使用缓存即可得到结果</li></ul><blockquote><p>此时，如果断开网络，会发现资源仍然可用</p></blockquote><ul><li>这种情况会极大的降低服务器压力</li><li>但当服务器更改了资源后，浏览器是不知道的 <ul><li>只要缓存有效，就会直接使用缓存</li></ul></li></ul><h4 id="_4-缓存无效" tabindex="-1"><a class="header-anchor" href="#_4-缓存无效" aria-hidden="true">#</a> 4）缓存无效</h4><ul><li>当浏览器发现缓存已经过期，<mark>并不会简单的把缓存删除</mark></li><li>而是向服务器发出了一个 <mark>带缓存的请求</mark>，又称为 <mark>协商缓存</mark><ul><li>就是加入了以下的请求头</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">If-Modified-Since</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 08<span class="token punctuation">:</span>16<span class="token punctuation">:</span>31 GMT
<span class="token key atrule">If-None-Match</span><span class="token punctuation">:</span> W/&quot;121<span class="token punctuation">-</span>171ca289ebf&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>之所以要发两个信息，是为了兼容不同的服务器</p><p>因为有些服务器只认 <code>If-Modified-Since</code>，有些服务器只认 <code>If-None-Match</code>，有些服务器两个都认</p><p>目前的很多服务器，只要发现 <code>If-None-Match</code> 存在，就不会去看 <code>If-Modified-Since</code></p><p><code>If-Modified-Since</code> 是 http1.0 版本的规范，<code>If-None-Match</code> 是 http1.1 的规范</p></blockquote><ul><li>服务器可能会产生两个情况</li></ul><h5 id="a-缓存已经失效" tabindex="-1"><a class="header-anchor" href="#a-缓存已经失效" aria-hidden="true">#</a> a）缓存已经失效</h5><ul><li>服务器再次给予一个正常的响应（响应码 200，带响应体）</li><li>同时可以附带上新的缓存指令</li><li>客户端重新缓存新的内容</li></ul><blockquote><p>这就回到了上一节——来自服务器的缓存指令</p></blockquote><h5 id="b-缓存仍然有效" tabindex="-1"><a class="header-anchor" href="#b-缓存仍然有效" aria-hidden="true">#</a> b）缓存仍然有效</h5><ul><li>响应码为 <code>304 Not Modified</code>，无响应体</li><li>响应头带上新的缓存指令</li><li>客户端继续使用缓存</li></ul><blockquote><p>可以最大程度的减少网络传输，因为如果资源还有效，服务器就不会传输消息体</p></blockquote><ul><li>完整的交互过程</li></ul><p><img src="/assets/Node55-463f09ce.png" alt=""></p><h3 id="_4-cache-control" tabindex="-1"><a class="header-anchor" href="#_4-cache-control" aria-hidden="true">#</a> 4.Cache-Control</h3><ul><li>Cache-Control 是服务器向客户端响应的一个消息头，提供了一个 <code>max-age</code> 用于指定缓存时间</li><li>Cache-Control 还可以设置下面一个或多个值</li></ul><h4 id="_1-public" tabindex="-1"><a class="header-anchor" href="#_1-public" aria-hidden="true">#</a> 1）public</h4><ul><li>指示服务器资源是公开的</li></ul><blockquote><p>有一个页面资源，所有人看到的都是一样的。这个值对于浏览器而言没有什么意义，但可能在某些场景可能有用。本着「我告知，你随意」的原则，http 协议中很多时候都是客户端或服务器告诉另一端详细的信息，至于另一端用不用，完全看它自己</p></blockquote><h4 id="_2-private" tabindex="-1"><a class="header-anchor" href="#_2-private" aria-hidden="true">#</a> 2）private</h4><ul><li>指示服务器资源是私有的</li></ul><blockquote><p>有一个页面资源，每个用户看到的都不一样。这个值对于浏览器而言没有什么意义，但可能在某些场景可能有用。本着「我告知，你随意」的原则，http 协议中很多时候都是客户端或服务器告诉另一端详细的信息，至于另一端用不用，完全看它自己</p></blockquote><h4 id="_3-no-cache" tabindex="-1"><a class="header-anchor" href="#_3-no-cache" aria-hidden="true">#</a> 3）no-cache</h4><ul><li>告知客户端可以缓存这个资源，但是不要 <mark>直接</mark> 使用</li><li>缓存之后，后续的每一次请求都需要附带缓存指令，让服务器验证这个资源有没有过期</li></ul><h4 id="_4-no-store" tabindex="-1"><a class="header-anchor" href="#_4-no-store" aria-hidden="true">#</a> 4）no-store</h4><ul><li>告知客户端不要对这个资源做任何的缓存，之后的每一次请求都按照正常的普通请求进行</li><li>若设置了这个值，浏览器将不会对该资源做出任何的缓存处理</li></ul><h4 id="_5-max-age" tabindex="-1"><a class="header-anchor" href="#_5-max-age" aria-hidden="true">#</a> 5）max-age</h4><h3 id="_5-expires" tabindex="-1"><a class="header-anchor" href="#_5-expires" aria-hidden="true">#</a> 5.Expires</h3><ul><li>在 http1.0 版本中，是通过 Expires 响应头来指定过期时间点的</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Expires</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 23<span class="token punctuation">:</span>38<span class="token punctuation">:</span>38 GMT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>到了 http1.1 版本，已更改为通过 Cache-Control 的 max-age 来记录</li></ul><h3 id="_6-记录缓存时的有效期" tabindex="-1"><a class="header-anchor" href="#_6-记录缓存时的有效期" aria-hidden="true">#</a> 6.记录缓存时的有效期</h3><ul><li>浏览器会按照服务器响应头的要求，自动记录缓存到本地文件，并设置各种相关信息</li><li>在这些信息中， <mark>有效期</mark> 尤为关键，决定了这个缓存可以使用多久</li><li>浏览器会根据服务器不同的响应情况，设置不同的有效期</li><li>具体的有效期设置，按照下面的流程进行</li></ul><p><img src="/assets/Node56-fda93b9a.png" alt=""></p><ul><li>如：当 <code>max-age</code> 设置为 0 时，缓存立即过期</li><li>虽然立即过期，但缓存仍然被记录下来</li><li>后续的请求通过缓存指令发送到服务器，来确认资源是否被更改</li><li>因此，<code>Cache-Control: max-age=0</code> 类似于 <code>Cache-Control: no-cache</code></li></ul><h3 id="_7-pragma" tabindex="-1"><a class="header-anchor" href="#_7-pragma" aria-hidden="true">#</a> 7.Pragma</h3><ul><li>这是 http1.0 版本的消息头 <ul><li>当该消息头出现在请求中时，是向服务器表达：不要考虑任何缓存，返回一个正常的结果</li></ul></li><li>在 http1.1 版本中，可以在 <mark>请求头</mark> 中加入 <code>Cache-Control: no-cache</code> 实现同样的含义</li></ul><blockquote><p>在 Chrome 浏览器中调试时，如果勾选了 <code>Disable cache</code> ，则发送的请求中会附带该信息</p></blockquote><p><img src="/assets/网络相关面试题16-22e73bd3.png" alt=""></p><h3 id="_8-vary" tabindex="-1"><a class="header-anchor" href="#_8-vary" aria-hidden="true">#</a> 8.Vary</h3><ul><li>是否有缓存，不仅仅是判断请求方法和请求路径是否匹配，可能还要判断头部信息是否匹配</li><li>可以使用 <code>Vary</code> 字段来 <mark>指定要区分的消息头</mark></li><li>如：当使用 <code>GET /personal.html</code> 请求服务器时，请求头中 cookie 的值不一样，得到的页面也不一样 <ul><li>如果仅仅匹配请求方法和请求路径，一旦 cookie 变动，得到的仍然是之前的页面</li></ul></li></ul><p><img src="/assets/Node57-fddba6bb.png" alt=""></p><h3 id="_9-使用版本号或-hash" tabindex="-1"><a class="header-anchor" href="#_9-使用版本号或-hash" aria-hidden="true">#</a> 9.使用版本号或 hash</h3><ul><li>vue 或其他基于 webpack 搭建的工程打包的结果中很多文件名 <code>app.68297cd8.css</code><ul><li>文件的中间部分使用了 <code>hash</code> 值</li></ul></li><li>可以让客户端大胆的、长时间的缓存该文件，减轻服务器的压力 <ul><li>当文件改动后，文件 hash 值也会随之而变，如：变成了 <code>app.446fccb8.css</code></li><li>客户端要请求新的文件时，就会发现路径从 <code>/app.68297cd8.css</code> 变成了 <code>app.446fccb8.css</code></li><li>由于之前的缓存路径无法匹配到，因此就会发送新的请求来获取新资源了</li></ul></li><li>还没有构建工具出现时，人们使用的办法是 <mark>在资源路径后面加入版本号</mark> 来获取新版本的文件</li><li>如：页面中引入了一个 css 资源 <code>app.css</code></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app.css?v=1.0.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>缓存的路径是<code>/app.css?v=1.0.0</code></li><li>当服务器的版本发生变化时，可以给予新的版本号，让 html 中的路径发生变动</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app.css?v=1.0.1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>由于新的路径无法命中缓存，于是浏览器就会发送新的普通请求来获取这个资源</li></ul><h3 id="_10-总结" tabindex="-1"><a class="header-anchor" href="#_10-总结" aria-hidden="true">#</a> 10.总结</h3><h4 id="_1-服务器视角" tabindex="-1"><a class="header-anchor" href="#_1-服务器视角" aria-hidden="true">#</a> 1）服务器视角</h4><ul><li>服务器无法知道客户端到底有没有像浏览器那样缓存文件</li><li>只管根据请求的情况来决定如何响应</li></ul><p><img src="/assets/Node58-f5d16681.png" alt=""></p><ul><li>很多后端语言搭建的服务器都会自带自己的默认缓存规则，当然也支持不同程度的修改</li></ul><h4 id="_2-浏览器视角" tabindex="-1"><a class="header-anchor" href="#_2-浏览器视角" aria-hidden="true">#</a> 2）浏览器视角</h4><ul><li>浏览器在发出请求时会判断要不要使用缓存</li></ul><p><img src="/assets/Node59-d71f9e8d.png" alt=""></p><ul><li>当收到服务器响应时，会自动根据缓存指令进行处理</li></ul><h2 id="十六-tcp-协议" tabindex="-1"><a class="header-anchor" href="#十六-tcp-协议" aria-hidden="true">#</a> （十六）TCP 协议</h2><p><img src="/assets/网络相关面试题02-102c5c7b.png" alt=""></p><p><img src="/assets/网络相关面试题03-4e280e61.png" alt=""></p><h3 id="_1-tcp-收发数据流程" tabindex="-1"><a class="header-anchor" href="#_1-tcp-收发数据流程" aria-hidden="true">#</a> 1.TCP 收发数据流程</h3><p><img src="/assets/网络相关面试题17-4963d55c.png" alt=""></p><h3 id="_2-tcp-如何收发数据" tabindex="-1"><a class="header-anchor" href="#_2-tcp-如何收发数据" aria-hidden="true">#</a> 2.TCP 如何收发数据</h3><h4 id="_1-分段发送" tabindex="-1"><a class="header-anchor" href="#_1-分段发送" aria-hidden="true">#</a> 1）分段发送</h4><p><img src="/assets/网络相关面试题18-be1d3b4b.png" alt=""></p><h4 id="_2-可靠传输" tabindex="-1"><a class="header-anchor" href="#_2-可靠传输" aria-hidden="true">#</a> 2）可靠传输</h4><ul><li>在 TCP 协议中，任何时候、任何一方都可以主动发送数据给另一方</li><li>为了解决数据报丢失、数据报错乱等问题 TCP 协议要求：<mark>接收方收到数据报后，必须对数据报进行确认</mark></li></ul><p><img src="/assets/网络相关面试题19-3aebad0e.png" alt=""></p><blockquote><ul><li>seq：表示这次数据报的序号</li><li>ACK：表示这次数据报是一个确认数据报</li><li>ack：表示期望下一次接收的数据报序号</li></ul></blockquote><ul><li>发送方如果长时间没有收到确认数据报（ACK=1）</li><li>则会判定丢失或者是错误，然后重发</li></ul><h3 id="_3-连接的建立-三次握手" tabindex="-1"><a class="header-anchor" href="#_3-连接的建立-三次握手" aria-hidden="true">#</a> 3.连接的建立（三次握手）</h3><ul><li>TCP 协议要实现数据的收发，必须要先建立连接</li><li>连接的本质其实就是双方各自开辟的一块儿内存空间，空间中主要是数据缓冲区和一些变量</li></ul><p><img src="/assets/网络相关面试题20-e16d30e2.png" alt=""></p><ul><li><mark>连接建立的过程需要经过三次数据报传输，因此称为三次握手</mark></li></ul><blockquote><p>开始</p><p>客户端：我说话能听见吗？</p><p>服务器：能听见，我说话能听见吗？</p><p>客户端：能听见</p><p>结束</p></blockquote><p><img src="/assets/网络相关面试题21-4db1fd9e.png" alt=""></p><h3 id="_4-连接的销毁-四次挥手" tabindex="-1"><a class="header-anchor" href="#_4-连接的销毁-四次挥手" aria-hidden="true">#</a> 4.连接的销毁（四次挥手）</h3><blockquote><p>开始</p><p>客户端：我说完了，挂了？</p><p>服务器：我明白你说完了，但别忙挂，我还有话要说。</p><p>服务器继续说......</p><p>服务器：我也说完了，挂了？</p><p>客户端：好的！</p><p>结束</p></blockquote><p><img src="/assets/网络相关面试题22-563680b8.png" alt=""></p><h3 id="_5-http-和-tcp-的关系" tabindex="-1"><a class="header-anchor" href="#_5-http-和-tcp-的关系" aria-hidden="true">#</a> 5.HTTP 和 TCP 的关系</h3><p><img src="/assets/网络相关面试题23-0341942a.png" alt=""></p><ul><li>HTTP 协议是对内容格式的规定，<mark>使用</mark> 了 TCP 协议完成消息的可靠传输</li><li>在具体使用 TCP 协议时 <ul><li>客户端发消息给服务器叫做请求，服务器发消息给客户端叫做响应</li><li>使用 HTTP 协议的服务器不会主动发消息给客户端（尽管 TCP 可以），只对请求进行响应</li><li>每一个 HTTP 请求-响应，都要先建立 TCP 连接（三次握手），然后完成请求-响应后，再销毁连接（四次挥手） <ul><li>这就导致每次请求-响应都是相互独立的，无法保持状态</li></ul></li></ul></li></ul><h3 id="_6-面试题" tabindex="-1"><a class="header-anchor" href="#_6-面试题" aria-hidden="true">#</a> 6.面试题</h3><h4 id="_1-简述-tcp-连接的过程-淘系" tabindex="-1"><a class="header-anchor" href="#_1-简述-tcp-连接的过程-淘系" aria-hidden="true">#</a> 1）简述 TCP 连接的过程（淘系）</h4><blockquote><p>TCP 协议通过三次握手建立可靠的点对点连接，具体过程是：</p><ol><li>首先服务器进入监听状态，然后即可处理连接</li><li>第一次握手：建立连接时，客户端发送 syn 包到服务器，并进入 SYN_SENT 状态，等待服务器确认。在发送的包中还会包含一个初始序列号 seq。此次握手的含义是客户端希望与服务器建立连接</li><li>第二次握手：服务器收到 syn 包，然后回应给客户端一个 SYN+ACK 包，此时服务器进入 SYN_RCVD 状态。此次握手的含义是服务端回应客户端，表示已收到并同意客户端的连接请求</li><li>第三次握手：客户端收到服务器的 SYN 包后，向服务器再次发送 ACK 包，并进入 ESTAB_LISHED 状态</li><li>最后，服务端收到客户端的 ACK 包，于是也进入 ESTAB_LISHED 状态，至此，连接建立完成</li></ol></blockquote><h4 id="_2-谈谈你对-tcp-三次握手和四次挥手的理解" tabindex="-1"><a class="header-anchor" href="#_2-谈谈你对-tcp-三次握手和四次挥手的理解" aria-hidden="true">#</a> 2）谈谈你对 TCP 三次握手和四次挥手的理解</h4><blockquote><p>TCP 协议通过三次握手建立可靠的点对点连接，具体过程是：</p><ol><li>首先服务器进入监听状态，然后即可处理连接</li><li>第一次握手：建立连接时，客户端发送 syn 包到服务器，并进入 SYN_SENT 状态，等待服务器确认。在发送的包中还会包含一个初始序列号 seq。此次握手的含义是客户端希望与服务器建立连接</li><li>第二次握手：服务器收到 syn 包，然后回应给客户端一个 SYN+ACK 包，此时服务器进入 SYN_RCVD 状态。此次握手的含义是服务端回应客户端，表示已收到并同意客户端的连接请求</li><li>第三次握手：客户端收到服务器的 SYN 包后，向服务器再次发送 ACK 包，并进入 ESTAB_LISHED 状态</li><li>最后，服务端收到客户端的 ACK 包，于是也进入 ESTAB_LISHED 状态，至此，连接建立完成</li></ol><br><p>当需要关闭连接时，需要进行四次挥手才能关闭</p><ol><li>Client 向 Server 发送 FIN 包，表示 Client 主动要关闭连接，然后进入 FIN_WAIT_1 状态，等待 Server 返回 ACK 包。此后 Client 不能再向 Server 发送数据，但能读取数据</li><li>Server 收到 FIN 包后向 Client 发送 ACK 包，然后进入 CLOSE_WAIT 状态，此后 Server 不能再读取数据，但可以继续向 Client 发送数据</li><li>Client 收到 Server 返回的 ACK 包后进入 FIN_WAIT_2 状态，等待 Server 发送 FIN 包</li><li>Server 完成数据的发送后，将 FIN 包发送给 Client，然后进入 LAST_ACK 状态，等待 Client 返回 ACK 包，此后 Server 既不能读取数据，也不能发送数据</li><li>Client 收到 FIN 包后向 Server 发送 ACK 包，然后进入 TIME_WAIT 状态，接着等待足够长的时间（2MSL）以确保 Server 接收到 ACK 包，最后回到 CLOSED 状态，释放网络资源</li><li>Server 收到 Client 返回的 ACK 包后便回到 CLOSED 状态，释放网络资源</li></ol></blockquote><h2 id="十七-csrf-攻击" tabindex="-1"><a class="header-anchor" href="#十七-csrf-攻击" aria-hidden="true">#</a> （十七）CSRF 攻击</h2><ul><li>CSRF，Cross-Site Request Forgery，跨站请求伪造</li><li>指攻击者利用用户的身份信息，执行了用户非本意的操作</li></ul><p><img src="/assets/网络相关面试题24-5c238586.png" alt=""></p><h3 id="_1-防御方式" tabindex="-1"><a class="header-anchor" href="#_1-防御方式" aria-hidden="true">#</a> 1.防御方式</h3><table><thead><tr><th>防御手段</th><th>防御力</th><th>问题</th></tr></thead><tbody><tr><td>不使用 cookie</td><td>⭐️⭐️⭐️⭐️⭐️</td><td>兼容性略差<br>ssr 会遇到困难，但可解决</td></tr><tr><td>使用 SameSite</td><td>⭐️⭐️⭐️⭐️</td><td>兼容性差<br>容易挡住自己人</td></tr><tr><td>使用 csrf token</td><td>⭐️⭐️⭐️⭐️⭐️</td><td>获取到 token 后未进行操作仍然会被攻击</td></tr><tr><td>使用 referer 防护</td><td>⭐️⭐️</td><td>过去很常用，现在已经发现漏洞</td></tr></tbody></table><h3 id="_2-面试题" tabindex="-1"><a class="header-anchor" href="#_2-面试题" aria-hidden="true">#</a> 2.面试题</h3><h4 id="_1-介绍-csrf-攻击" tabindex="-1"><a class="header-anchor" href="#_1-介绍-csrf-攻击" aria-hidden="true">#</a> 1）介绍 csrf 攻击</h4><blockquote><p>CSRF 是跨站请求伪造，是一种挟制用户在当前已登录的 Web 应用上执行非本意的操作的攻击方法</p><p>首先引导用户访问一个危险网站，当用户访问网站后，网站会发送请求到被攻击的站点，这次请求会携带用户的 cookie 发送，因此就利用了用户的身份信息完成攻击</p><p>防御 CSRF 攻击有多种手段：</p><ol><li>不使用 cookie</li><li>为表单添加校验的 token 校验</li><li>cookie 中使用 sameSite 字段</li><li>服务器检查 referer 字段</li></ol></blockquote><h2 id="十八-xss-攻击" tabindex="-1"><a class="header-anchor" href="#十八-xss-攻击" aria-hidden="true">#</a> （十八）XSS 攻击</h2><ul><li>XSS，Cross Site Scripting，跨站脚本攻击</li><li>指攻击者利用站点的漏洞，提交表单时在表单内容中加入一些恶意脚本 <ul><li>当其他正常用户浏览页面，而页面中刚好出现攻击者的恶意脚本时，脚本被执行，从而使得页面遭到破坏，或者用户信息被窃取</li></ul></li></ul><p><img src="/assets/网络相关面试题25-76761b38.png" alt=""></p><h3 id="_1-防御方式-1" tabindex="-1"><a class="header-anchor" href="#_1-防御方式-1" aria-hidden="true">#</a> 1.防御方式</h3><ul><li>服务器端对用户提交的内容进行过滤或编码</li><li>过滤：去掉一些危险的标签，去掉一些危险的属性</li><li>编码：对危险的标签进行 HTML 实体编码</li></ul><h3 id="_2-面试题-1" tabindex="-1"><a class="header-anchor" href="#_2-面试题-1" aria-hidden="true">#</a> 2.面试题</h3><h4 id="_1-介绍-xss-攻击" tabindex="-1"><a class="header-anchor" href="#_1-介绍-xss-攻击" aria-hidden="true">#</a> 1）介绍 XSS 攻击</h4><blockquote><p>XSS 是指跨站脚本攻击。攻击者利用站点的漏洞，在表单提交时，在表单内容中加入一些恶意脚本，当其他正常用户浏览页面，而页面中刚好出现攻击者的恶意脚本时，脚本被执行，从而使得页面遭到破坏，或者用户信息被窃取</p><p>要防范 XSS 攻击，需要在服务器端过滤脚本代码，将一些危险的元素和属性去掉或对元素进行 HTML 实体编码</p></blockquote><h2 id="十九-网络性能优化" tabindex="-1"><a class="header-anchor" href="#十九-网络性能优化" aria-hidden="true">#</a> （十九）网络性能优化</h2><h3 id="_1-面试题-2" tabindex="-1"><a class="header-anchor" href="#_1-面试题-2" aria-hidden="true">#</a> 1.面试题</h3><h4 id="_1-列举优化网络性能方法" tabindex="-1"><a class="header-anchor" href="#_1-列举优化网络性能方法" aria-hidden="true">#</a> 1）列举优化网络性能方法</h4><blockquote><ol><li>优化打包体积</li></ol><p>利用一些工具压缩、混淆最终打包代码，减少包体积</p><ol start="2"><li>多目标打包</li></ol><p>利用一些打包插件，针对不同的浏览器打包出不同的兼容性版本，这样一来，每个版本中的兼容性代码就会大大减少，从而减少包体积</p><ol start="3"><li>压缩</li></ol><p>现代浏览器普遍支持压缩格式，因此服务端的各种文件可以压缩后再响应给客户端，只要解压时间小于优化的传输时间，压缩就是可行的</p><ol start="4"><li>CDN</li></ol><p>利用 CDN 可以大幅缩减静态资源的访问时间，特别是对于公共库的访问，可以使用知名的 CDN 资源，这样可以实现跨越站点的缓存</p><ol start="5"><li>缓存</li></ol><p>对于除 HTML 外的所有静态资源均可以开启协商缓存，利用构建工具打包产生的文件 hash 值来置换缓存</p><ol start="6"><li>HTTP2</li></ol><p>开启 HTTP2 后，利用其多路复用、头部压缩等特点，充分利用带宽传递大量的文件数据</p><ol start="7"><li>雪碧图</li></ol><p>对于不使用 HTTP2 的场景，可以将多个图片合并为雪碧图，以达到减少文件的目的</p><ol start="8"><li>defer、async</li></ol><p>通过 defer 和 async 属性，可以让页面尽早加载 js 文件</p><ol start="9"><li>prefetch、preload</li></ol><p>通过 prefetch 属性，可以让页面在空闲时预先下载其他页面可能要用到的资源</p><p>通过 preload 属性，可以让页面预先下载本页面可能要用到的资源</p><ol start="10"><li>多个静态资源域</li></ol><p>对于不使用 HTTP2 的场景，将相对独立的静态资源分到多个域中保存，可以让浏览器同时开启多个 TCP 连接，并行下载</p></blockquote><h2 id="二十-断点续传" tabindex="-1"><a class="header-anchor" href="#二十-断点续传" aria-hidden="true">#</a> （二十）断点续传</h2><h3 id="_1-实现下载时的断点续传" tabindex="-1"><a class="header-anchor" href="#_1-实现下载时的断点续传" aria-hidden="true">#</a> 1.实现下载时的断点续传</h3><h4 id="_1-服务器在响应头中加入下面的字段" tabindex="-1"><a class="header-anchor" href="#_1-服务器在响应头中加入下面的字段" aria-hidden="true">#</a> 1）服务器在响应头中加入下面的字段</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Accept-Ranges</span><span class="token punctuation">:</span> bytes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>是向客户端表明：这个文件可以支持传输部分数据，只需要传递需要的是哪一部分的数据即可，单位是字节</li><li>此时，某些支持断点续传的客户端，如：迅雷，就可以在请求时，告诉服务器需要的数据范围</li></ul><h4 id="_2-客户端在请求头中加入下面的字段" tabindex="-1"><a class="header-anchor" href="#_2-客户端在请求头中加入下面的字段" aria-hidden="true">#</a> 2）客户端在请求头中加入下面的字段</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">range</span><span class="token punctuation">:</span> bytes=0<span class="token punctuation">-</span><span class="token number">5000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>告诉服务器：请传递 0-5000 字节范围内的数据即可，无须传输全部数据</li><li>Web 无法保存临时文件到用户系统上，所以通常桌面应用才需要实现断点下载</li></ul><h4 id="_3-完整流程" tabindex="-1"><a class="header-anchor" href="#_3-完整流程" aria-hidden="true">#</a> 3）完整流程</h4><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><h3 id="_2-实现上传时的断点续传" tabindex="-1"><a class="header-anchor" href="#_2-实现上传时的断点续传" aria-hidden="true">#</a> 2.实现上传时的断点续传</h3><ul><li>主要思路就是把要上传的文件切分为多个小的数据块然后进行上传【分片上传】</li></ul><p><img src="/assets/网络相关面试题26-9284990c.png" alt=""></p><ul><li>虽然整体思路一致，但没有一个统一的、具体的标准，因此需要根据具体的业务场景制定自己的标准</li><li>由于标准的不同，分片上传需要自行编写代码实现</li><li>下面用一种极其简易的流程实现分片上传</li></ul><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><h3 id="_3-下载断点续传示例-服务器" tabindex="-1"><a class="header-anchor" href="#_3-下载断点续传示例-服务器" aria-hidden="true">#</a> 3.下载断点续传示例（服务器）</h3><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;cors&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> port <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>port<span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">,</span> express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">extended</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;/download/:filename&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> filename <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./res&quot;</span><span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> req<span class="token punctuation">.</span>params<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">&quot;/api/upload&quot;</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./uploader&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>port<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server listen on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-分片上传示例" tabindex="-1"><a class="header-anchor" href="#_4-分片上传示例" aria-hidden="true">#</a> 4.分片上传示例</h3><h4 id="_1-接口文档-2" tabindex="-1"><a class="header-anchor" href="#_1-接口文档-2" aria-hidden="true">#</a> 1）接口文档</h4><h5 id="a-文件信息协商" tabindex="-1"><a class="header-anchor" href="#a-文件信息协商" aria-hidden="true">#</a> a）文件信息协商</h5><ul><li>请求路径：/api/upload/handshake</li><li>请求方法：POST</li></ul><table><thead><tr><th>字段名</th><th>含义</th><th>是否必须</th></tr></thead><tbody><tr><td>fileId</td><td>文件的 MD5 编码</td><td>是</td></tr><tr><td>ext</td><td>文件的后缀，例如：.jpg</td><td>是</td></tr><tr><td>chunkIds</td><td>文件分片的编号数组，每个编号是一个 MD5 编码</td><td>是</td></tr></tbody></table><ul><li>可能的响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8000/upload/a32d18.jpg&quot;</span> <span class="token comment">// 服务器已有该文件，无需上传</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;md5-1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;md5-2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;md5-5&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 服务器还需要上传的分片</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>可能发生的失败响应</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
    <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;请携带文件编号&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="b-分片上传" tabindex="-1"><a class="header-anchor" href="#b-分片上传" aria-hidden="true">#</a> b）分片上传</h5><ul><li>请求路径：/api/upload</li><li>请求方法：POST</li></ul><table><thead><tr><th>字段名</th><th>含义</th><th>是否必须</th></tr></thead><tbody><tr><td>file</td><td>分片的二进制数据</td><td>是</td></tr><tr><td>chunkId</td><td>分片的 MD5 编码</td><td>是</td></tr><tr><td>fileId</td><td>分片所属文件的 MD5 编码</td><td>是</td></tr></tbody></table><ul><li>上传成功的响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;md5-2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;md5-5&quot;</span><span class="token punctuation">]</span> <span class="token comment">// 服务器还需要上传的分片</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>可能发生的失败响应</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;请携带文件编号&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-客户端" tabindex="-1"><a class="header-anchor" href="#_2-客户端" aria-hidden="true">#</a> 2）客户端</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>断点续传-示例<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./upload.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn choose<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>选择文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>progress<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inner<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>0%<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn control<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">data-status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>unchoose<span class="token punctuation">&quot;</span></span>
          <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span>
        <span class="token punctuation">&gt;</span></span>
          开始上传
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>文件访问地址：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>处理中, 请稍后...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/spark-md5/3.0.0/spark-md5.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./upload.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">*</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">word-break</span><span class="token punctuation">:</span> break-all<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
  <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> -5px solid #dcdfe6<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> 0.1s<span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 500<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 40px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn.choose</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #606266<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #dcdfe6<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn.choose:hover</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #409eff<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #c6e2ff<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #ecf5ff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn.control</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #409eff<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #409eff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.btn.control:hover</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #66b1ff<span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span> #66b1ff<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.progress</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #ccc<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.progress .wrapper</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.progress .wrapper::before</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #eee<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.inner</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 0%<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #7ebf50<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> 0.1s<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.inner span</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 0 3px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.inner span::before</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 5px solid #333<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-50%<span class="token punctuation">,</span> -100%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border-left-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token property">border-top-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token property">border-right-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.item</span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.modal</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #00000080<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> domControls <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 设置进度条区域
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>number<span class="token punctuation">}</span></span> <span class="token parameter">percent</span> 百分比 0-100
   */</span>
  <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token parameter">percent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> inner <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.progress&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;.inner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    inner<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span> <span class="token comment">// force reflow</span>
    inner<span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;width&quot;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>percent<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    inner<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>percent<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">%</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token doc-comment comment">/**
   * 设置上传按钮状态
   */</span>
  <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> btn <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> status <span class="token operator">=</span> btn<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">&quot;unchoose&quot;</span><span class="token operator">:</span> <span class="token comment">// 未选择文件</span>
        btn<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;choose&quot;</span><span class="token operator">:</span> <span class="token comment">// 刚刚选择了文件</span>
        btn<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btn<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;开始上传&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;uploading&quot;</span><span class="token operator">:</span> <span class="token comment">// 上传中</span>
        btn<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btn<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;暂停&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;pause&quot;</span><span class="token operator">:</span> <span class="token comment">// 暂停中</span>
        btn<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        btn<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;继续&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">&quot;finish&quot;</span><span class="token operator">:</span> <span class="token comment">// 已完成</span>
        btn<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token doc-comment comment">/**
   * 设置文件链接
   */</span>
  <span class="token function">setLink</span><span class="token punctuation">(</span><span class="token parameter">link</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#link&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span><span class="token string">&quot;href&quot;</span><span class="token punctuation">,</span> link<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * 文件分片
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>File<span class="token punctuation">}</span></span> <span class="token parameter">file</span>
 * <span class="token keyword">@returns</span>
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">splitFile</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 分片尺寸（1M）</span>
    <span class="token keyword">const</span> chunkSize <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">;</span>
    <span class="token comment">// 分片数量</span>
    <span class="token keyword">const</span> chunkCount <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>size <span class="token operator">/</span> chunkSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 当前chunk的下标</span>
    <span class="token keyword">let</span> chunkIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">// 使用ArrayBuffer完成文件MD5编码</span>
    <span class="token keyword">const</span> spark <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SparkMD5<span class="token punctuation">.</span>ArrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 文件读取器</span>
    <span class="token keyword">const</span> chunks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 分片信息数组</span>
    <span class="token comment">// 读取一个分片后的回调</span>
    fileReader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      spark<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 分片数据追加到MD5编码器中</span>
      <span class="token comment">// 当前分片单独的MD5</span>
      <span class="token keyword">const</span> chunkMD5 <span class="token operator">=</span> SparkMD5<span class="token punctuation">.</span>ArrayBuffer<span class="token punctuation">.</span><span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span> <span class="token operator">+</span> chunkIndex<span class="token punctuation">;</span>
      chunkIndex<span class="token operator">++</span><span class="token punctuation">;</span>
      chunks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> chunkMD5<span class="token punctuation">,</span>
        <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>chunkIndex <span class="token operator">&lt;</span> chunkCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">loadNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 继续读取下一个分片</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 读取完成</span>
        <span class="token keyword">const</span> fileId <span class="token operator">=</span> spark<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          fileId<span class="token punctuation">,</span>
          <span class="token literal-property property">ext</span><span class="token operator">:</span> <span class="token function">extname</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>
          chunks<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 读取下一个分片</span>
    <span class="token keyword">function</span> <span class="token function">loadNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> start <span class="token operator">=</span> chunkIndex <span class="token operator">*</span> chunkSize<span class="token punctuation">,</span>
        end <span class="token operator">=</span> start <span class="token operator">+</span> chunkSize <span class="token operator">&gt;=</span> file<span class="token punctuation">.</span>size <span class="token operator">?</span> file<span class="token punctuation">.</span>size <span class="token operator">:</span> start <span class="token operator">+</span> chunkSize<span class="token punctuation">;</span>

      fileReader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 获取文件的后缀名
     * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>string<span class="token punctuation">}</span></span> <span class="token parameter">filename</span> 文件完整名称
     */</span>
    <span class="token keyword">function</span> <span class="token function">extname</span><span class="token punctuation">(</span><span class="token parameter">filename</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> i <span class="token operator">=</span> filename<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> filename<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">loadNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 选择文件</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.choose&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> fileInfo<span class="token punctuation">;</span>
<span class="token keyword">let</span> needs<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> total <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token keyword">let</span> percent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>total <span class="token operator">-</span> needs<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">;</span>
  percent <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>percent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  domControls<span class="token punctuation">.</span><span class="token function">setProgress</span><span class="token punctuation">(</span>percent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.modal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fileInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">splitFile</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000/api/upload/handshake&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">fileId</span><span class="token operator">:</span> fileInfo<span class="token punctuation">.</span>fileId<span class="token punctuation">,</span>
      <span class="token literal-property property">ext</span><span class="token operator">:</span> fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">,</span>
      <span class="token literal-property property">chunkIds</span><span class="token operator">:</span> fileInfo<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> it<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.modal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    needs <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">&quot;choose&quot;</span><span class="token punctuation">;</span>
    domControls<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    needs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">&quot;finish&quot;</span><span class="token punctuation">;</span>
    domControls<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    domControls<span class="token punctuation">.</span><span class="token function">setLink</span><span class="token punctuation">(</span>resp<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">&quot;unchoose&quot;</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token string">&quot;finish&quot;</span><span class="token operator">:</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;uploading&quot;</span><span class="token operator">:</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">&quot;pause&quot;</span><span class="token punctuation">;</span>
      domControls<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">&quot;choose&quot;</span><span class="token operator">:</span>
    <span class="token keyword">case</span> <span class="token string">&quot;pause&quot;</span><span class="token operator">:</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">&quot;uploading&quot;</span><span class="token punctuation">;</span>
      <span class="token function">uploadPiece</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      domControls<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">uploadPiece</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>needs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>needs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 上传完成</span>
    <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token string">&quot;finish&quot;</span><span class="token punctuation">;</span>
    domControls<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    domControls<span class="token punctuation">.</span><span class="token function">setLink</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">http://localhost:8000/upload/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileInfo<span class="token punctuation">.</span>fileId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>fileInfo<span class="token punctuation">.</span>ext<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> status <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;.btn.control&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>status<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">!==</span> <span class="token string">&quot;uploading&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> nextChunkId <span class="token operator">=</span> needs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> file <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span>chunks<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> it<span class="token punctuation">.</span>id <span class="token operator">===</span> nextChunkId<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">;</span>
  <span class="token keyword">const</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
  formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;chunkId&quot;</span><span class="token punctuation">,</span> nextChunkId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;fileId&quot;</span><span class="token punctuation">,</span> fileInfo<span class="token punctuation">.</span>fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> resp <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:8000/api/upload&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> formData<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> resp<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  needs <span class="token operator">=</span> resp<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token function">setProgress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">uploadPiece</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-服务器" tabindex="-1"><a class="header-anchor" href="#_3-服务器" aria-hidden="true">#</a> 3）服务器</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chunkDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./chunktemp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fileInfoDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./filetemp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fileDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;./file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">exists</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">existsSync</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">statSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">createDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">_createDir</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">existsSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fs<span class="token punctuation">.</span><span class="token function">mkdirSync</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">_createDir</span><span class="token punctuation">(</span>chunkDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">_createDir</span><span class="token punctuation">(</span>fileInfoDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">_createDir</span><span class="token punctuation">(</span>fileDir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">createDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createFileChunk</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> buffer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> absPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>chunkDir<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">exists</span><span class="token punctuation">(</span>absPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>absPath<span class="token punctuation">,</span> buffer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 写入文件</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> id<span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> absPath<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">writeFileInfo</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> ext<span class="token punctuation">,</span> chunkIds<span class="token punctuation">,</span> needs <span class="token operator">=</span> chunkIds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> absPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>fileInfoDir<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token punctuation">{</span>
    id<span class="token punctuation">,</span>
    ext<span class="token punctuation">,</span>
    chunkIds<span class="token punctuation">,</span>
    needs<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>absPath<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> info<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> absPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>fileInfoDir<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">exists</span><span class="token punctuation">(</span>absPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>absPath<span class="token punctuation">,</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 添加chunk
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">addChunkToFileInfo</span><span class="token punctuation">(</span><span class="token parameter">chunkId<span class="token punctuation">,</span> fileId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> fileInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  fileInfo<span class="token punctuation">.</span>needs <span class="token operator">=</span> fileInfo<span class="token punctuation">.</span>needs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">it</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> it <span class="token operator">!==</span> chunkId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">writeFileInfo</span><span class="token punctuation">(</span>
    fileId<span class="token punctuation">,</span>
    fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">,</span>
    fileInfo<span class="token punctuation">.</span>chunkIds<span class="token punctuation">,</span>
    fileInfo<span class="token punctuation">.</span>needs
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">combine</span><span class="token punctuation">(</span><span class="token parameter">fileInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//1. 将该文件的所有分片依次合并</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>fileDir<span class="token punctuation">,</span> fileInfo<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token operator">+</span> fileInfo<span class="token punctuation">.</span>ext<span class="token punctuation">;</span>

  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">_move</span><span class="token punctuation">(</span><span class="token parameter">chunkId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> chunkPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>chunkDir<span class="token punctuation">,</span> chunkId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>chunkPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">appendFile</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> buffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">rm</span><span class="token punctuation">(</span>chunkPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> chunkId <span class="token keyword">of</span> fileInfo<span class="token punctuation">.</span>chunkIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> <span class="token function">_move</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//2. 删除文件信息</span>
  fs<span class="token punctuation">.</span>promises<span class="token punctuation">.</span><span class="token function">rm</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>fileInfoDir<span class="token punctuation">,</span> fileInfo<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * return:
 * null: 没有此文件，也没有文件信息
 * true: 有此文件，无须重新上传
 * object：没有此文件，但有该文件的信息
 */</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">getFileInfo</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> ext</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> absPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>fileDir<span class="token punctuation">,</span> id<span class="token punctuation">)</span> <span class="token operator">+</span> ext<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">await</span> <span class="token function">exists</span><span class="token punctuation">(</span>absPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">createFileInfo</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> ext<span class="token punctuation">,</span> chunkIds</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">writeFileInfo</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> ext<span class="token punctuation">,</span> chunkIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">handleChunk</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">chunkId<span class="token punctuation">,</span> fileId<span class="token punctuation">,</span> chunkBuffer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> fileInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getFileInfo</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;请先提交文件分片信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileInfo<span class="token punctuation">.</span>chunkIds<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;该文件没有此分片信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileInfo<span class="token punctuation">.</span>needs<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 此分片已经上传</span>
    <span class="token keyword">return</span> fileInfo<span class="token punctuation">.</span>needs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 处理分片</span>
  <span class="token keyword">await</span> <span class="token function">createFileChunk</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">,</span> chunkBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 添加分片信息到文件信息</span>
  fileInfo <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">addChunkToFileInfo</span><span class="token punctuation">(</span>chunkId<span class="token punctuation">,</span> fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 还有需要的分片吗？</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fileInfo<span class="token punctuation">.</span>needs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> fileInfo<span class="token punctuation">.</span>needs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 全部传完了</span>
    <span class="token keyword">await</span> <span class="token function">combine</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二十一-域名和-dns" tabindex="-1"><a class="header-anchor" href="#二十一-域名和-dns" aria-hidden="true">#</a> （二十一）域名和 DNS</h2><h3 id="_1-域名" tabindex="-1"><a class="header-anchor" href="#_1-域名" aria-hidden="true">#</a> 1.域名</h3><h4 id="_1-作用" tabindex="-1"><a class="header-anchor" href="#_1-作用" aria-hidden="true">#</a> 1）作用</h4><ul><li>帮助人类记忆网站地址，有了域名，就不用去记 IP 地址了</li></ul><h4 id="_2-类型" tabindex="-1"><a class="header-anchor" href="#_2-类型" aria-hidden="true">#</a> 2）类型</h4><ul><li>根域名：<code>.</code></li><li>顶级域名：<code>.cn</code>、<code>.com</code>、<code>.net</code>、<code>.us</code>、<code>.uk</code>、<code>.org</code>、...</li><li>二级域名：<code>.com</code>、<code>.gov</code>、<code>.org</code>、<code>.edu</code>、<code>自定义</code>、<code>baidu</code>、<code>jd</code>、<code>taobao</code>、...</li><li>三级域名：<code>自定义</code>、<code>www.baidu.com</code>、<code>www.jd.com</code>、<code>www.taobao.com</code></li><li>四级域名：<code>自定义</code>、<code>www.pku.edu.cn</code>、<code>mail.internal.jd.com</code></li></ul><blockquote><p>一般来说，购买二级域名后，三级、四级域名都是可以免费自定义的</p></blockquote><h3 id="_2-dns" tabindex="-1"><a class="header-anchor" href="#_2-dns" aria-hidden="true">#</a> 2.DNS</h3><ul><li>域名虽然有助于记忆，但是网络传输和域名没有关系</li></ul><h4 id="_1-网络传输必须依靠-ip" tabindex="-1"><a class="header-anchor" href="#_1-网络传输必须依靠-ip" aria-hidden="true">#</a> 1）网络传输必须依靠 IP</h4><ul><li>DNS 服务器能够将域名转换成 IP 地址</li><li>翻译成 IP 地址的过程称为 <mark>域名解析</mark></li></ul><p><img src="/assets/网络相关面试题27-ac42a5c5.png" alt=""></p><h4 id="_2-类型-1" tabindex="-1"><a class="header-anchor" href="#_2-类型-1" aria-hidden="true">#</a> 2）类型</h4><ul><li>全世界认可的 DNS 服务器一共有三种</li><li>外加一种局部使用的本地 DNS 服务器</li><li>一共四种</li></ul><p><img src="/assets/网络相关面试题28-e841420f.png" alt=""></p><ul><li>为了使得解析速度更快、查询的节点更少，上述每个节点都可能设置高速缓存来加速解析</li></ul><h3 id="_3-面试题-2" tabindex="-1"><a class="header-anchor" href="#_3-面试题-2" aria-hidden="true">#</a> 3.面试题</h3><h4 id="_1-请简述域名解析过程-百度" tabindex="-1"><a class="header-anchor" href="#_1-请简述域名解析过程-百度" aria-hidden="true">#</a> 1）请简述域名解析过程（百度）</h4><blockquote><ol><li>查找本机 hosts 文件中是否有解析记录，如果有，直接使用</li><li>查找本地域名服务器中是否有解析记录，如果有，直接使用</li><li>查询根域名服务器，得到顶级域名服务器 ip</li><li>查询顶级域名服务器中是否有解析记录，如果有，直接使用</li><li>根据顶级域名服务器反馈的 ip，查询权限域名服务器，如果有解析记录，直接使用</li><li>如果以上都找不到，域名解析失败</li></ol><p>本机和域名服务器一般都会有高速缓存，为了减少查询次数和时间</p></blockquote><h2 id="二十二-ssl、tls、https" tabindex="-1"><a class="header-anchor" href="#二十二-ssl、tls、https" aria-hidden="true">#</a> （二十二）SSL、TLS、HTTPS</h2><h3 id="_1-三者关系" tabindex="-1"><a class="header-anchor" href="#_1-三者关系" aria-hidden="true">#</a> 1.三者关系</h3><ul><li>SSL，Secure Sockets Layer，安全套接字协议</li><li>TLS，Transport Layer Security，传输层安全性协议</li><li>HTTPS，Hyper Text Transfer Protocol over SecureSocket Layer，建立在 SSL 协议之上的 HTTP 协议</li><li><mark>TLS 是 SSL 的升级版，两者几乎一样</mark></li></ul><p><img src="/assets/网络相关面试题29-ec3078b8.png" alt=""></p><h3 id="_2-面试题-2" tabindex="-1"><a class="header-anchor" href="#_2-面试题-2" aria-hidden="true">#</a> 2.面试题</h3><h4 id="_1-介绍下-https-中间人攻击" tabindex="-1"><a class="header-anchor" href="#_1-介绍下-https-中间人攻击" aria-hidden="true">#</a> 1）介绍下 HTTPS 中间人攻击</h4><blockquote><p>针对 HTTPS 攻击主要有 SSL 劫持攻击和 SSL 剥离攻击两种</p><ol><li>SSL 劫持攻击</li></ol><ul><li>指攻击者劫持了客户端和服务器之间的连接，将服务器的合法证书替换为伪造的证书，从而获取客户端和服务器之间传递的信息</li><li>这种方式一般容易被用户发现，浏览器会明确的提示证书错误，但某些用户安全意识不强，可能会点击继续浏览，从而达到攻击目的</li></ul><ol start="2"><li>SSL 剥离攻击</li></ol><ul><li>指攻击者劫持了客户端和服务器之间的连接，攻击者保持自己和服务器之间的 HTTPS 连接，但发送给客户端普通的 HTTP 连接</li><li>由于 HTTP 连接是明文传输的，即可获取客户端传输的所有明文数据</li></ul></blockquote><h4 id="_2-介绍-https-握手过程" tabindex="-1"><a class="header-anchor" href="#_2-介绍-https-握手过程" aria-hidden="true">#</a> 2）介绍 HTTPS 握手过程</h4><blockquote><ol><li>客户端请求服务器，并告诉服务器自身支持的加密算法以及密钥长度等信息</li><li>服务器响应公钥和服务器证书</li><li>客户端验证证书是否合法，然后生成一个会话密钥，并用服务器的公钥加密密钥，把加密的结果通过请求发送给服务器</li><li>服务器使用私钥解密被加密的会话密钥并保存起来，然后使用会话密钥加密消息响应给客户端，表示自己已经准备就绪</li><li>客户端使用会话密钥解密消息，知道了服务器已经准备就绪</li><li>后续客户端和服务器使用会话密钥加密信息传递消息</li></ol></blockquote><h4 id="_3-https-握手过程中-客户端如何验证证书的合法性" tabindex="-1"><a class="header-anchor" href="#_3-https-握手过程中-客户端如何验证证书的合法性" aria-hidden="true">#</a> 3）HTTPS 握手过程中，客户端如何验证证书的合法性</h4><blockquote><ol><li>校验证书的颁发机构是否受客户端信任</li><li>通过 CRL 或 OCSP 的方式校验证书是否被吊销</li><li>对比系统时间，校验证书是否在有效期内</li><li>通过校验对方是否存在证书的私钥，判断证书的网站域名是否与证书颁发的域名一致</li></ol></blockquote><h4 id="_4-阐述-https-验证身份-tsl-ssl-身份验证-的过程" tabindex="-1"><a class="header-anchor" href="#_4-阐述-https-验证身份-tsl-ssl-身份验证-的过程" aria-hidden="true">#</a> 4）阐述 HTTPS 验证身份（TSL/SSL 身份验证）的过程</h4><blockquote><ol><li>客户端请求服务器，并告诉服务器自身支持的加密算法以及密钥长度等信息</li><li>服务器响应公钥和服务器证书</li><li>客户端验证证书是否合法，然后生成一个会话密钥，并用服务器的公钥加密密钥，把加密的结果通过请求发送给服务器</li><li>服务器使用私钥解密被加密的会话密钥并保存起来，然后使用会话密钥加密消息响应给客户端，表示自己已经准备就绪</li><li>客户端使用会话密钥解密消息，知道了服务器已经准备就绪</li><li>后续客户端和服务器使用会话密钥加密信息传递消息</li></ol></blockquote><h4 id="_5-为什么需要-ca-机构对证书签名" tabindex="-1"><a class="header-anchor" href="#_5-为什么需要-ca-机构对证书签名" aria-hidden="true">#</a> 5）为什么需要 CA 机构对证书签名</h4><blockquote><p>主要是为了解决证书的可信问题</p><p>如果没有权威机构对证书进行签名，客户端就无法知晓证书是否是伪造的，从而增加了中间人攻击的风险，HTTPS 就变得毫无意义</p></blockquote><h4 id="_6-如何劫持-https-的请求-提供思路" tabindex="-1"><a class="header-anchor" href="#_6-如何劫持-https-的请求-提供思路" aria-hidden="true">#</a> 6）如何劫持 HTTPS 的请求，提供思路</h4><blockquote><p>HTTPS 有防篡改的特点，只要浏览器证书验证过程是正确的，很难在用户不察觉的情况下进行攻击</p><p>但若能够更改浏览器的证书验证过程，便有机会实现 HTTPS 中间人攻击</p><p>所以，要劫持 HTTPS，首先要伪造一个证书，并且要想办法让用户信任这个证书，可以有多种方式，比如病毒、恶意软件、诱导等</p><p>一旦证书被信任后，就可以利用普通中间人攻击的方式，使用伪造的证书进行攻击</p></blockquote><h2 id="二十三-http-各版本的差异" tabindex="-1"><a class="header-anchor" href="#二十三-http-各版本的差异" aria-hidden="true">#</a> （二十三）HTTP 各版本的差异</h2><h3 id="_1-http1-0" tabindex="-1"><a class="header-anchor" href="#_1-http1-0" aria-hidden="true">#</a> 1.HTTP1.0</h3><h4 id="_1-无法复用连接" tabindex="-1"><a class="header-anchor" href="#_1-无法复用连接" aria-hidden="true">#</a> 1）无法复用连接</h4><ul><li>HTTP1.0 为每个请求单独新开一个 TCP 连接</li></ul><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><ul><li>由于每个请求都是独立的连接，因此会带来下面的问题 <ul><li>连接的建立和销毁都会占用服务器和客户端的资源，造成内存资源的浪费</li><li>连接的建立和销毁都会消耗时间，造成响应时间的浪费</li><li>无法充分利用带宽，造成带宽资源的浪费</li></ul></li></ul><blockquote><p>TCP 协议的特点是 <mark>慢启动</mark></p><p>即：一开始传输的数据量少，一段时间之后达到传输的峰值</p><p>而上面这种做法，会导致大量的请求在 TCP 达到传输峰值前就被销毁了</p></blockquote><h4 id="_2-队头阻塞" tabindex="-1"><a class="header-anchor" href="#_2-队头阻塞" aria-hidden="true">#</a> 2）队头阻塞</h4><p><img src="/assets/网络相关面试题30-ca5e6a55.png" alt=""></p><h3 id="_2-http1-1" tabindex="-1"><a class="header-anchor" href="#_2-http1-1" aria-hidden="true">#</a> 2.HTTP1.1</h3><h4 id="_1-长连接" tabindex="-1"><a class="header-anchor" href="#_1-长连接" aria-hidden="true">#</a> 1）长连接</h4><ul><li>为了解决 HTTP1.0 的问题，<mark>HTTP1.1 默认开启长连接</mark></li><li>即：让同一个 TCP 连接服务于多个请求-响应</li></ul><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><ul><li>多次请求响应可以共享同一个 TCP 连接</li><li>不仅减少了 TCP 的握手和挥手时间</li><li>同时可以充分利用 TCP 慢启动的特点，有效的利用带宽</li></ul><blockquote><p>实际上，在 HTTP1.0 后期，虽然没有官方标准，但开发者们慢慢形成了一个共识：</p><p><mark>只要请求头中包含 Connection:keep-alive，就表示客户端希望开启长连接，希望服务器响应后不要关闭 TCP 连接，如果服务器认可这一行为，即可保持 TCP 连接</mark></p></blockquote><ul><li>当需要的时候，任何一方都可以关闭 TCP 连接</li><li>连接关闭的情况主要有三种 <ul><li>客户端在某一次请求中设置了 <code>Connection:close</code>，服务器收到此请求后，响应结束立即关闭 TCP</li><li>在没有请求时，客户端会不断对服务器进行心跳检测（一般每隔 1 秒），一旦心跳检测停止，服务器立即关闭 TCP</li><li>当客户端长时间没有新的请求到达服务器，服务器会主动关闭 TCP，运维人员可以设置该时间</li></ul></li><li>由于一个 TCP 连接可以承载多次请求响应，并在一段时间内不会断开，因此这种连接称为长连接</li></ul><h4 id="_2-管道化和队头阻塞" tabindex="-1"><a class="header-anchor" href="#_2-管道化和队头阻塞" aria-hidden="true">#</a> 2）管道化和队头阻塞</h4><ul><li>HTTP1.1 允许在响应到达之前发送下一个请求</li><li>可以大幅缩减带宽限制时间</li><li><mark>会存在队头阻塞的问题</mark></li></ul><p><img src="/assets/网络相关面试题31-92358c61.png" alt=""></p><ul><li>由于多个请求使用的是同一个 TCP 连接，<mark>服务器必须按照请求到达的顺序进行响应</mark></li><li>导致一些后发出的请求，无法在处理完成后响应，产生了等待的时间 <ul><li>这段时间的带宽可能是空闲的，造成了带宽的浪费</li></ul></li><li>队头阻塞虽然 <mark>发生在服务器</mark><ul><li>但问题的根源是 <mark>客户端无法知晓服务器的响应是针对哪个请求的</mark></li></ul></li><li>常常使用下面的手段进行优化 <ul><li>通过减少文件数量，从而减少队头阻塞的几率</li><li>通过开辟多个 TCP 连接，实现真正的、有缺陷的并行传输</li></ul></li></ul><blockquote><p>浏览器会根据情况，为打开的页面自动开启 TCP 连接，对于同一个域名的连接最多 6 个</p><p>如果要突破这个限制，就需要把资源放到不同的域中</p></blockquote><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>管道化并非一个成功的模型，它带来的队头阻塞造成非常多的问题，所以现代浏览器默认是关闭这种模式的</p></div><h3 id="_3-http2-0" tabindex="-1"><a class="header-anchor" href="#_3-http2-0" aria-hidden="true">#</a> 3.HTTP2.0</h3><p><img src="/assets/网络相关面试题32-f77cd2d1.png" alt=""></p><h4 id="_1-二进制分帧" tabindex="-1"><a class="header-anchor" href="#_1-二进制分帧" aria-hidden="true">#</a> 1）二进制分帧</h4><ul><li>HTTP2.0 可以允许以更小的单元传输数据 <ul><li>每个传输单元称为 <mark>帧</mark></li><li>每一个请求或响应的完整数据称为 <mark>流</mark></li></ul></li><li>每个流有自己的编号，每个帧会记录所属的流</li><li>如：服务器连续接到了客户端的两个请求，一个请求 JS、一个请求 CSS，两个文件如下：</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-css line-numbers-mode" data-ext="css"><pre class="language-css"><code><span class="token selector">.container</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token selector">.list</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>最终形成的帧可能如下</li></ul><p><img src="/assets/网络相关面试题33-8be52382.png" alt=""></p><ul><li>每个帧都带了一个头部，记录了流的 ID</li><li>就能够准确的知道这一帧数据是属于哪个流的</li></ul><p><img src="/assets/网络相关面试题34-74190c04.png" alt=""></p><ul><li>真正地解决了共享 TCP 连接时的队头阻塞问题，实现了真正的 <mark>多路复用</mark></li><li>由于传输时是以帧为单元传输的，无论是响应还是请求，都可以实现并发处理 <ul><li>即：<mark>不同的传输可以交替进行</mark></li></ul></li><li>由于进行了分帧，还可以 <mark>设置传输优先级</mark></li></ul><h4 id="_2-头部压缩" tabindex="-1"><a class="header-anchor" href="#_2-头部压缩" aria-hidden="true">#</a> 2）头部压缩</h4><ul><li>HTTP2.0 之前，所有的消息头都是以 <mark>字符</mark> 的形式完整传输的</li><li>实际上大部分头部信息都有很多的重复</li><li>为了解决这一问题，HTTP2.0 使用头部压缩来 <mark>减少消息头的体积</mark></li></ul><p><img src="/assets/网络相关面试题35-b52aa08a.png" alt=""></p><ul><li>对于两张表都没有的头部，则使用 Huffman 编码压缩后进行传输，同时添加到动态表中</li></ul><h4 id="_3-服务器推" tabindex="-1"><a class="header-anchor" href="#_3-服务器推" aria-hidden="true">#</a> 3）服务器推</h4><ul><li>HTTP2.0 允许在客户端没有主动请求的情况下，服务器预先把资源推送给客户端</li><li>当客户端后续需要请求该资源时，则自动从之前推送的资源中寻找</li></ul><h3 id="_4-面试题" tabindex="-1"><a class="header-anchor" href="#_4-面试题" aria-hidden="true">#</a> 4.面试题</h3><h4 id="_1-介绍下-http1-0、http1-1、http2-0-协议的区别" tabindex="-1"><a class="header-anchor" href="#_1-介绍下-http1-0、http1-1、http2-0-协议的区别" aria-hidden="true">#</a> 1）介绍下 <code>HTTP1.0</code>、<code>HTTP1.1</code>、<code>HTTP2.0</code> 协议的区别？</h4><blockquote><p>首先说 HTTP1.0</p><p>特点是每次请求和响应完毕后都会销毁 TCP 连接，同时规定前一个响应完成后才能发送下一个请求。这样做有两个问题：</p><ol><li>无法复用连接</li></ol><p>每次请求都要创建新的 TCP 连接，完成三次握手和四次挥手，网络利用率低</p><ol start="2"><li>队头阻塞</li></ol><p>如果前一个请求被某种原因阻塞了，会导致后续请求无法发送</p><br><p>然后是 HTTP1.1</p><p>HTTP1.1 是 HTTP1.0 的改进版，做出了以下改进：</p><ol><li>长连接</li></ol><p>HTTP1.1 允许在请求时增加请求头 <code>connection:keep-alive</code>，这样便允许后续的客户端请求在一段时间内复用之前的 TCP 连接</p><ol start="2"><li>管道化</li></ol><p>基于长连接的基础，管道化可以不等第一个请求响应继续发送后面的请求，但响应的顺序还是按照请求的顺序返回</p><ol start="3"><li>缓存处理</li></ol><p>新增响应头 cache-control，用于实现客户端缓存</p><ol start="4"><li>断点传输</li></ol><p>在上传/下载资源时，如果资源过大，将其分割为多个部分，分别上传/下载，如果遇到网络故障，可以从已经上传/下载好的地方继续请求，不用从头开始，提高效率</p><br><p>最后是 HTTP2.0</p><p>HTTP2.0 进一步优化了传输效率，主要有以下改进：</p><ol><li>二进制分帧</li></ol><p>将传输的消息分为更小的二进制帧，每帧有自己的标识序号，即便被随意打乱也能在另一端正确组装</p><ol start="2"><li>多路复用</li></ol><p>基于二进制分帧，在同一域名下所有访问都是从同一个 TCP 连接中走，并且不再有队头阻塞问题，也无须遵守响应顺序</p><ol start="3"><li>头部压缩</li></ol><p>HTTP2.0 通过字典的形式，将头部中的常见信息替换为更少的字符，极大的减少了头部的数据量，从而实现更小的传输量</p><ol start="4"><li>服务器推</li></ol><p>HTTP2.0 允许服务器直接推送消息给客户端，无须客户端明确的请求</p></blockquote><h4 id="_2-为什么-http1-1-不能实现多路复用-腾讯" tabindex="-1"><a class="header-anchor" href="#_2-为什么-http1-1-不能实现多路复用-腾讯" aria-hidden="true">#</a> 2）为什么 HTTP1.1 不能实现多路复用（腾讯）</h4><blockquote><ol><li>HTTP/1.1 的传输单元是整个响应文本，因此接收方必须按序接收完所有的内容后才能接收下一个传输单元，否则就会造成混乱</li><li>而 HTTP2.0 的传输单元更小，是一个二进制帧，而且每个帧有针对所属流的编号，这样即便是不同的流交替传输，也可以很容易区分出每个帧是属于哪个流的</li></ol></blockquote><h4 id="_3-简单讲解一下-http2-的多路复用-网易" tabindex="-1"><a class="header-anchor" href="#_3-简单讲解一下-http2-的多路复用-网易" aria-hidden="true">#</a> 3）简单讲解一下 HTTP2 的多路复用（网易）</h4><blockquote><p>在 HTTP/2 中，有两个非常重要的概念，分别是帧（frame）和流（stream）</p><ol><li>帧代表着最小的数据单位，每个帧会标识出该帧属于哪个流，流也就是多个帧组成的数据流</li><li>多路复用，就是在一个 TCP 连接中可以存在多条流，也就是可以发送多个请求，对端可以通过帧中的标识知道属于哪个请求</li><li>通过这个技术，可以避免 HTTP 旧版本中的队头阻塞问题，极大的提高传输性能</li></ol></blockquote><h4 id="_4-http1-1-是如何复用-tcp-连接的-网易" tabindex="-1"><a class="header-anchor" href="#_4-http1-1-是如何复用-tcp-连接的-网易" aria-hidden="true">#</a> 4）HTTP1.1 是如何复用 TCP 连接的？（网易）</h4><blockquote><p>客户端请求服务器时，通过请求行告诉服务器使用的协议是 HTTP1.1，同时在请求头中附带<code>connection:keep-alive</code>（为了保持兼容），告诉服务器这是一个长连接，后续请求可以重复使用这一次的 TCP 连接</p><br><p>这样做的好处是减少了三次握手和四次挥手的次数，一定程度上提升了网络利用率。但由于 HTTP1.1 不支持多路复用，响应顺序必须按照请求顺序抵达客户端，不能真正实现并行传输，因此在 HTTP2.0 出现之前，实际项目中往往把静态资源，比如图片，分发到不同域名下的资源服务器，以便实现真正的并行传输</p></blockquote><h4 id="_5-http1-0、http2-0、http3-0-之间的区别" tabindex="-1"><a class="header-anchor" href="#_5-http1-0、http2-0、http3-0-之间的区别" aria-hidden="true">#</a> 5）HTTP1.0、HTTP2.0、HTTP3.0 之间的区别</h4><blockquote><p>HTTP1.0</p><p>每次请求和响应完毕后都会销毁 TCP 连接，同时规定前一个响应完成后才能发送下一个请求。这样做有两个问题：</p><ol><li>无法复用连接</li></ol><p>每次请求都要创建新的 TCP 连接，完成三次握手和四次挥手，网络利用率低</p><ol start="2"><li>队头阻塞</li></ol><p>如果前一个请求被某种原因阻塞了，会导致后续请求无法发送</p><br><p>HTTP2.0</p><p>HTTP2.0 优化了传输效率，主要有以下改进：</p><ol><li>二进制分帧</li></ol><p>将传输的消息分为更小的二进制帧，每帧有自己的标识序号，即便被随意打乱也能在另一端正确组装</p><ol start="2"><li>多路复用</li></ol><p>基于二进制分帧，在同一域名下所有访问都是从同一个 TCP 连接中走，并且不再有队头阻塞问题，也无须遵守响应顺序</p><ol start="3"><li>头部压缩</li></ol><p>HTTP2.0 通过字典的形式，将头部中的常见信息替换为更少的字符，极大的减少了头部的数据量，从而实现更小的传输量</p><ol start="4"><li>服务器推</li></ol><p>HTTP2.0 允许服务器直接推送消息给客户端，无须客户端明确的请求</p><br><p>HTTP3.0</p><ol><li>HTTP3.0 目前还在草案阶段，完全抛弃了 TCP 协议，转而使用 UDP 协议，是为了进一步提升性能</li><li>虽然 HTTP2.0 进行了大量的优化，但无法摆脱 TCP 协议本身的问题，比如建立连接时间长、对头阻塞问题等等</li><li>为了保证传输的可靠性，HTTP3.0 使用了 QUIC 协议</li></ol></blockquote><h2 id="二十四-websocket" tabindex="-1"><a class="header-anchor" href="#二十四-websocket" aria-hidden="true">#</a> （二十四）WebSocket</h2><blockquote><p><a href="https://datatracker.ietf.org/doc/html/rfc6455" target="_blank" rel="noopener noreferrer">WebSocket 协议（RFC6455）原文地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_1-实时场景的旧处理方案" tabindex="-1"><a class="header-anchor" href="#_1-实时场景的旧处理方案" aria-hidden="true">#</a> 1.实时场景的旧处理方案</h3><ul><li>网页中的以下场景 <ul><li>股票 K 线图</li><li>聊天</li><li>警报、重要通知</li><li>余座</li><li>抢购页面的库存</li><li>......</li></ul></li><li>有一个共同特点 —— <mark>实时性</mark></li><li>这种对实时性有要求的页面，会带来一些问题</li><li>如：下面的聊天场景</li></ul><p><img src="/assets/网络相关面试题36-695d888b.png" alt=""></p><ul><li>由于 HTTP 协议是请求-响应模式，请求必须在前，响应必须在后</li><li>导致服务器无法主动地把消息告诉客户端</li></ul><h3 id="_2-短轮询-short-polling" tabindex="-1"><a class="header-anchor" href="#_2-短轮询-short-polling" aria-hidden="true">#</a> 2.短轮询 Short Polling</h3><blockquote><p>短轮询是一种话痨式的方式</p></blockquote><ul><li>客户端每隔一小段时间就向服务器请求一次，询问有没有新消息</li></ul><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><h4 id="_1-实现" tabindex="-1"><a class="header-anchor" href="#_1-实现" aria-hidden="true">#</a> 1）实现</h4><ul><li>客户端只需要设置一个计时器不断发送请求即可</li></ul><h4 id="_2-缺陷" tabindex="-1"><a class="header-anchor" href="#_2-缺陷" aria-hidden="true">#</a> 2）缺陷</h4><ul><li>会产生大量无意义的请求</li><li>会频繁打开关闭连接</li><li>实时性并不高</li></ul><h3 id="_3-长轮询-long-polling" tabindex="-1"><a class="header-anchor" href="#_3-长轮询-long-polling" aria-hidden="true">#</a> 3.长轮询 Long Polling</h3><!--[--><div class="mermaid-actions"><button class="preview-button" title="preview"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1316 1024" fill="currentColor"><path d="M658.286 0C415.89 0 0 297.106 0 512c0 214.82 415.89 512 658.286 512 242.322 0 658.285-294.839 658.285-512S900.608 0 658.286 0zm0 877.714c-161.573 0-512-221.769-512-365.714 0-144.018 350.427-365.714 512-365.714 161.572 0 512 217.16 512 365.714s-350.428 365.714-512 365.714z"/><path d="M658.286 292.571a219.429 219.429 0 1 0 0 438.858 219.429 219.429 0 0 0 0-438.858zm0 292.572a73.143 73.143 0 1 1 0-146.286 73.143 73.143 0 0 1 0 146.286z"/></svg></button><button class="download-button" title="download"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor"><path d="M828.976 894.125H190.189c-70.55 0-127.754-57.185-127.754-127.753V606.674c0-17.634 14.31-31.933 31.933-31.933h63.889c17.634 0 31.932 14.299 31.932 31.933v95.822c0 35.282 28.596 63.877 63.877 63.877h511.033c35.281 0 63.877-28.595 63.877-63.877v-95.822c0-17.634 14.298-31.933 31.943-31.933h63.878c17.635 0 31.933 14.299 31.933 31.933v159.7c0 70.566-57.191 127.751-127.754 127.751zM249.939 267.51c12.921-12.92 33.885-12.92 46.807 0l148.97 148.972V94.893c0-17.634 14.302-31.947 31.934-31.947h63.876c17.638 0 31.946 14.313 31.946 31.947v321.589l148.97-148.972c12.922-12.92 33.876-12.92 46.797 0l46.814 46.818c12.922 12.922 12.922 33.874 0 46.807L552.261 624.93c-1.14 1.138-21.664 13.684-42.315 13.693-20.877.01-41.88-12.542-43.021-13.693L203.122 361.135c-12.923-12.934-12.923-33.885 0-46.807l46.817-46.818z"/></svg></button></div><div class="mermaid-wrapper"><div class="loading-icon-wrapper mermaid-loading" style="display:flex;align-items:center;justify-content:center;height:96px;"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--]--><ul><li>有效的解决了话痨问题，让每一次请求和响应都是有意义的</li></ul><h4 id="_1-缺陷" tabindex="-1"><a class="header-anchor" href="#_1-缺陷" aria-hidden="true">#</a> 1）缺陷</h4><ul><li>客户端长时间收不到响应会导致超时，从而主动断开和服务器的连接</li></ul><blockquote><p>这种情况是可以处理的：当 ajax 请求因为超时而结束时，立即重新发送请求到服务器</p><p>虽然这种做法会让之前的请求变得无意义，但毕竟比短轮询好多了</p></blockquote><ul><li>由于客户端可能过早地请求了服务器，服务器不得不挂起这个请求直到新消息的出现 ·- 这会让服务器长时间的占用资源却没什么实际的事情可做</li></ul><h3 id="_4-websocket" tabindex="-1"><a class="header-anchor" href="#_4-websocket" aria-hidden="true">#</a> 4.WebSocket</h3><ul><li>随着 HTML5 出现的 WebSocket，从 <mark>协议</mark> 上赋予了服务器主动推送消息的能力</li></ul><p><img src="/assets/网络相关面试题37-7064a928.png" alt=""></p><ul><li>WebSocket 也是建立在 TCP 协议之上的，利用的是 TCP <mark>全双工通信</mark> 的能力</li><li>使用 WebSocket，会经历两个阶段：握手阶段、通信阶段</li></ul><h4 id="_1-缺陷-1" tabindex="-1"><a class="header-anchor" href="#_1-缺陷-1" aria-hidden="true">#</a> 1）缺陷</h4><ul><li>兼容性 <ul><li>WebSocket 是 HTML5 新增的内容，因此古董版本的浏览器并不支持</li></ul></li><li>维持 TCP 连接需要耗费资源 <ul><li>对于那些消息量少的场景，维持 TCP 连接确实会造成资源的浪费</li></ul></li></ul><blockquote><p>为了充分利用 TCP 连接的资源，在使用了 WebSocket 的页面，可以放弃 ajax，都用 WebSocket 进行通信</p><p>当然这会带来程序设计上的一些问题，需要权衡</p></blockquote><h4 id="_2-握手协议" tabindex="-1"><a class="header-anchor" href="#_2-握手协议" aria-hidden="true">#</a> 2）握手协议</h4><blockquote><p>WebSocket 协议是一个高扩展性的协议，详细内容会比较复杂，这里仅讲解面试中会问到的握手协议</p></blockquote><ul><li>当客户端需要和服务器使用 WebSocket 进行通信时，首先会使用 <mark>HTTP 协议</mark> 完成一次特殊的请求-响应 <ul><li>这一次请求-响应就是 WebSocket 握手</li></ul></li><li>在握手阶段，首先由客户端向服务器发送一个请求</li><li>请求地址格式</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># 使用HTTP</span>
ws://mysite.com/path
<span class="token comment"># 使用HTTPS</span>
wss://mysite.com/path
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>请求头</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Connection</span><span class="token punctuation">:</span> Upgrade <span class="token comment"># 嘿，后续咱们别用HTTP了，升级吧</span>
<span class="token key atrule">Upgrade</span><span class="token punctuation">:</span> websocket <span class="token comment"># 我们把后续的协议升级为websocket</span>
<span class="token key atrule">Sec-WebSocket-Version</span><span class="token punctuation">:</span> <span class="token number">13</span> <span class="token comment"># websocket协议版本就用13好吗？</span>
<span class="token key atrule">Sec-WebSocket-Key</span><span class="token punctuation">:</span> YWJzZmFkZmFzZmRhYw== <span class="token comment"># 暗号：天王盖地虎</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>服务器如果同意，就应该响应下面的消息</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 101 Switching Protocols <span class="token comment"># 换，马上换协议</span>
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> Upgrade <span class="token comment"># 协议升级了</span>
<span class="token key atrule">Upgrade</span><span class="token punctuation">:</span> websocket <span class="token comment"># 升级到websocket</span>
<span class="token key atrule">Sec-WebSocket-Accept</span><span class="token punctuation">:</span> ZzIzMzQ1Z2V3NDUyMzIzNGVy <span class="token comment"># 暗号：小鸡炖蘑菇</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><mark>握手完成，后续消息收发不再使用 HTTP，任何一方都可以主动发消息给对方</mark></li></ul><h3 id="_5-面试题-3" tabindex="-1"><a class="header-anchor" href="#_5-面试题-3" aria-hidden="true">#</a> 5.面试题</h3><h4 id="_1-websocket-协议是什么-能简述一下吗" tabindex="-1"><a class="header-anchor" href="#_1-websocket-协议是什么-能简述一下吗" aria-hidden="true">#</a> 1）WebSocket 协议是什么，能简述一下吗？</h4><blockquote><p>WebSocket 协议 HTML5 带来的新协议，相对于 HTTP，它是一个持久连接的协议，利用 HTTP 协议完成握手，然后通过 TCP 连接通道发送消息，使用 WebSocket 协议可以实现服务器主动推送消息</p><ol><li>首先，客户端若要发起 WebSocket 连接，首先必须向服务器发送 HTTP 请求以完成握手，请求行中的 path 需要使用 <code>ws:</code> 开头的地址，请求头中要分别加入 <code>upgrade、connection、Sec-WebSocket-Key、Sec-WebSocket-Version</code> 标记</li><li>然后，服务器收到请求后，发现这是一个 WebSocket 协议的握手请求，于是响应行中包含 <code>Switching Protocols</code> ，同时响应头中包含 <code>upgrade、connection、Sec-WebSocket-Accept</code> 标记</li><li>当客户端收到响应后即可完成握手，随后使用建立的 TCP 连接直接发送和接收消息</li></ol></blockquote><h4 id="_2-websocket-与传统的-http-相比有什么优势" tabindex="-1"><a class="header-anchor" href="#_2-websocket-与传统的-http-相比有什么优势" aria-hidden="true">#</a> 2）WebSocket 与传统的 HTTP 相比有什么优势</h4><blockquote><p>当页面中需要观察实时数据的变化（如：聊天、k 线图）时，过去我们往往使用两种方式完成</p><ol><li>短轮询，即客户端每隔一段时间就向服务器发送消息，询问有没有新的数据</li><li>长轮询，发起一次请求询问服务器，服务器可以将该请求挂起，等到有新消息时再进行响应。响应后，客户端立即又发起一次请求，重复整个流程</li></ol><p>无论是哪一种方式，都暴露了 HTTP 协议的弱点，即响应必须在请求之后发生，服务器是被动的，无法主动推送消息，而让客户端不断的发起请求又白白的占用了资源</p><p>WebSocket 的出现就是为了解决这个问题，它利用 HTTP 协议完成握手之后，就可以与服务器建立持久的连接，服务器可以在任何需要的时候，主动推送消息给客户端，这样占用的资源最少，同时实时性也最高</p></blockquote><h4 id="_3-前端如何实现即时通讯" tabindex="-1"><a class="header-anchor" href="#_3-前端如何实现即时通讯" aria-hidden="true">#</a> 3）前端如何实现即时通讯？</h4><blockquote><ol><li>短轮询，即客户端每隔一段时间就向服务器发送消息，询问有没有新的数据</li><li>长轮询，发起一次请求询问服务器，服务器可以将该请求挂起，等到有新消息时再进行响应。响应后，客户端立即又发起一次请求，重复整个流程</li><li>Websocket，握手完毕后会建立持久性的连接通道，随后服务器可以在任何时候推送新消息给客户端</li></ol></blockquote><h2 id="二十五-websocket-实战" tabindex="-1"><a class="header-anchor" href="#二十五-websocket-实战" aria-hidden="true">#</a> （二十五）WebSocket 实战</h2><h3 id="_1-websocket-api" tabindex="-1"><a class="header-anchor" href="#_1-websocket-api" aria-hidden="true">#</a> 1.WebSocket API</h3><blockquote><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket/WebSocket" target="_blank" rel="noopener noreferrer">MDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">&quot;地址&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建websocket连接，浏览器自动握手</span>

<span class="token comment">// 事件：握手完成后触发</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onopen</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接到了服务器&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 事件：收到服务器消息后触发</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// e.data：服务器发送的消息</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 事件：连接关闭后触发</span>
ws<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;连接关闭了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 发送消息到服务器</span>
ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;消息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 连接状态：0-正在连接中  1-已连接  2-正在关闭中  3-已关闭</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span>readyState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-socket-io" tabindex="-1"><a class="header-anchor" href="#_2-socket-io" aria-hidden="true">#</a> 2.Socket.io</h3><blockquote><p><a href="https://socket.io/" target="_blank" rel="noopener noreferrer">官网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>原生的接口虽然简单，但是在实际应用中会造成很多麻烦</li><li>如：一个页面，既有 K 线，也有实时聊天</li></ul><p><img src="/assets/网络相关面试题38-f5018dbb.png" alt=""></p><blockquote><p>上图是一段时间中服务器给客户端推送的数据，无法区分这些数据的含义</p><p>这就是问题所在：连接双方可以在任何时候发送任何类型的数据，另一方必须要清楚这个数据的含义是什么</p><p>虽然可以自行解决这些问题，但毕竟麻烦</p></blockquote><ul><li>Socket.io 解决了这些问题，把消息放到不同的 <mark>事件</mark> 中</li><li>通过监听和触发事件来实现对不同消息的处理</li></ul><p><img src="/assets/网络相关面试题39-b41e9023.png" alt=""></p><ul><li>客户端和服务器双方事先约定好不同的事件，事件由谁监听，由谁触发，就可以把各种消息进行有序管理了</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>Socket.io 为了实现这些要求，对消息格式进行了特殊处理，因此如果一方要使用 Socket.io，双方必须都使用</p></div><h4 id="_1-在客户端使用-socket-io" tabindex="-1"><a class="header-anchor" href="#_1-在客户端使用-socket-io" aria-hidden="true">#</a> 1）在客户端使用 Socket.io</h4><blockquote><p><a href="https://socket.io/docs/v4/client-installation/" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>在约定事件名时要注意，Socket.io 有一些预定义的事件名 <ul><li>如：message、connect 等</li></ul></li><li>为了避免冲突，建议自定义事件名使用一个特殊的前缀 <ul><li>如：<code>$</code></li></ul></li><li>Socket.io 对低版本浏览器还进行了兼容处理 <ul><li>如果浏览器不支持 WebSocket，Socket.io 将使用长轮询（long polling）处理</li></ul></li><li>Socket.io 还支持使用 <mark>命名空间</mark> 来进一步隔离业务</li></ul><h3 id="_3-接口文档" tabindex="-1"><a class="header-anchor" href="#_3-接口文档" aria-hidden="true">#</a> 3.接口文档</h3><h4 id="_1-测试接口" tabindex="-1"><a class="header-anchor" href="#_1-测试接口" aria-hidden="true">#</a> 1）测试接口</h4><ul><li>连接地址：ws://localhost:9527</li><li>服务器消息 <ul><li>服务器每隔 3 秒钟会发送一个消息给客户端</li><li>每次收到客户端的消息后，服务器会回应一个消息</li></ul></li></ul><h4 id="_2-聊天室接口" tabindex="-1"><a class="header-anchor" href="#_2-聊天室接口" aria-hidden="true">#</a> 2）聊天室接口</h4><ul><li>连接地址：ws://localhost:9528</li></ul><h5 id="a-服务器触发的事件-客户端需要监听的事件" tabindex="-1"><a class="header-anchor" href="#a-服务器触发的事件-客户端需要监听的事件" aria-hidden="true">#</a> a）服务器触发的事件/客户端需要监听的事件</h5><table><thead><tr><th>事件名</th><th>触发时机</th><th>传递的消息</th><th>传递消息示例</th></tr></thead><tbody><tr><td><code>$updateUser</code></td><td>有新用户进入<br>有老用户退出<br>自己进入</td><td>当前聊天室的用户数组</td><td>[&#39;张三&#39;, &#39;李四&#39;]</td></tr><tr><td><code>$name</code></td><td>自己进入</td><td>分配的用户名称</td><td>&quot;张三&quot;</td></tr><tr><td><code>$history</code></td><td>自己进入</td><td>历史聊天记录</td><td>[{<br> name:&quot;张三&quot;,<br> content:&quot;你好&quot;,<br> date: 1635484786373<br>}]</td></tr><tr><td><code>$message</code></td><td>其他人发送消息</td><td>消息对象</td><td>{<br> name:&quot;张三&quot;,<br> content:&quot;你好&quot;,<br> date: 1635484786373<br>}</td></tr></tbody></table><h5 id="b-客户端触发的事件-服务器需要监听的事件" tabindex="-1"><a class="header-anchor" href="#b-客户端触发的事件-服务器需要监听的事件" aria-hidden="true">#</a> b）客户端触发的事件/服务器需要监听的事件</h5><table><thead><tr><th>事件名</th><th>触发时机</th><th>传递的消息</th><th>传递消息示例</th></tr></thead><tbody><tr><td><code>$message</code></td><td>发送聊天消息</td><td>消息字符串</td><td>&quot;你好！&quot;</td></tr></tbody></table><h4 id="_3-客户端-app-vue" tabindex="-1"><a class="header-anchor" href="#_3-客户端-app-vue" aria-hidden="true">#</a> 3）客户端 App.vue</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChatWindow</span>
      <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!isLoading<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:me</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>me<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:history</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>history<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:users</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@chat</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleChat<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> ChatWindow <span class="token keyword">from</span> <span class="token string">&quot;./components/ChatWindow.vue&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> io <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;socket.io-client&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      ChatWindow<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">me</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">isLoading</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">socket</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">&quot;ws://localhost:9528&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connect&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>isLoading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;$updateUser&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">users</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>users <span class="token operator">=</span> users<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;$name&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>me <span class="token operator">=</span> name<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;$history&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">history</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history <span class="token operator">=</span> history<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;$message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">disconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">handleChat</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$message&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.app</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #1e1e1e<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">*</span> <span class="token punctuation">{</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>
    <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-客户端-chatwindow-vue" tabindex="-1"><a class="header-anchor" href="#_4-客户端-chatwindow-vue" aria-hidden="true">#</a> 4）客户端 ChatWindow.vue</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>users<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>聊天室成员<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>u in users<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>u<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ u }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content-area<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span>
          <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ mine: me === h.name }<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(h, i) in history<span class="token punctuation">&quot;</span></span>
          <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span>
        <span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ h.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ h.content }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ formatDate(h.date) }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>value<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@keydown.enter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleEnter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> moment <span class="token keyword">from</span> <span class="token string">&quot;moment&quot;</span><span class="token punctuation">;</span>
  moment<span class="token punctuation">.</span><span class="token function">locale</span><span class="token punctuation">(</span><span class="token string">&quot;zh-cn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span>
        <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> Array<span class="token punctuation">,</span>
        <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">me</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
        <span class="token literal-property property">required</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>
        <span class="token string">&quot;history&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> div <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>info<span class="token punctuation">;</span>
          div<span class="token punctuation">.</span><span class="token function">scroll</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> div<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">immediate</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        date <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> date<span class="token punctuation">.</span><span class="token function">fromNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">handleEnter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">&quot;chat&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>me<span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> v<span class="token punctuation">,</span> <span class="token literal-property property">date</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">.container</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 665px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 522px<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">box-shadow</span><span class="token punctuation">:</span> -2px 2px 2px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.users</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span>
    <span class="token property">border-right</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.users p</span> <span class="token punctuation">{</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.users li</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 10px<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #f1f1f1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.users li:nth-child(2n)</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">.main</span> <span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1 1 auto<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #f1f1f1<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.content-area</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token property">border-bottom</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
    <span class="token property">line-height</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">;</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 auto<span class="token punctuation">;</span>
    <span class="token property">scroll-behavior</span><span class="token punctuation">:</span> smooth<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.item</span> <span class="token punctuation">{</span>
    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
    <span class="token property">max-width</span><span class="token punctuation">:</span> 70%<span class="token punctuation">;</span>
    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.name</span> <span class="token punctuation">{</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #666<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.date</span> <span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #bbb<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.content</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 5px 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.mine.item</span> <span class="token punctuation">{</span>
    <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.mine .content</span> <span class="token punctuation">{</span>
    <span class="token property">background</span><span class="token punctuation">:</span> #a9e97a<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.mine .name</span> <span class="token punctuation">{</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.mine .date</span> <span class="token punctuation">{</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.form</span> <span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1 1 auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.form textarea</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">resize</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-服务器-ws-js" tabindex="-1"><a class="header-anchor" href="#_5-服务器-ws-js" aria-hidden="true">#</a> 5）服务器 ws.js</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> WebSocketServer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ws&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createServer</span><span class="token punctuation">(</span><span class="token parameter">port</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> wss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocketServer</span><span class="token punctuation">(</span>
      <span class="token punctuation">{</span>
        port<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>wss<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">port</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wss <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">createServer</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">支持原生 WebSocket 的服务器已启动，端口号：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wss<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// console.log(`有一个小伙伴已经和我完成了握手，可以随意的发消息了！`);</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log(`收到小伙伴的消息：${message}`);</span>
      socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;你说的真好！很棒棒哦！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    count<span class="token operator">++</span><span class="token punctuation">;</span>
    wss<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ws</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">来自服务器的消息：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  wss<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;close&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">init</span><span class="token punctuation">(</span><span class="token number">9527</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-服务器-chat-js" tabindex="-1"><a class="header-anchor" href="#_6-服务器-chat-js" aria-hidden="true">#</a> 6）服务器 chat.js</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> Server <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;socket.io&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 聊天历史记录 {name:string, content:string, date: number}</span>
<span class="token keyword">let</span> nextId <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 下一个用户的id</span>
<span class="token keyword">const</span> users <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 用户数组</span>

<span class="token keyword">const</span> io <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Server</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cors</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

io<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;connection&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 分配用户名</span>
  <span class="token keyword">const</span> username <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">游客</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nextId<span class="token operator">++</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  users<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 广播通知所有用户（含自己)</span>
  io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$updateUser&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>users<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 发送聊天记录</span>
  socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$history&quot;</span><span class="token punctuation">,</span> history<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 告知用户名</span>
  socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$name&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 监听聊天消息</span>
  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;$message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> msg <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> username<span class="token punctuation">,</span>
      content<span class="token punctuation">,</span>
      <span class="token literal-property property">date</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 广播消息</span>
    socket<span class="token punctuation">.</span>broadcast<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$message&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;disconnect&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 清除用户</span>
    users<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 广播通知所有用户</span>
    socket<span class="token punctuation">.</span>broadcast<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;$updateUser&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>users<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

io<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9528</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Socket.io 聊天室已启动，端口号：9528</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><!----></div></footer><nav class="page-nav"><a href="/notes/DuYi/04Interview/10.html" class="nav-link prev" aria-label="十、浏览器相关面试题汇总"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->十、浏览器相关面试题汇总</div></a><a href="/notes/DuYi/04Interview/12.html" class="nav-link next" aria-label="十二、网络相关面试题汇总"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">十二、网络相关面试题汇总<!----></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed | Copyright © 2022-present <a href="/aboutMe">郁子IKUKO</a></div><!----></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-78203928.js" defer></script>
  </body>
</html>
