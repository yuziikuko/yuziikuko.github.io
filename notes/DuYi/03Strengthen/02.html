<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <link rel="icon" href="/favicon.ico"><title>二、Node | 郁子IKUKO</title><meta name="description" content="感谢访问郁子IKUKO的个人VuePress站点">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-0928dba3.css" as="style"><link rel="stylesheet" href="/assets/style-0928dba3.css">
    <link rel="modulepreload" href="/assets/app-76ddb839.js"><link rel="modulepreload" href="/assets/02.html-56d6ab05.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="modulepreload" href="/assets/02.html-4f8d02c1.js"><link rel="prefetch" href="/assets/index.html-221afb84.js" as="script"><link rel="prefetch" href="/assets/aboutMe.html-2840a6a7.js" as="script"><link rel="prefetch" href="/assets/00.html-96b55a8c.js" as="script"><link rel="prefetch" href="/assets/01.html-e6df9b5a.js" as="script"><link rel="prefetch" href="/assets/02.html-11fca78f.js" as="script"><link rel="prefetch" href="/assets/03.html-ebd43cc3.js" as="script"><link rel="prefetch" href="/assets/04.html-ebfe8459.js" as="script"><link rel="prefetch" href="/assets/05.html-65efd7d7.js" as="script"><link rel="prefetch" href="/assets/06.html-a41b505a.js" as="script"><link rel="prefetch" href="/assets/07.html-d5728a20.js" as="script"><link rel="prefetch" href="/assets/08.html-b52ad989.js" as="script"><link rel="prefetch" href="/assets/09.html-bf23d13c.js" as="script"><link rel="prefetch" href="/assets/10.html-5f30a1c8.js" as="script"><link rel="prefetch" href="/assets/11.html-6e8e7e48.js" as="script"><link rel="prefetch" href="/assets/00.html-2931d41d.js" as="script"><link rel="prefetch" href="/assets/00.html-22c7b6d5.js" as="script"><link rel="prefetch" href="/assets/BuildFrames.html-a103af1a.js" as="script"><link rel="prefetch" href="/assets/Components.html-007b493b.js" as="script"><link rel="prefetch" href="/assets/Plugins.html-59abb4a4.js" as="script"><link rel="prefetch" href="/assets/ProjectFrames.html-8b20377c.js" as="script"><link rel="prefetch" href="/assets/Tools.html-e4ebefa4.js" as="script"><link rel="prefetch" href="/assets/01.html-e32b710f.js" as="script"><link rel="prefetch" href="/assets/02.html-e6f925c9.js" as="script"><link rel="prefetch" href="/assets/01.html-138307dd.js" as="script"><link rel="prefetch" href="/assets/02.html-36a3d7e5.js" as="script"><link rel="prefetch" href="/assets/03.html-67a8703c.js" as="script"><link rel="prefetch" href="/assets/04.html-b1c3bd41.js" as="script"><link rel="prefetch" href="/assets/01.html-289d2d2f.js" as="script"><link rel="prefetch" href="/assets/02.html-b9dd1013.js" as="script"><link rel="prefetch" href="/assets/03.html-ab069673.js" as="script"><link rel="prefetch" href="/assets/04.html-fea67ded.js" as="script"><link rel="prefetch" href="/assets/05.html-bcab54c7.js" as="script"><link rel="prefetch" href="/assets/06.html-fef3fb73.js" as="script"><link rel="prefetch" href="/assets/07.html-40d9399c.js" as="script"><link rel="prefetch" href="/assets/08.html-5eca19d6.js" as="script"><link rel="prefetch" href="/assets/09.html-e8bd9497.js" as="script"><link rel="prefetch" href="/assets/10.html-cf1ae487.js" as="script"><link rel="prefetch" href="/assets/11.html-5dd6a249.js" as="script"><link rel="prefetch" href="/assets/12.html-6701646f.js" as="script"><link rel="prefetch" href="/assets/13.html-b6ff63e5.js" as="script"><link rel="prefetch" href="/assets/14.html-767c3380.js" as="script"><link rel="prefetch" href="/assets/15.html-1b5910bb.js" as="script"><link rel="prefetch" href="/assets/16.html-c2f8ebfc.js" as="script"><link rel="prefetch" href="/assets/17.html-7ff59cf6.js" as="script"><link rel="prefetch" href="/assets/18.html-5c6a4894.js" as="script"><link rel="prefetch" href="/assets/19.html-747ce878.js" as="script"><link rel="prefetch" href="/assets/20.html-3337292c.js" as="script"><link rel="prefetch" href="/assets/21.html-13b6095e.js" as="script"><link rel="prefetch" href="/assets/22.html-e25fdde3.js" as="script"><link rel="prefetch" href="/assets/23.html-8be95eab.js" as="script"><link rel="prefetch" href="/assets/24.html-c5d85c9d.js" as="script"><link rel="prefetch" href="/assets/01.html-debfe970.js" as="script"><link rel="prefetch" href="/assets/02.html-00769e41.js" as="script"><link rel="prefetch" href="/assets/03.html-a13aaddd.js" as="script"><link rel="prefetch" href="/assets/04.html-eb3cba60.js" as="script"><link rel="prefetch" href="/assets/05.html-2142b0f7.js" as="script"><link rel="prefetch" href="/assets/06.html-a7f19d97.js" as="script"><link rel="prefetch" href="/assets/07.html-bf2f8217.js" as="script"><link rel="prefetch" href="/assets/01.html-8a7d8c4f.js" as="script"><link rel="prefetch" href="/assets/02.html-b3d786af.js" as="script"><link rel="prefetch" href="/assets/03.html-db70123d.js" as="script"><link rel="prefetch" href="/assets/04.html-383c8de7.js" as="script"><link rel="prefetch" href="/assets/05.html-73267259.js" as="script"><link rel="prefetch" href="/assets/01.html-f88e180f.js" as="script"><link rel="prefetch" href="/assets/02.html-e27289bf.js" as="script"><link rel="prefetch" href="/assets/03.html-a43103fd.js" as="script"><link rel="prefetch" href="/assets/04.html-f2691c83.js" as="script"><link rel="prefetch" href="/assets/05.html-fece2b2f.js" as="script"><link rel="prefetch" href="/assets/06.html-d8b8a8fb.js" as="script"><link rel="prefetch" href="/assets/07.html-4ebf6acf.js" as="script"><link rel="prefetch" href="/assets/08.html-4cd3cf1f.js" as="script"><link rel="prefetch" href="/assets/09.html-e3b73392.js" as="script"><link rel="prefetch" href="/assets/01.html-84adb6da.js" as="script"><link rel="prefetch" href="/assets/02.html-3775d709.js" as="script"><link rel="prefetch" href="/assets/03.html-b54650e8.js" as="script"><link rel="prefetch" href="/assets/04.html-1d34cdfd.js" as="script"><link rel="prefetch" href="/assets/05.html-e821d34b.js" as="script"><link rel="prefetch" href="/assets/06.html-185fa103.js" as="script"><link rel="prefetch" href="/assets/07.html-3ba61a6b.js" as="script"><link rel="prefetch" href="/assets/08.html-4448c4c1.js" as="script"><link rel="prefetch" href="/assets/09.html-36954c65.js" as="script"><link rel="prefetch" href="/assets/10.html-f82a4356.js" as="script"><link rel="prefetch" href="/assets/11.html-25dd4994.js" as="script"><link rel="prefetch" href="/assets/12.html-155aa226.js" as="script"><link rel="prefetch" href="/assets/13.html-f633c7a2.js" as="script"><link rel="prefetch" href="/assets/14.html-12f2368a.js" as="script"><link rel="prefetch" href="/assets/15.html-a4fa857a.js" as="script"><link rel="prefetch" href="/assets/16.html-e7464141.js" as="script"><link rel="prefetch" href="/assets/17.html-05b65fbb.js" as="script"><link rel="prefetch" href="/assets/18.html-801fb03d.js" as="script"><link rel="prefetch" href="/assets/19.html-6127d6b0.js" as="script"><link rel="prefetch" href="/assets/20.html-b6414af6.js" as="script"><link rel="prefetch" href="/assets/21.html-d5cf4d4a.js" as="script"><link rel="prefetch" href="/assets/22.html-f0e7e672.js" as="script"><link rel="prefetch" href="/assets/23.html-bcbb32a9.js" as="script"><link rel="prefetch" href="/assets/24.html-942a5f62.js" as="script"><link rel="prefetch" href="/assets/25.html-62bec007.js" as="script"><link rel="prefetch" href="/assets/01.html-2cd152dd.js" as="script"><link rel="prefetch" href="/assets/02.html-367279e6.js" as="script"><link rel="prefetch" href="/assets/03.html-b1eccab5.js" as="script"><link rel="prefetch" href="/assets/04.html-db6610af.js" as="script"><link rel="prefetch" href="/assets/05.html-01ee70a8.js" as="script"><link rel="prefetch" href="/assets/01.html-c423d1ec.js" as="script"><link rel="prefetch" href="/assets/02.html-7ddb4545.js" as="script"><link rel="prefetch" href="/assets/03.html-c9322950.js" as="script"><link rel="prefetch" href="/assets/04.html-50a607cf.js" as="script"><link rel="prefetch" href="/assets/05.html-9f9a95ed.js" as="script"><link rel="prefetch" href="/assets/06.html-3ef7e2a3.js" as="script"><link rel="prefetch" href="/assets/07.html-1fa602d1.js" as="script"><link rel="prefetch" href="/assets/08.html-6e8fe787.js" as="script"><link rel="prefetch" href="/assets/09.html-e854d4ce.js" as="script"><link rel="prefetch" href="/assets/10.html-70af6e14.js" as="script"><link rel="prefetch" href="/assets/11.html-c6bc07d3.js" as="script"><link rel="prefetch" href="/assets/12.html-0d60105a.js" as="script"><link rel="prefetch" href="/assets/13.html-135096f8.js" as="script"><link rel="prefetch" href="/assets/14.html-a99ad9e9.js" as="script"><link rel="prefetch" href="/assets/15.html-40edc619.js" as="script"><link rel="prefetch" href="/assets/16.html-a03798a6.js" as="script"><link rel="prefetch" href="/assets/17.html-9045756b.js" as="script"><link rel="prefetch" href="/assets/18.html-7432f811.js" as="script"><link rel="prefetch" href="/assets/19.html-7820b8e1.js" as="script"><link rel="prefetch" href="/assets/20.html-23d51cc4.js" as="script"><link rel="prefetch" href="/assets/21.html-284e5cc4.js" as="script"><link rel="prefetch" href="/assets/22.html-b8ccb907.js" as="script"><link rel="prefetch" href="/assets/23.html-77635b47.js" as="script"><link rel="prefetch" href="/assets/24.html-39cbfec4.js" as="script"><link rel="prefetch" href="/assets/25.html-da8e2afa.js" as="script"><link rel="prefetch" href="/assets/26.html-02f91707.js" as="script"><link rel="prefetch" href="/assets/27.html-090549ad.js" as="script"><link rel="prefetch" href="/assets/28.html-284e9916.js" as="script"><link rel="prefetch" href="/assets/29.html-508446ca.js" as="script"><link rel="prefetch" href="/assets/30.html-6428ebee.js" as="script"><link rel="prefetch" href="/assets/31.html-c21385c0.js" as="script"><link rel="prefetch" href="/assets/32.html-523660fd.js" as="script"><link rel="prefetch" href="/assets/33.html-ad5ce2cf.js" as="script"><link rel="prefetch" href="/assets/34.html-ba571ecc.js" as="script"><link rel="prefetch" href="/assets/35.html-ceb47f6d.js" as="script"><link rel="prefetch" href="/assets/36.html-769e8ced.js" as="script"><link rel="prefetch" href="/assets/37.html-d4a60e7b.js" as="script"><link rel="prefetch" href="/assets/38.html-511680da.js" as="script"><link rel="prefetch" href="/assets/39.html-1113b389.js" as="script"><link rel="prefetch" href="/assets/40.html-dbca818e.js" as="script"><link rel="prefetch" href="/assets/41.html-be01e605.js" as="script"><link rel="prefetch" href="/assets/01.html-8761d4a6.js" as="script"><link rel="prefetch" href="/assets/02.html-ea895f0c.js" as="script"><link rel="prefetch" href="/assets/03.html-caa2a07a.js" as="script"><link rel="prefetch" href="/assets/04.html-cd3a4c7a.js" as="script"><link rel="prefetch" href="/assets/05.html-fa347cda.js" as="script"><link rel="prefetch" href="/assets/06.html-07ae7e12.js" as="script"><link rel="prefetch" href="/assets/07.html-9ba34d7f.js" as="script"><link rel="prefetch" href="/assets/08.html-92b78e63.js" as="script"><link rel="prefetch" href="/assets/09.html-59b08133.js" as="script"><link rel="prefetch" href="/assets/10.html-046d8ee0.js" as="script"><link rel="prefetch" href="/assets/11.html-9092ad84.js" as="script"><link rel="prefetch" href="/assets/12.html-db56ceab.js" as="script"><link rel="prefetch" href="/assets/001.html-5bc54288.js" as="script"><link rel="prefetch" href="/assets/002.html-7d0072ec.js" as="script"><link rel="prefetch" href="/assets/01.html-a46f1f0c.js" as="script"><link rel="prefetch" href="/assets/02.html-096e899d.js" as="script"><link rel="prefetch" href="/assets/03.html-92f4b8df.js" as="script"><link rel="prefetch" href="/assets/04.html-338def6a.js" as="script"><link rel="prefetch" href="/assets/05.html-2fec9666.js" as="script"><link rel="prefetch" href="/assets/06.html-a5607666.js" as="script"><link rel="prefetch" href="/assets/07.html-4c0273e9.js" as="script"><link rel="prefetch" href="/assets/08.html-5c63505e.js" as="script"><link rel="prefetch" href="/assets/09.html-50d3f0d8.js" as="script"><link rel="prefetch" href="/assets/10.html-6092a1ac.js" as="script"><link rel="prefetch" href="/assets/11.html-f32d9d62.js" as="script"><link rel="prefetch" href="/assets/12.html-b824f101.js" as="script"><link rel="prefetch" href="/assets/13.html-38712092.js" as="script"><link rel="prefetch" href="/assets/01.html-1cda54dd.js" as="script"><link rel="prefetch" href="/assets/02.html-83407429.js" as="script"><link rel="prefetch" href="/assets/03.html-a9202097.js" as="script"><link rel="prefetch" href="/assets/04.html-b8dff6fd.js" as="script"><link rel="prefetch" href="/assets/01.html-5379551c.js" as="script"><link rel="prefetch" href="/assets/404.html-f04ced3e.js" as="script"><link rel="prefetch" href="/assets/index.html-486ec3b2.js" as="script"><link rel="prefetch" href="/assets/index.html-1447883c.js" as="script"><link rel="prefetch" href="/assets/index.html-9f9b2bde.js" as="script"><link rel="prefetch" href="/assets/index.html-c17bbc25.js" as="script"><link rel="prefetch" href="/assets/index.html-53309277.js" as="script"><link rel="prefetch" href="/assets/index.html-3ebeff2f.js" as="script"><link rel="prefetch" href="/assets/index.html-db01bc95.js" as="script"><link rel="prefetch" href="/assets/index.html-7ab6628d.js" as="script"><link rel="prefetch" href="/assets/index.html-172d8032.js" as="script"><link rel="prefetch" href="/assets/index.html-d36ccd46.js" as="script"><link rel="prefetch" href="/assets/index.html-77d26d84.js" as="script"><link rel="prefetch" href="/assets/index.html-0a8a3156.js" as="script"><link rel="prefetch" href="/assets/index.html-f9fcdd03.js" as="script"><link rel="prefetch" href="/assets/index.html-fcffe727.js" as="script"><link rel="prefetch" href="/assets/index.html-0e4dd527.js" as="script"><link rel="prefetch" href="/assets/index.html-eaeaf55e.js" as="script"><link rel="prefetch" href="/assets/index.html-d0c667d0.js" as="script"><link rel="prefetch" href="/assets/index.html-e609b71c.js" as="script"><link rel="prefetch" href="/assets/index.html-04a11369.js" as="script"><link rel="prefetch" href="/assets/index.html-d1922e1a.js" as="script"><link rel="prefetch" href="/assets/index.html-c43655ce.js" as="script"><link rel="prefetch" href="/assets/index.html-b67245ca.js" as="script"><link rel="prefetch" href="/assets/index.html-f68d10cb.js" as="script"><link rel="prefetch" href="/assets/index.html-cfb7f412.js" as="script"><link rel="prefetch" href="/assets/index.html-69c2e1ec.js" as="script"><link rel="prefetch" href="/assets/index.html-cff1613f.js" as="script"><link rel="prefetch" href="/assets/index.html-dec8813f.js" as="script"><link rel="prefetch" href="/assets/index.html-745ce1e2.js" as="script"><link rel="prefetch" href="/assets/index.html-e42f371f.js" as="script"><link rel="prefetch" href="/assets/index.html-69d25315.js" as="script"><link rel="prefetch" href="/assets/index.html-66f8ec3f.js" as="script"><link rel="prefetch" href="/assets/index.html-41cfbae3.js" as="script"><link rel="prefetch" href="/assets/index.html-6d03a066.js" as="script"><link rel="prefetch" href="/assets/index.html-4d9a82e4.js" as="script"><link rel="prefetch" href="/assets/index.html-c585c970.js" as="script"><link rel="prefetch" href="/assets/index.html-1807d46c.js" as="script"><link rel="prefetch" href="/assets/index.html-b0ab55f8.js" as="script"><link rel="prefetch" href="/assets/index.html-ef5155e6.js" as="script"><link rel="prefetch" href="/assets/index.html-cf4d1f7c.js" as="script"><link rel="prefetch" href="/assets/index.html-d999584f.js" as="script"><link rel="prefetch" href="/assets/index.html-d6477813.js" as="script"><link rel="prefetch" href="/assets/index.html-b1f56885.js" as="script"><link rel="prefetch" href="/assets/index.html-8a42e456.js" as="script"><link rel="prefetch" href="/assets/index.html-6271d100.js" as="script"><link rel="prefetch" href="/assets/index.html-f87c981b.js" as="script"><link rel="prefetch" href="/assets/index.html-d6be6312.js" as="script"><link rel="prefetch" href="/assets/index.html-fbb51782.js" as="script"><link rel="prefetch" href="/assets/index.html-4fe9d7ec.js" as="script"><link rel="prefetch" href="/assets/index.html-d4dd90c5.js" as="script"><link rel="prefetch" href="/assets/index.html-7d9abe40.js" as="script"><link rel="prefetch" href="/assets/index.html-8549e6d6.js" as="script"><link rel="prefetch" href="/assets/index.html-ddc9db08.js" as="script"><link rel="prefetch" href="/assets/index.html-866458d4.js" as="script"><link rel="prefetch" href="/assets/index.html-4139471e.js" as="script"><link rel="prefetch" href="/assets/index.html-86cb0b5c.js" as="script"><link rel="prefetch" href="/assets/index.html-8e7427e2.js" as="script"><link rel="prefetch" href="/assets/index.html-89f511ee.js" as="script"><link rel="prefetch" href="/assets/index.html-f3f60bc8.js" as="script"><link rel="prefetch" href="/assets/index.html-e4541426.js" as="script"><link rel="prefetch" href="/assets/index.html-b44e200b.js" as="script"><link rel="prefetch" href="/assets/index.html-bf4a2d22.js" as="script"><link rel="prefetch" href="/assets/index.html-e1272503.js" as="script"><link rel="prefetch" href="/assets/index.html-0b17dc56.js" as="script"><link rel="prefetch" href="/assets/index.html-be88dee5.js" as="script"><link rel="prefetch" href="/assets/index.html-94a8e1d7.js" as="script"><link rel="prefetch" href="/assets/index.html-cfde99b9.js" as="script"><link rel="prefetch" href="/assets/index.html-378c2473.js" as="script"><link rel="prefetch" href="/assets/index.html-027a95cc.js" as="script"><link rel="prefetch" href="/assets/index.html-42feb1d0.js" as="script"><link rel="prefetch" href="/assets/index.html-6f0904ff.js" as="script"><link rel="prefetch" href="/assets/index.html-dec65fa0.js" as="script"><link rel="prefetch" href="/assets/index.html-f5270fa2.js" as="script"><link rel="prefetch" href="/assets/index.html-dd2fae20.js" as="script"><link rel="prefetch" href="/assets/index.html-60df0079.js" as="script"><link rel="prefetch" href="/assets/index.html-1c4c34d6.js" as="script"><link rel="prefetch" href="/assets/index.html-7d761878.js" as="script"><link rel="prefetch" href="/assets/index.html-d7339742.js" as="script"><link rel="prefetch" href="/assets/index.html-ea7a6632.js" as="script"><link rel="prefetch" href="/assets/index.html-92cd749b.js" as="script"><link rel="prefetch" href="/assets/index.html-346a3160.js" as="script"><link rel="prefetch" href="/assets/index.html-308efcdc.js" as="script"><link rel="prefetch" href="/assets/index.html-c753ec2d.js" as="script"><link rel="prefetch" href="/assets/index.html-d9745392.js" as="script"><link rel="prefetch" href="/assets/index.html-e058b54e.js" as="script"><link rel="prefetch" href="/assets/index.html-a6f64289.js" as="script"><link rel="prefetch" href="/assets/index.html-eee55acd.js" as="script"><link rel="prefetch" href="/assets/index.html-7e00beca.js" as="script"><link rel="prefetch" href="/assets/index.html-814e0476.js" as="script"><link rel="prefetch" href="/assets/index.html-2ad27254.js" as="script"><link rel="prefetch" href="/assets/index.html-b8637964.js" as="script"><link rel="prefetch" href="/assets/index.html-2fbdddc6.js" as="script"><link rel="prefetch" href="/assets/index.html-0337e30e.js" as="script"><link rel="prefetch" href="/assets/index.html-57eea149.js" as="script"><link rel="prefetch" href="/assets/index.html-d027558d.js" as="script"><link rel="prefetch" href="/assets/index.html-601250f8.js" as="script"><link rel="prefetch" href="/assets/index.html-28fe159e.js" as="script"><link rel="prefetch" href="/assets/index.html-ba49a850.js" as="script"><link rel="prefetch" href="/assets/index.html-2d237419.js" as="script"><link rel="prefetch" href="/assets/aboutMe.html-7787fe42.js" as="script"><link rel="prefetch" href="/assets/00.html-87f6ee93.js" as="script"><link rel="prefetch" href="/assets/01.html-18fb996d.js" as="script"><link rel="prefetch" href="/assets/02.html-8c3befc5.js" as="script"><link rel="prefetch" href="/assets/03.html-f6b1d52c.js" as="script"><link rel="prefetch" href="/assets/04.html-8ff8237f.js" as="script"><link rel="prefetch" href="/assets/05.html-f780a695.js" as="script"><link rel="prefetch" href="/assets/06.html-47603e0a.js" as="script"><link rel="prefetch" href="/assets/07.html-816a3d70.js" as="script"><link rel="prefetch" href="/assets/08.html-a6083cf6.js" as="script"><link rel="prefetch" href="/assets/09.html-bf188672.js" as="script"><link rel="prefetch" href="/assets/10.html-18f91e86.js" as="script"><link rel="prefetch" href="/assets/11.html-24cfb26e.js" as="script"><link rel="prefetch" href="/assets/00.html-e6544c95.js" as="script"><link rel="prefetch" href="/assets/00.html-c284f785.js" as="script"><link rel="prefetch" href="/assets/BuildFrames.html-51821b51.js" as="script"><link rel="prefetch" href="/assets/Components.html-c3b34336.js" as="script"><link rel="prefetch" href="/assets/Plugins.html-43b36cb1.js" as="script"><link rel="prefetch" href="/assets/ProjectFrames.html-28129dc4.js" as="script"><link rel="prefetch" href="/assets/Tools.html-cf684813.js" as="script"><link rel="prefetch" href="/assets/01.html-93263537.js" as="script"><link rel="prefetch" href="/assets/02.html-d016e58f.js" as="script"><link rel="prefetch" href="/assets/01.html-f4ca554e.js" as="script"><link rel="prefetch" href="/assets/02.html-f0eaaaf4.js" as="script"><link rel="prefetch" href="/assets/03.html-74232eea.js" as="script"><link rel="prefetch" href="/assets/04.html-0d6061d2.js" as="script"><link rel="prefetch" href="/assets/01.html-31d69311.js" as="script"><link rel="prefetch" href="/assets/02.html-c13a9107.js" as="script"><link rel="prefetch" href="/assets/03.html-e5065918.js" as="script"><link rel="prefetch" href="/assets/04.html-553212ff.js" as="script"><link rel="prefetch" href="/assets/05.html-966b3996.js" as="script"><link rel="prefetch" href="/assets/06.html-9d7dd559.js" as="script"><link rel="prefetch" href="/assets/07.html-55663098.js" as="script"><link rel="prefetch" href="/assets/08.html-a76902bf.js" as="script"><link rel="prefetch" href="/assets/09.html-9c232f24.js" as="script"><link rel="prefetch" href="/assets/10.html-40ccea35.js" as="script"><link rel="prefetch" href="/assets/11.html-493bad6b.js" as="script"><link rel="prefetch" href="/assets/12.html-c222b8d7.js" as="script"><link rel="prefetch" href="/assets/13.html-62b13ea3.js" as="script"><link rel="prefetch" href="/assets/14.html-8d9744cd.js" as="script"><link rel="prefetch" href="/assets/15.html-f7981482.js" as="script"><link rel="prefetch" href="/assets/16.html-28a21989.js" as="script"><link rel="prefetch" href="/assets/17.html-dc35d428.js" as="script"><link rel="prefetch" href="/assets/18.html-241d1003.js" as="script"><link rel="prefetch" href="/assets/19.html-86c4a4e8.js" as="script"><link rel="prefetch" href="/assets/20.html-61662128.js" as="script"><link rel="prefetch" href="/assets/21.html-0612ba74.js" as="script"><link rel="prefetch" href="/assets/22.html-6a6a63fe.js" as="script"><link rel="prefetch" href="/assets/23.html-3dff0719.js" as="script"><link rel="prefetch" href="/assets/24.html-8262b5ee.js" as="script"><link rel="prefetch" href="/assets/01.html-b333dfb1.js" as="script"><link rel="prefetch" href="/assets/02.html-983e5188.js" as="script"><link rel="prefetch" href="/assets/03.html-fd3ba2af.js" as="script"><link rel="prefetch" href="/assets/04.html-9b2ab368.js" as="script"><link rel="prefetch" href="/assets/05.html-9f03f223.js" as="script"><link rel="prefetch" href="/assets/06.html-8d4f7deb.js" as="script"><link rel="prefetch" href="/assets/07.html-f379f16d.js" as="script"><link rel="prefetch" href="/assets/01.html-72aaa689.js" as="script"><link rel="prefetch" href="/assets/02.html-afef3d19.js" as="script"><link rel="prefetch" href="/assets/03.html-0bd72ce0.js" as="script"><link rel="prefetch" href="/assets/04.html-79f14d9d.js" as="script"><link rel="prefetch" href="/assets/05.html-6e55f101.js" as="script"><link rel="prefetch" href="/assets/01.html-ec7415f1.js" as="script"><link rel="prefetch" href="/assets/02.html-e94ef1e4.js" as="script"><link rel="prefetch" href="/assets/03.html-97c0a631.js" as="script"><link rel="prefetch" href="/assets/04.html-3c14c6be.js" as="script"><link rel="prefetch" href="/assets/05.html-f64f8d18.js" as="script"><link rel="prefetch" href="/assets/06.html-e8963a76.js" as="script"><link rel="prefetch" href="/assets/07.html-f8f2b0ca.js" as="script"><link rel="prefetch" href="/assets/08.html-a19fca51.js" as="script"><link rel="prefetch" href="/assets/09.html-5c90f597.js" as="script"><link rel="prefetch" href="/assets/01.html-a358a898.js" as="script"><link rel="prefetch" href="/assets/02.html-df2d6320.js" as="script"><link rel="prefetch" href="/assets/03.html-2e25f72f.js" as="script"><link rel="prefetch" href="/assets/04.html-f5dddf79.js" as="script"><link rel="prefetch" href="/assets/05.html-fb97b36e.js" as="script"><link rel="prefetch" href="/assets/06.html-3068969a.js" as="script"><link rel="prefetch" href="/assets/07.html-cec94341.js" as="script"><link rel="prefetch" href="/assets/08.html-dfa60319.js" as="script"><link rel="prefetch" href="/assets/09.html-6a0900c9.js" as="script"><link rel="prefetch" href="/assets/10.html-1674215d.js" as="script"><link rel="prefetch" href="/assets/11.html-56c9e79c.js" as="script"><link rel="prefetch" href="/assets/12.html-e49be691.js" as="script"><link rel="prefetch" href="/assets/13.html-b6e99807.js" as="script"><link rel="prefetch" href="/assets/14.html-ccc7637a.js" as="script"><link rel="prefetch" href="/assets/15.html-ffd6586f.js" as="script"><link rel="prefetch" href="/assets/16.html-e65381c4.js" as="script"><link rel="prefetch" href="/assets/17.html-f4fb97a3.js" as="script"><link rel="prefetch" href="/assets/18.html-fbccbaab.js" as="script"><link rel="prefetch" href="/assets/19.html-a78ff7ab.js" as="script"><link rel="prefetch" href="/assets/20.html-20af35d4.js" as="script"><link rel="prefetch" href="/assets/21.html-4b559054.js" as="script"><link rel="prefetch" href="/assets/22.html-3b06b9dc.js" as="script"><link rel="prefetch" href="/assets/23.html-9d1a8c75.js" as="script"><link rel="prefetch" href="/assets/24.html-c33fb1f0.js" as="script"><link rel="prefetch" href="/assets/25.html-f0c0861c.js" as="script"><link rel="prefetch" href="/assets/01.html-16ad8880.js" as="script"><link rel="prefetch" href="/assets/02.html-2f1ccbfd.js" as="script"><link rel="prefetch" href="/assets/03.html-51186c24.js" as="script"><link rel="prefetch" href="/assets/04.html-e8cb6f31.js" as="script"><link rel="prefetch" href="/assets/05.html-0b3bebc3.js" as="script"><link rel="prefetch" href="/assets/01.html-ddb3244b.js" as="script"><link rel="prefetch" href="/assets/02.html-3fb42f11.js" as="script"><link rel="prefetch" href="/assets/03.html-1a745468.js" as="script"><link rel="prefetch" href="/assets/04.html-9b5307e4.js" as="script"><link rel="prefetch" href="/assets/05.html-37309835.js" as="script"><link rel="prefetch" href="/assets/06.html-8635165b.js" as="script"><link rel="prefetch" href="/assets/07.html-55a8ef84.js" as="script"><link rel="prefetch" href="/assets/08.html-38449fea.js" as="script"><link rel="prefetch" href="/assets/09.html-3f02329e.js" as="script"><link rel="prefetch" href="/assets/10.html-d6e873ab.js" as="script"><link rel="prefetch" href="/assets/11.html-42825156.js" as="script"><link rel="prefetch" href="/assets/12.html-82cebf2a.js" as="script"><link rel="prefetch" href="/assets/13.html-a8e2929e.js" as="script"><link rel="prefetch" href="/assets/14.html-60350d83.js" as="script"><link rel="prefetch" href="/assets/15.html-94cdada3.js" as="script"><link rel="prefetch" href="/assets/16.html-d82ce8a1.js" as="script"><link rel="prefetch" href="/assets/17.html-75613798.js" as="script"><link rel="prefetch" href="/assets/18.html-8968a3ef.js" as="script"><link rel="prefetch" href="/assets/19.html-0b4fc738.js" as="script"><link rel="prefetch" href="/assets/20.html-705e4f65.js" as="script"><link rel="prefetch" href="/assets/21.html-d87a6f17.js" as="script"><link rel="prefetch" href="/assets/22.html-2174b000.js" as="script"><link rel="prefetch" href="/assets/23.html-f7ee7abb.js" as="script"><link rel="prefetch" href="/assets/24.html-a4093beb.js" as="script"><link rel="prefetch" href="/assets/25.html-40c86dc1.js" as="script"><link rel="prefetch" href="/assets/26.html-99068f0d.js" as="script"><link rel="prefetch" href="/assets/27.html-7f2f7e45.js" as="script"><link rel="prefetch" href="/assets/28.html-38ad24dc.js" as="script"><link rel="prefetch" href="/assets/29.html-2c453457.js" as="script"><link rel="prefetch" href="/assets/30.html-cb35d7d8.js" as="script"><link rel="prefetch" href="/assets/31.html-95deb0d0.js" as="script"><link rel="prefetch" href="/assets/32.html-2df27ad4.js" as="script"><link rel="prefetch" href="/assets/33.html-c9188454.js" as="script"><link rel="prefetch" href="/assets/34.html-babd4fb1.js" as="script"><link rel="prefetch" href="/assets/35.html-1ecd0906.js" as="script"><link rel="prefetch" href="/assets/36.html-ea862fda.js" as="script"><link rel="prefetch" href="/assets/37.html-14af8041.js" as="script"><link rel="prefetch" href="/assets/38.html-8dd21ed7.js" as="script"><link rel="prefetch" href="/assets/39.html-6461a953.js" as="script"><link rel="prefetch" href="/assets/40.html-10bf1e81.js" as="script"><link rel="prefetch" href="/assets/41.html-9f792780.js" as="script"><link rel="prefetch" href="/assets/01.html-912b9b83.js" as="script"><link rel="prefetch" href="/assets/02.html-1386e6db.js" as="script"><link rel="prefetch" href="/assets/03.html-a85cea0d.js" as="script"><link rel="prefetch" href="/assets/04.html-12bc7704.js" as="script"><link rel="prefetch" href="/assets/05.html-9e53962b.js" as="script"><link rel="prefetch" href="/assets/06.html-108bb02d.js" as="script"><link rel="prefetch" href="/assets/07.html-bf4414ab.js" as="script"><link rel="prefetch" href="/assets/08.html-2c38014b.js" as="script"><link rel="prefetch" href="/assets/09.html-2a9fd027.js" as="script"><link rel="prefetch" href="/assets/10.html-3da72161.js" as="script"><link rel="prefetch" href="/assets/11.html-dbac9f78.js" as="script"><link rel="prefetch" href="/assets/12.html-bdf1f05c.js" as="script"><link rel="prefetch" href="/assets/001.html-35adade4.js" as="script"><link rel="prefetch" href="/assets/002.html-35950ba9.js" as="script"><link rel="prefetch" href="/assets/01.html-db215c73.js" as="script"><link rel="prefetch" href="/assets/02.html-55caf967.js" as="script"><link rel="prefetch" href="/assets/03.html-28b48c35.js" as="script"><link rel="prefetch" href="/assets/04.html-10bbebcd.js" as="script"><link rel="prefetch" href="/assets/05.html-9ff00a5f.js" as="script"><link rel="prefetch" href="/assets/06.html-23459908.js" as="script"><link rel="prefetch" href="/assets/07.html-6cfcec8d.js" as="script"><link rel="prefetch" href="/assets/08.html-e328993d.js" as="script"><link rel="prefetch" href="/assets/09.html-8be061f7.js" as="script"><link rel="prefetch" href="/assets/10.html-1dda468b.js" as="script"><link rel="prefetch" href="/assets/11.html-ac67230f.js" as="script"><link rel="prefetch" href="/assets/12.html-dfaf1358.js" as="script"><link rel="prefetch" href="/assets/13.html-9376bf4b.js" as="script"><link rel="prefetch" href="/assets/01.html-d4672625.js" as="script"><link rel="prefetch" href="/assets/02.html-eb4cf0c9.js" as="script"><link rel="prefetch" href="/assets/03.html-cea153a6.js" as="script"><link rel="prefetch" href="/assets/04.html-f240b4a4.js" as="script"><link rel="prefetch" href="/assets/01.html-5bc2e465.js" as="script"><link rel="prefetch" href="/assets/404.html-84de0ca2.js" as="script"><link rel="prefetch" href="/assets/index.html-ae5c2221.js" as="script"><link rel="prefetch" href="/assets/index.html-487ccb6e.js" as="script"><link rel="prefetch" href="/assets/index.html-c372bced.js" as="script"><link rel="prefetch" href="/assets/index.html-9baa7b5a.js" as="script"><link rel="prefetch" href="/assets/index.html-83895849.js" as="script"><link rel="prefetch" href="/assets/index.html-20d88d8a.js" as="script"><link rel="prefetch" href="/assets/index.html-6e013752.js" as="script"><link rel="prefetch" href="/assets/index.html-d845816a.js" as="script"><link rel="prefetch" href="/assets/index.html-f7131b53.js" as="script"><link rel="prefetch" href="/assets/index.html-b3bbf1c0.js" as="script"><link rel="prefetch" href="/assets/index.html-3bebcfe1.js" as="script"><link rel="prefetch" href="/assets/index.html-38d8191e.js" as="script"><link rel="prefetch" href="/assets/index.html-03c75b45.js" as="script"><link rel="prefetch" href="/assets/index.html-bc4f5828.js" as="script"><link rel="prefetch" href="/assets/index.html-a320a858.js" as="script"><link rel="prefetch" href="/assets/index.html-1c16a74e.js" as="script"><link rel="prefetch" href="/assets/index.html-369d2c8f.js" as="script"><link rel="prefetch" href="/assets/index.html-727bc081.js" as="script"><link rel="prefetch" href="/assets/index.html-3997afb2.js" as="script"><link rel="prefetch" href="/assets/index.html-033b0564.js" as="script"><link rel="prefetch" href="/assets/index.html-e9ae545c.js" as="script"><link rel="prefetch" href="/assets/index.html-b40df6d9.js" as="script"><link rel="prefetch" href="/assets/index.html-101a498d.js" as="script"><link rel="prefetch" href="/assets/index.html-b055a540.js" as="script"><link rel="prefetch" href="/assets/index.html-06a12e05.js" as="script"><link rel="prefetch" href="/assets/index.html-5682cce3.js" as="script"><link rel="prefetch" href="/assets/index.html-db696b48.js" as="script"><link rel="prefetch" href="/assets/index.html-910c3352.js" as="script"><link rel="prefetch" href="/assets/index.html-ad2d99d8.js" as="script"><link rel="prefetch" href="/assets/index.html-1f54557a.js" as="script"><link rel="prefetch" href="/assets/index.html-99eca3fb.js" as="script"><link rel="prefetch" href="/assets/index.html-de9e3c36.js" as="script"><link rel="prefetch" href="/assets/index.html-3b9b6b0f.js" as="script"><link rel="prefetch" href="/assets/index.html-ceb4cd34.js" as="script"><link rel="prefetch" href="/assets/index.html-fb35594b.js" as="script"><link rel="prefetch" href="/assets/index.html-e3aeb45d.js" as="script"><link rel="prefetch" href="/assets/index.html-f41ad94b.js" as="script"><link rel="prefetch" href="/assets/index.html-f1eff439.js" as="script"><link rel="prefetch" href="/assets/index.html-6dc9cb3e.js" as="script"><link rel="prefetch" href="/assets/index.html-848a84fa.js" as="script"><link rel="prefetch" href="/assets/index.html-3ceebec5.js" as="script"><link rel="prefetch" href="/assets/index.html-ad2c5bae.js" as="script"><link rel="prefetch" href="/assets/index.html-209d51a1.js" as="script"><link rel="prefetch" href="/assets/index.html-eba82ca9.js" as="script"><link rel="prefetch" href="/assets/index.html-8ae1c834.js" as="script"><link rel="prefetch" href="/assets/index.html-60aa1e18.js" as="script"><link rel="prefetch" href="/assets/index.html-3a9d297c.js" as="script"><link rel="prefetch" href="/assets/index.html-a01864ac.js" as="script"><link rel="prefetch" href="/assets/index.html-d2240f41.js" as="script"><link rel="prefetch" href="/assets/index.html-74027b28.js" as="script"><link rel="prefetch" href="/assets/index.html-98c02689.js" as="script"><link rel="prefetch" href="/assets/index.html-79dd62fe.js" as="script"><link rel="prefetch" href="/assets/index.html-478d731c.js" as="script"><link rel="prefetch" href="/assets/index.html-8383cb67.js" as="script"><link rel="prefetch" href="/assets/index.html-c5c2ae99.js" as="script"><link rel="prefetch" href="/assets/index.html-eafb28b4.js" as="script"><link rel="prefetch" href="/assets/index.html-7c9a57b3.js" as="script"><link rel="prefetch" href="/assets/index.html-772a52b2.js" as="script"><link rel="prefetch" href="/assets/index.html-2d9d8503.js" as="script"><link rel="prefetch" href="/assets/index.html-3d975f21.js" as="script"><link rel="prefetch" href="/assets/index.html-5b3cfcd2.js" as="script"><link rel="prefetch" href="/assets/index.html-0c68e8bd.js" as="script"><link rel="prefetch" href="/assets/index.html-98f4deeb.js" as="script"><link rel="prefetch" href="/assets/index.html-a76cb8e5.js" as="script"><link rel="prefetch" href="/assets/index.html-74402f43.js" as="script"><link rel="prefetch" href="/assets/index.html-c8610fdc.js" as="script"><link rel="prefetch" href="/assets/index.html-ad18f37c.js" as="script"><link rel="prefetch" href="/assets/index.html-2c3a0016.js" as="script"><link rel="prefetch" href="/assets/index.html-265735fd.js" as="script"><link rel="prefetch" href="/assets/index.html-ce71958a.js" as="script"><link rel="prefetch" href="/assets/index.html-9faa67da.js" as="script"><link rel="prefetch" href="/assets/index.html-42337963.js" as="script"><link rel="prefetch" href="/assets/index.html-d0923c94.js" as="script"><link rel="prefetch" href="/assets/index.html-0bcf74f9.js" as="script"><link rel="prefetch" href="/assets/index.html-72cca8ee.js" as="script"><link rel="prefetch" href="/assets/index.html-387ff085.js" as="script"><link rel="prefetch" href="/assets/index.html-df849088.js" as="script"><link rel="prefetch" href="/assets/index.html-488445b8.js" as="script"><link rel="prefetch" href="/assets/index.html-8c8a46ff.js" as="script"><link rel="prefetch" href="/assets/index.html-5ccef29a.js" as="script"><link rel="prefetch" href="/assets/index.html-0787af95.js" as="script"><link rel="prefetch" href="/assets/index.html-ab209db8.js" as="script"><link rel="prefetch" href="/assets/index.html-e2d945db.js" as="script"><link rel="prefetch" href="/assets/index.html-b3b3c8b9.js" as="script"><link rel="prefetch" href="/assets/index.html-3e9aef9f.js" as="script"><link rel="prefetch" href="/assets/index.html-b6cb564a.js" as="script"><link rel="prefetch" href="/assets/index.html-6e0fd739.js" as="script"><link rel="prefetch" href="/assets/index.html-a54aa4cd.js" as="script"><link rel="prefetch" href="/assets/index.html-faf072b9.js" as="script"><link rel="prefetch" href="/assets/index.html-82de429b.js" as="script"><link rel="prefetch" href="/assets/index.html-46184782.js" as="script"><link rel="prefetch" href="/assets/index.html-4678b346.js" as="script"><link rel="prefetch" href="/assets/index.html-6547bea4.js" as="script"><link rel="prefetch" href="/assets/index.html-44751c49.js" as="script"><link rel="prefetch" href="/assets/index.html-8a6f2ab1.js" as="script"><link rel="prefetch" href="/assets/index.html-cecbde42.js" as="script"><link rel="prefetch" href="/assets/index.html-ecd679fb.js" as="script"><link rel="prefetch" href="/assets/giscus-52604b1e.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-c72a2cd0.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-2450701e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo.png" alt="郁子IKUKO"><!----><span class="site-name hide-in-pad">郁子IKUKO</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="博客主页"><span class="font-icon icon iconfont icon-home" style=""></span>博客主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/websites/00.html" class="nav-link" aria-label="网站合集"><span class="font-icon icon iconfont icon-websites" style=""></span>网站合集<!----></a></div><div class="nav-item hide-in-mobile"><a href="/notes/00.html" class="nav-link" aria-label="学习笔记"><span class="font-icon icon iconfont icon-notes" style=""></span>学习笔记<!----></a></div><div class="nav-item hide-in-mobile"><a href="/articles/00.html" class="nav-link" aria-label="原创随笔"><span class="font-icon icon iconfont icon-articles" style=""></span>原创随笔<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item"><a class="repo-link" href="https://gitee.com/ikuko/vite2-vue3-element-plus.git" target="_blank" rel="noopener noreferrer" aria-label="Gitee"><svg xmlns="http://www.w3.org/2000/svg" class="icon gitee-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="gitee icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm242.97-533.34H482.39a23.7 23.7 0 0 0-23.7 23.7l-.03 59.28c0 13.08 10.59 23.7 23.7 23.7h165.96a23.7 23.7 0 0 1 23.7 23.7v11.85a71.1 71.1 0 0 1-71.1 71.1H375.71a23.7 23.7 0 0 1-23.7-23.7V423.11a71.1 71.1 0 0 1 71.1-71.1h331.8a23.7 23.7 0 0 0 23.7-23.7l.06-59.25a23.73 23.73 0 0 0-23.7-23.73H423.11a177.78 177.78 0 0 0-177.78 177.75v331.83c0 13.08 10.62 23.7 23.7 23.7h349.62a159.99 159.99 0 0 0 159.99-159.99V482.33a23.7 23.7 0 0 0-23.7-23.7z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-notes" style=""></span><a href="/notes/00.html" class="nav-link title" aria-label="学习笔记"><!---->学习笔记<!----></a><!----></p><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/HTML_CSS_JS/01.html" class="nav-link title" aria-label="HTML/CSS/JS"><!---->HTML/CSS/JS<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/ECMAScript6-11/01.html" class="nav-link title" aria-label="ECMAScript 6-11"><!---->ECMAScript 6-11<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/TypeScript/01.html" class="nav-link title" aria-label="TypeScript"><!---->TypeScript<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Vue2/01.html" class="nav-link title" aria-label="Vue 2.x"><!---->Vue 2.x<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Vue3/01.html" class="nav-link title" aria-label="Vue 3.x"><!---->Vue 3.x<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/React16/01.html" class="nav-link title" aria-label="React 16.8"><!---->React 16.8<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/React18/01.html" class="nav-link title" aria-label="React 18"><!---->React 18<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/NextJS/01.html" class="nav-link title" aria-label="NextJS 12"><!---->NextJS 12<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Nginx/01.html" class="nav-link title" aria-label="Nginx(2019)"><!---->Nginx(2019)<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/Algorithm/01.html" class="nav-link title" aria-label="数据结构和算法"><!---->数据结构和算法<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/01Basic/01.html" class="nav-link title" aria-label="渡一教育-语言基础"><!---->渡一教育-语言基础<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/02Central/01.html" class="nav-link title" aria-label="渡一教育-中枢课"><!---->渡一教育-中枢课<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable exact active" type="button"><span class="font-icon icon iconfont icon-sakura" style=""></span><a href="/notes/DuYi/03Strengthen/01.html" class="nav-link title" aria-label="渡一教育-强化课"><!---->渡一教育-强化课<!----></a><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/notes/DuYi/03Strengthen/01.html" class="nav-link sidebar-link sidebar-page" aria-label="一、前端必会算法"><!---->一、前端必会算法<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="二、Node"><!---->二、Node<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#一-node-核心" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（一）Node 核心"><!---->（一）Node 核心<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-node-概述" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.Node 概述"><!---->1.Node 概述<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-全局对象-global" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.全局对象 global"><!---->2.全局对象 global<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-node-的模块化细节" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.Node 的模块化细节"><!---->3.Node 的模块化细节<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-node-中的-es-模块化" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.Node 中的 ES 模块化"><!---->4.Node 中的 ES 模块化<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-基本内置模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.基本内置模块"><!---->5.基本内置模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-文件-i-o" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.文件 I/O"><!---->6.文件 I/O<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-文件流" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.文件流"><!---->7.文件流<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-net-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.net 模块"><!---->8.net 模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-http-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.http 模块"><!---->9.http 模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-https-协议" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.https 协议"><!---->10.https 协议<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-https-模块" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11.https 模块"><!---->11.https 模块<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-node-的生命周期" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12.Node 的生命周期"><!---->12.Node 的生命周期<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_13-eventemitter" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="13.EventEmitter"><!---->13.EventEmitter<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#二-mysql" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（二）MySQL"><!---->（二）MySQL<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-数据库简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.数据库简介"><!---->1.数据库简介<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-安装-mysql" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.安装 MySQL"><!---->2.安装 MySQL<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-数据库设计" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.数据库设计"><!---->3.数据库设计<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-表记录的增删改查-crud" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.表记录的增删改查（CRUD）"><!---->4.表记录的增删改查（CRUD）<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-单表基本查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.单表基本查询"><!---->5.单表基本查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-联表查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.联表查询"><!---->6.联表查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-函数和分组" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.函数和分组"><!---->7.函数和分组<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-视图" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.视图"><!---->8.视图<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#三-数据驱动和-orm" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（三）数据驱动和 ORM"><!---->（三）数据驱动和 ORM<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-mysql-驱动程序" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.MySQL 驱动程序"><!---->1.MySQL 驱动程序<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-sequelize-简介" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.Sequelize 简介"><!---->2.Sequelize 简介<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-模型定义和同步" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.模型定义和同步"><!---->3.模型定义和同步<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-模型的增删改" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.模型的增删改"><!---->4.模型的增删改<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-模拟数据" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.模拟数据"><!---->5.模拟数据<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-数据抓取" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.数据抓取"><!---->6.数据抓取<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-数据查询" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.数据查询"><!---->7.数据查询<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-md5-加密" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.MD5 加密"><!---->8.MD5 加密<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-moment" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.moment"><!---->9.moment<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-数据验证" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.数据验证"><!---->10.数据验证<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-访问器和虚拟字段" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11.访问器和虚拟字段"><!---->11.访问器和虚拟字段<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-日志记录" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12.日志记录"><!---->12.日志记录<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#四-express" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（四）Express"><!---->（四）Express<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-express-的基本使用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.Express 的基本使用"><!---->1.Express 的基本使用<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-nodemon" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.nodemon"><!---->2.nodemon<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-express-中间件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.Express 中间件"><!---->3.Express 中间件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-常用中间件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.常用中间件"><!---->4.常用中间件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-express-路由" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.Express 路由"><!---->5.Express 路由<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-cookie" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.Cookie"><!---->6.Cookie<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-实现登录和认证" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.实现登录和认证"><!---->7.实现登录和认证<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-断点调试" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.断点调试"><!---->8.断点调试<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-跨域-——-jsonp" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9.跨域 —— JSONP"><!---->9.跨域 —— JSONP<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-跨域-——-cors" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10.跨域 —— CORS"><!---->10.跨域 —— CORS<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-cors-中间件" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11.CORS 中间件"><!---->11.CORS 中间件<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-session" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12.Session"><!---->12.Session<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_13-jwt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="13.JWT"><!---->13.JWT<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_14-登录和认证-——-服务器开发" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="14.登录和认证 —— 服务器开发"><!---->14.登录和认证 —— 服务器开发<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_15-登录和认证-——-客户端开发" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="15.登录和认证 —— 客户端开发"><!---->15.登录和认证 —— 客户端开发<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_16-场景-——-日志记录" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="16.场景 —— 日志记录"><!---->16.场景 —— 日志记录<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_17-场景-——-文件上传" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="17.场景 —— 文件上传"><!---->17.场景 —— 文件上传<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_18-场景-——-文件下载" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="18.场景 —— 文件下载"><!---->18.场景 —— 文件下载<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_19-场景-——-图片水印" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="19.场景 —— 图片水印"><!---->19.场景 —— 图片水印<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_20-场景-——-图片防盗链" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="20.场景 —— 图片防盗链"><!---->20.场景 —— 图片防盗链<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_21-场景-——-代理【重要】" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="21.场景 —— 代理【重要】"><!---->21.场景 —— 代理【重要】<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_22-场景-——-模版引擎" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="22.场景 —— 模版引擎"><!---->22.场景 —— 模版引擎<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_23-场景-——-生成二维码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="23.场景 —— 生成二维码"><!---->23.场景 —— 生成二维码<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_24-场景-——-生成验证码" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="24.场景 —— 生成验证码"><!---->24.场景 —— 生成验证码<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_25-场景-——-客户端缓存" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="25.场景 —— 客户端缓存"><!---->25.场景 —— 客户端缓存<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_26-场景-——-富文本框" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="26.场景 —— 富文本框"><!---->26.场景 —— 富文本框<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#五-补充" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="（五）补充"><!---->（五）补充<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-websocket-原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.WebSocket 原理"><!---->1.WebSocket 原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-socket-io" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.socket.io"><!---->2.socket.io<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-在线聊天室" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.在线聊天室"><!---->3.在线聊天室<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-csrf-攻击和防御" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.CSRF 攻击和防御"><!---->4.CSRF 攻击和防御<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-xss-攻击和防御" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.XSS 攻击和防御"><!---->5.XSS 攻击和防御<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-nodejs-组成原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.NodeJS 组成原理"><!---->6.NodeJS 组成原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-进程和线程" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.进程和线程"><!---->7.进程和线程<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->二、Node</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/aboutMe" target="_blank" rel="noopener noreferrer">郁子</a></span><span property="author" content="郁子"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-09-16T00:00:00.000Z"></span><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 65 分钟</span><meta property="timeRequired" content="PT65M"></span><span class="page-word-info" aria-label="字数🔠" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>约 19398 字</span><meta property="wordCount" content="19398"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category8 clickable" role="navigation">笔记</span><span class="page-category-item category2 clickable" role="navigation">渡一教育</span><span class="page-category-item category0 clickable" role="navigation">强化课</span><!--]--><meta property="articleSection" content="笔记,渡一教育,强化课"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag6 clickable" role="navigation">袁进</span><!--]--><meta property="keywords" content="袁进"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#一-node-核心" class="router-link-active router-link-exact-active toc-link level2">（一）Node 核心</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-node-概述" class="router-link-active router-link-exact-active toc-link level3">1.Node 概述</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-全局对象-global" class="router-link-active router-link-exact-active toc-link level3">2.全局对象 global</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-node-的模块化细节" class="router-link-active router-link-exact-active toc-link level3">3.Node 的模块化细节</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-node-中的-es-模块化" class="router-link-active router-link-exact-active toc-link level3">4.Node 中的 ES 模块化</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-基本内置模块" class="router-link-active router-link-exact-active toc-link level3">5.基本内置模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-文件-i-o" class="router-link-active router-link-exact-active toc-link level3">6.文件 I/O</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-文件流" class="router-link-active router-link-exact-active toc-link level3">7.文件流</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-net-模块" class="router-link-active router-link-exact-active toc-link level3">8.net 模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-http-模块" class="router-link-active router-link-exact-active toc-link level3">9.http 模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-https-协议" class="router-link-active router-link-exact-active toc-link level3">10.https 协议</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-https-模块" class="router-link-active router-link-exact-active toc-link level3">11.https 模块</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-node-的生命周期" class="router-link-active router-link-exact-active toc-link level3">12.Node 的生命周期</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_13-eventemitter" class="router-link-active router-link-exact-active toc-link level3">13.EventEmitter</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#二-mysql" class="router-link-active router-link-exact-active toc-link level2">（二）MySQL</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-数据库简介" class="router-link-active router-link-exact-active toc-link level3">1.数据库简介</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-安装-mysql" class="router-link-active router-link-exact-active toc-link level3">2.安装 MySQL</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-数据库设计" class="router-link-active router-link-exact-active toc-link level3">3.数据库设计</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-表记录的增删改查-crud" class="router-link-active router-link-exact-active toc-link level3">4.表记录的增删改查（CRUD）</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-单表基本查询" class="router-link-active router-link-exact-active toc-link level3">5.单表基本查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-联表查询" class="router-link-active router-link-exact-active toc-link level3">6.联表查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-函数和分组" class="router-link-active router-link-exact-active toc-link level3">7.函数和分组</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-视图" class="router-link-active router-link-exact-active toc-link level3">8.视图</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#三-数据驱动和-orm" class="router-link-active router-link-exact-active toc-link level2">（三）数据驱动和 ORM</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-mysql-驱动程序" class="router-link-active router-link-exact-active toc-link level3">1.MySQL 驱动程序</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-sequelize-简介" class="router-link-active router-link-exact-active toc-link level3">2.Sequelize 简介</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-模型定义和同步" class="router-link-active router-link-exact-active toc-link level3">3.模型定义和同步</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-模型的增删改" class="router-link-active router-link-exact-active toc-link level3">4.模型的增删改</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-模拟数据" class="router-link-active router-link-exact-active toc-link level3">5.模拟数据</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-数据抓取" class="router-link-active router-link-exact-active toc-link level3">6.数据抓取</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-数据查询" class="router-link-active router-link-exact-active toc-link level3">7.数据查询</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-md5-加密" class="router-link-active router-link-exact-active toc-link level3">8.MD5 加密</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-moment" class="router-link-active router-link-exact-active toc-link level3">9.moment</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-数据验证" class="router-link-active router-link-exact-active toc-link level3">10.数据验证</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-访问器和虚拟字段" class="router-link-active router-link-exact-active toc-link level3">11.访问器和虚拟字段</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-日志记录" class="router-link-active router-link-exact-active toc-link level3">12.日志记录</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#四-express" class="router-link-active router-link-exact-active toc-link level2">（四）Express</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-express-的基本使用" class="router-link-active router-link-exact-active toc-link level3">1.Express 的基本使用</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-nodemon" class="router-link-active router-link-exact-active toc-link level3">2.nodemon</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-express-中间件" class="router-link-active router-link-exact-active toc-link level3">3.Express 中间件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-常用中间件" class="router-link-active router-link-exact-active toc-link level3">4.常用中间件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-express-路由" class="router-link-active router-link-exact-active toc-link level3">5.Express 路由</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-cookie" class="router-link-active router-link-exact-active toc-link level3">6.Cookie</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-实现登录和认证" class="router-link-active router-link-exact-active toc-link level3">7.实现登录和认证</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_8-断点调试" class="router-link-active router-link-exact-active toc-link level3">8.断点调试</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_9-跨域-——-jsonp" class="router-link-active router-link-exact-active toc-link level3">9.跨域 —— JSONP</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_10-跨域-——-cors" class="router-link-active router-link-exact-active toc-link level3">10.跨域 —— CORS</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_11-cors-中间件" class="router-link-active router-link-exact-active toc-link level3">11.CORS 中间件</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_12-session" class="router-link-active router-link-exact-active toc-link level3">12.Session</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_13-jwt" class="router-link-active router-link-exact-active toc-link level3">13.JWT</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_14-登录和认证-——-服务器开发" class="router-link-active router-link-exact-active toc-link level3">14.登录和认证 —— 服务器开发</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_15-登录和认证-——-客户端开发" class="router-link-active router-link-exact-active toc-link level3">15.登录和认证 —— 客户端开发</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_16-场景-——-日志记录" class="router-link-active router-link-exact-active toc-link level3">16.场景 —— 日志记录</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_17-场景-——-文件上传" class="router-link-active router-link-exact-active toc-link level3">17.场景 —— 文件上传</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_18-场景-——-文件下载" class="router-link-active router-link-exact-active toc-link level3">18.场景 —— 文件下载</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_19-场景-——-图片水印" class="router-link-active router-link-exact-active toc-link level3">19.场景 —— 图片水印</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_20-场景-——-图片防盗链" class="router-link-active router-link-exact-active toc-link level3">20.场景 —— 图片防盗链</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_21-场景-——-代理【重要】" class="router-link-active router-link-exact-active toc-link level3">21.场景 —— 代理【重要】</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_22-场景-——-模版引擎" class="router-link-active router-link-exact-active toc-link level3">22.场景 —— 模版引擎</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_23-场景-——-生成二维码" class="router-link-active router-link-exact-active toc-link level3">23.场景 —— 生成二维码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_24-场景-——-生成验证码" class="router-link-active router-link-exact-active toc-link level3">24.场景 —— 生成验证码</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_25-场景-——-客户端缓存" class="router-link-active router-link-exact-active toc-link level3">25.场景 —— 客户端缓存</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_26-场景-——-富文本框" class="router-link-active router-link-exact-active toc-link level3">26.场景 —— 富文本框</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#五-补充" class="router-link-active router-link-exact-active toc-link level2">（五）补充</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_1-websocket-原理" class="router-link-active router-link-exact-active toc-link level3">1.WebSocket 原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_2-socket-io" class="router-link-active router-link-exact-active toc-link level3">2.socket.io</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_3-在线聊天室" class="router-link-active router-link-exact-active toc-link level3">3.在线聊天室</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_4-csrf-攻击和防御" class="router-link-active router-link-exact-active toc-link level3">4.CSRF 攻击和防御</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_5-xss-攻击和防御" class="router-link-active router-link-exact-active toc-link level3">5.XSS 攻击和防御</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_6-nodejs-组成原理" class="router-link-active router-link-exact-active toc-link level3">6.NodeJS 组成原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/notes/DuYi/03Strengthen/02.html#_7-进程和线程" class="router-link-active router-link-exact-active toc-link level3">7.进程和线程</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="一-node-核心" tabindex="-1"><a class="header-anchor" href="#一-node-核心" aria-hidden="true">#</a> （一）Node 核心</h2><h3 id="_1-node-概述" tabindex="-1"><a class="header-anchor" href="#_1-node-概述" aria-hidden="true">#</a> 1.Node 概述</h3><blockquote><p><a href="https://nodejs.org/en" target="_blank" rel="noopener noreferrer">Node 官网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><br><p><a href="https://nodejs.cn/" target="_blank" rel="noopener noreferrer">Node 民间中文网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>Node 是一个 JS 的运行环境</li><li>NodeJS 指运行在 Node 环境下的 JavaScript</li></ul><h4 id="_1-浏览器中的-js" tabindex="-1"><a class="header-anchor" href="#_1-浏览器中的-js" aria-hidden="true">#</a> 1）浏览器中的 JS</h4><p><img src="/assets/Node01-e5890767.png" alt=""></p><ul><li>Web API 提供了操作浏览器窗口和页面的能力 <ul><li>BOM</li><li>DOM</li><li>AJAX</li></ul></li><li>该能力有局限 <ul><li>跨域问题</li><li>无法读写文件</li></ul></li></ul><h4 id="_2-node-中的-js" tabindex="-1"><a class="header-anchor" href="#_2-node-中的-js" aria-hidden="true">#</a> 2）Node 中的 JS</h4><p><img src="/assets/Node02-54603832.png" alt=""></p><ul><li>Node API 几乎提供了所有能完成的功能</li></ul><h4 id="_3-分层结构对比" tabindex="-1"><a class="header-anchor" href="#_3-分层结构对比" aria-hidden="true">#</a> 3）分层结构对比</h4><p><img src="/assets/Node03-46adb910.png" alt=""></p><ul><li>浏览器提供了有限的能力 <ul><li>JS 只能使用浏览器提供的功能，完成有限的操作</li></ul></li><li>Node 提供了完整的控制计算机的能力 <ul><li>NodeJS 几乎可以通过 Node 提供的接口，实现对整个操作系统的控制</li></ul></li></ul><h4 id="_4-应用-1-开发桌面应用程序" tabindex="-1"><a class="header-anchor" href="#_4-应用-1-开发桌面应用程序" aria-hidden="true">#</a> 4）应用 1：开发桌面应用程序</h4><ul><li>如：Visual Studio Code</li></ul><h4 id="_5-应用-2-开发服务器应用程序" tabindex="-1"><a class="header-anchor" href="#_5-应用-2-开发服务器应用程序" aria-hidden="true">#</a> 5）应用 2：开发服务器应用程序</h4><ul><li>结构 1 <ul><li>通常应用在微型站点上，如：个人博客</li><li>Node 服务器要完成 <ul><li>请求的处理、响应</li><li>数据库交互</li><li>各种业务逻辑</li></ul></li></ul></li></ul><p><img src="/assets/Node04-2eab8a82.png" alt=""></p><ul><li>结构 2 <ul><li>常见结构，通常应用在各种规模的站点上</li><li>Node 服务器不做任何与业务逻辑相关的处理</li><li>多数时候只负责请求的处理、响应</li><li>有时会负责额外的功能 <ul><li>简单的信息记录，如：请求日志、用户偏好、广告信息</li><li>静态资源托管</li><li>缓存</li></ul></li></ul></li></ul><p><img src="/assets/Node04-2eab8a82.png" alt=""></p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>相较于其他后端编程语言，Node 读写文件速度极快，没有进程切换的负担</p></div><h3 id="_2-全局对象-global" tabindex="-1"><a class="header-anchor" href="#_2-全局对象-global" aria-hidden="true">#</a> 2.全局对象 global</h3><div class="hint-container tip"><p class="hint-container-title">编辑器智能提示</p><p>node i @types/node</p></div><ul><li>global 自身有一个属性 global</li><li>类似于 window 自身有一个属性 window</li><li>都是为了便于全局访问全局对象本身</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span>window <span class="token operator">===</span> window<span class="token punctuation">;</span> <span class="token comment">// true</span>
global<span class="token punctuation">.</span>global <span class="token operator">===</span> global<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-settimeout" tabindex="-1"><a class="header-anchor" href="#_1-settimeout" aria-hidden="true">#</a> 1）setTimeout</h4><ul><li>浏览器环境中返回的是数字（timerId）</li><li>Node 环境中返回的是对象（定时器）</li></ul><h4 id="_2-setinterval" tabindex="-1"><a class="header-anchor" href="#_2-setinterval" aria-hidden="true">#</a> 2）setInterval</h4><ul><li>浏览器环境中返回的是数字（timerId）</li><li>Node 环境中返回的是对象（定时器）</li></ul><h4 id="_3-setimmediate" tabindex="-1"><a class="header-anchor" href="#_3-setimmediate" aria-hidden="true">#</a> 3）setImmediate</h4><ul><li>类似于 setTimeout 0</li></ul><h4 id="_4-console" tabindex="-1"><a class="header-anchor" href="#_4-console" aria-hidden="true">#</a> 4）console</h4><ul><li>和浏览器环境中的 console 一致</li></ul><h4 id="_5-dirname" tabindex="-1"><a class="header-anchor" href="#_5-dirname" aria-hidden="true">#</a> 5）<code>__dirname</code></h4><ul><li>获取当前模块所在的目录</li><li>不是 global 的属性</li></ul><h4 id="_6-filename" tabindex="-1"><a class="header-anchor" href="#_6-filename" aria-hidden="true">#</a> 6）<code>__filename</code></h4><ul><li>获取当前模块的文件路径</li><li>不是 global 的属性</li></ul><h4 id="_7-buffer" tabindex="-1"><a class="header-anchor" href="#_7-buffer" aria-hidden="true">#</a> 7）Buffer</h4><ul><li>类型化数组</li><li>继承自 UInt8Array</li><li>计算机中存储的基本单位 —— 字节</li><li>使用时、输出时可能需要使用 <a href="http://blog.yuanjin.tech/article/94" target="_blank" rel="noopener noreferrer">十六进制<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 表示</li></ul><h4 id="_8-process" tabindex="-1"><a class="header-anchor" href="#_8-process" aria-hidden="true">#</a> 8）process</h4><table><thead><tr><th>属性/方法</th><th>说明</th></tr></thead><tbody><tr><td><code>cwd()</code></td><td>返回当前 NodeJS 进程的工作目录<br>绝对路径</td></tr><tr><td><code>exit()</code></td><td>强制退出当前 Node 进程<br>可传入退出码，默认为 0，表示成功退出</td></tr><tr><td><code>argv</code></td><td>类型为 String[]<br>获取命令中的所有参数</td></tr><tr><td><code>platform</code></td><td>获取当前的操作系统</td></tr><tr><td><code>kill(pid)</code></td><td>根据进程 ID 杀死进程</td></tr><tr><td><code>env</code></td><td>获取环境变量对象</td></tr></tbody></table><h3 id="_3-node-的模块化细节" tabindex="-1"><a class="header-anchor" href="#_3-node-的模块化细节" aria-hidden="true">#</a> 3.Node 的模块化细节</h3><h4 id="_1-模块的查找" tabindex="-1"><a class="header-anchor" href="#_1-模块的查找" aria-hidden="true">#</a> 1）模块的查找</h4><ul><li>绝对路径 <ul><li>根据绝对路径直接加载模块</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;D:\\test\\index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>相对路径 <code>./</code> 或 <code>../</code><ul><li>相对于当前模块</li><li>转换为绝对路径</li><li>加载模块</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./index.js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>相对路径 <ul><li>检查是否是内置模块 <ul><li>如：fs、path 等</li></ul></li><li>检查当前目录中的 node_modules</li><li>检查上级目录中的 node_modules</li><li>转换为绝对路径</li><li>加载模块</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// node_modules/abc/index.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>关于后缀名 <ul><li>不提供后缀名，会自动补全</li><li><code>js</code>、<code>json</code>、<code>node</code>、<code>mjs</code></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>关于文件名 <ul><li>仅提供目录，不提供文件名 <ul><li>自动寻找该目录中的 index.js</li></ul></li><li>package.json 中的 main 字段 <ul><li>表示包的默认入口</li><li>导入或执行包时，仅提供目录 <ul><li>使用 main 字段值补全入口</li></ul></li><li>默认值为 index.js</li></ul></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// src/index.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-module-对象" tabindex="-1"><a class="header-anchor" href="#_2-module-对象" aria-hidden="true">#</a> 2）module 对象</h4><ul><li>记录当前模块的信息</li></ul><h4 id="_3-require-函数" tabindex="-1"><a class="header-anchor" href="#_3-require-函数" aria-hidden="true">#</a> 3）require 函数</h4><ul><li><code>require.resolve(&quot;./src&quot;);</code><ul><li>获得该目录的绝对路径</li><li>但是没有加载模块</li></ul></li></ul><div class="hint-container danger"><p class="hint-container-title">警告</p><ul><li>当执行一个模块或使用 require 函数时，会将模块放置在一个函数环境中（__temp）</li><li><code>this === module.exports === exports</code><ul><li>如果模块中对 <code>module.exports</code> 或 <code>exports</code> 重新赋值，则 this 指向变化</li></ul></li><li>require 函数最终返回的是 module.exports</li></ul></div><ul><li>myModule.js</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前模块的路径：&quot;</span><span class="token punctuation">,</span> __dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前模块的文件名：&quot;</span><span class="token punctuation">,</span> __filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 一开始 this === module.exports === exports</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>

<span class="token comment">// 重新赋值后 this !== module.exports &amp;&amp; this === exports</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>index.js 导入该模块</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// require内部运行机制伪代码</span>
<span class="token comment">// function require(modulePath) {</span>
<span class="token comment">//   // 1. 将modulePath转换为绝对路径：D:\repository\NodeJS\源码\myModule.js</span>
<span class="token comment">//   // 2. 判断是否该模块已有缓存</span>
<span class="token comment">//   if (require.cache[&quot;D:\\repository\\NodeJS\\源码\\myModule.js&quot;]) {</span>
<span class="token comment">//     return require.cache[&quot;D:\\repository\\NodeJS\\源码\\myModule.js&quot;].result;</span>
<span class="token comment">//   }</span>

<span class="token comment">//   // 3. 读取文件内容</span>
<span class="token comment">//   // 4. 包裹到一个函数中</span>
<span class="token comment">//   function __temp(module, exports, require, __dirname, __filename) {</span>
<span class="token comment">//     // 文件内容是动态变化的</span>
<span class="token comment">//     console.log(&quot;当前模块路径：&quot;, __dirname);</span>
<span class="token comment">//     console.log(&quot;当前模块文件：&quot;, __filename);</span>
<span class="token comment">//     exports.c = 3;</span>
<span class="token comment">//     module.exports = {</span>
<span class="token comment">//       a: 1,</span>
<span class="token comment">//       b: 2,</span>
<span class="token comment">//     };</span>
<span class="token comment">//     this.m = 5;</span>
<span class="token comment">//   }</span>

<span class="token comment">//   // 5. 创建module对象</span>
<span class="token comment">//   module.exports = {};</span>
<span class="token comment">//   const exports = module.exports;</span>

<span class="token comment">//   // 6.绑定this</span>
<span class="token comment">//   __temp.call(</span>
<span class="token comment">//     module.exports,</span>
<span class="token comment">//     module,</span>
<span class="token comment">//     exports,</span>
<span class="token comment">//     require,</span>
<span class="token comment">//     module.path,</span>
<span class="token comment">//     module.filename</span>
<span class="token comment">//   );</span>
<span class="token comment">//   return module.exports;</span>
<span class="token comment">// }</span>

<span class="token comment">// require.cache = {};</span>

<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;./myModule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-node-中的-es-模块化" tabindex="-1"><a class="header-anchor" href="#_4-node-中的-es-模块化" aria-hidden="true">#</a> 4.Node 中的 ES 模块化</h3><ul><li>目前，Node 中的 ES 模块化仍然处于试验阶段</li><li>模块化分为 commonjs 和 ES Module <ul><li>默认情况下指的都是 commonjs</li><li>ES Module 文件后缀名为 <code>.mjs</code><ul><li>新版本的 package.json 中 type 值是 &#39;module&#39;</li></ul></li></ul></li><li>当使用 ES 模块化运行时，必须添加 <code>--experimental-modules</code> 标记</li></ul><h3 id="_5-基本内置模块" tabindex="-1"><a class="header-anchor" href="#_5-基本内置模块" aria-hidden="true">#</a> 5.基本内置模块</h3><h4 id="_1-os" tabindex="-1"><a class="header-anchor" href="#_1-os" aria-hidden="true">#</a> 1）os</h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/os.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li><code>EOL</code></li><li><code>arch()</code></li><li><mark><code>cpus()</code></mark></li><li><code>freeman()</code></li><li><code>homedir()</code></li><li><code>hostname()</code></li><li><mark><code>tmpdir()</code></mark></li></ul><h4 id="_2-path" tabindex="-1"><a class="header-anchor" href="#_2-path" aria-hidden="true">#</a> 2）path</h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/path.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li><mark><code>basename</code></mark></li><li><code>sep</code></li><li><code>delimiter</code></li><li><mark><code>dirname</code></mark></li><li><mark><code>extname</code></mark></li><li><mark><code>join</code></mark></li><li><code>normalize</code></li><li><code>relative</code></li><li><mark><code>resolve</code></mark></li></ul><h4 id="_3-url" tabindex="-1"><a class="header-anchor" href="#_3-url" aria-hidden="true">#</a> 3）url</h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/url.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_4-util" tabindex="-1"><a class="header-anchor" href="#_4-util" aria-hidden="true">#</a> 4）util</h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/util.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li><code>callbackify</code></li><li><code>inherits</code></li><li><mark><code>isDeepStrictEqual</code></mark></li><li><mark><code>promisify</code></mark></li></ul><h3 id="_6-文件-i-o" tabindex="-1"><a class="header-anchor" href="#_6-文件-i-o" aria-hidden="true">#</a> 6.文件 I/O</h3><h4 id="_1-i-o-input-output" tabindex="-1"><a class="header-anchor" href="#_1-i-o-input-output" aria-hidden="true">#</a> 1）I/O input output</h4><ul><li>对外部设备的输入输出</li><li>外部设备：磁盘、网卡、显卡、打印机...</li><li>IO 的速度往往低于内存和 CPU 的交互速度</li></ul><h4 id="_2-fs-模块" tabindex="-1"><a class="header-anchor" href="#_2-fs-模块" aria-hidden="true">#</a> 2）fs 模块</h4><blockquote><p><a href="">官方文档</a></p></blockquote><ul><li><code>fs.readFile</code><ul><li>读取一个文件</li></ul></li><li><code>fs.writeFile</code><ul><li>向文件写入内容</li></ul></li><li><code>fs.stat</code><ul><li>获取文件或目录信息</li><li><code>size</code>：占用字节</li><li><code>atime</code>：上次访问时间</li><li><code>mtime</code>：上次文件内容被修改的时间</li><li><code>ctime</code>：上次文件状态被修改的时间</li><li><code>birthtime</code>：文件创建时间</li><li><code>isDirectory()</code>：判断是否是目录</li><li><code>isFile()</code>：判断是否是文件</li></ul></li><li><code>fs.readdir</code><ul><li>获取目录中的文件和子目录</li></ul></li><li><code>fs.mkdir</code><ul><li>创建目录</li></ul></li><li><code>fs.exists</code><ul><li>判断文件或目录是否存在</li></ul></li></ul><h4 id="_3-练习-读取一个目录中的所有子目录和文件" tabindex="-1"><a class="header-anchor" href="#_3-练习-读取一个目录中的所有子目录和文件" aria-hidden="true">#</a> 3）练习：读取一个目录中的所有子目录和文件</h4><ul><li>每个目录或文件都是一个对象</li></ul><table><thead><tr><th>属性/方法</th><th>说明</th></tr></thead><tbody><tr><td><code>name</code></td><td>文件名</td></tr><tr><td><code>ext</code></td><td>后缀名，如果是目录则为空字符串</td></tr><tr><td><code>isFile</code></td><td>是否是一个文件</td></tr><tr><td><code>size</code></td><td>文件大小</td></tr><tr><td><code>createTime</code></td><td>日期对象，创建的时间</td></tr><tr><td><code>updateTime</code></td><td>日期对象，修改的时间</td></tr><tr><td><code>getChildren()</code></td><td>得到目录的所有子文件对象，如果是文件则返回空数组</td></tr><tr><td><code>getContent(isBuffer = false)</code></td><td>读取文件内容，如果是目录则返回 null</td></tr></tbody></table><h3 id="_7-文件流" tabindex="-1"><a class="header-anchor" href="#_7-文件流" aria-hidden="true">#</a> 7.文件流</h3><h4 id="_1-流" tabindex="-1"><a class="header-anchor" href="#_1-流" aria-hidden="true">#</a> 1）流</h4><p><img src="/assets/Node06-fdab98a5.png" alt=""></p><ul><li>指数据的流动，数据从一个地方缓缓地流动到另一个地方</li><li>流是有方向的</li></ul><table><thead><tr><th>分类</th><th>说明</th></tr></thead><tbody><tr><td>可读流 Readable</td><td>数据从源头流向内存</td></tr><tr><td>可写流 Writable</td><td>数据从内存流向源头</td></tr><tr><td>双工流 Duplex</td><td>数据既可从源头流向内存，也可从内存流向源头</td></tr></tbody></table><h4 id="_2-流的作用" tabindex="-1"><a class="header-anchor" href="#_2-流的作用" aria-hidden="true">#</a> 2）流的作用</h4><ul><li>其他介质和内存的数据规模不一致</li></ul><p><img src="/assets/Node07-b7ef03c3.png" alt=""></p><ul><li>其他介质和内存的数据处理能力不一致</li></ul><p><img src="/assets/Node08-aecb989b.png" alt=""></p><h4 id="_3-文件流的含义" tabindex="-1"><a class="header-anchor" href="#_3-文件流的含义" aria-hidden="true">#</a> 3）文件流的含义</h4><ul><li>内存数据和磁盘文件数据之间的流动</li></ul><h4 id="_4-fs-createreadstream-path-options" tabindex="-1"><a class="header-anchor" href="#_4-fs-createreadstream-path-options" aria-hidden="true">#</a> 4）<code>fs.createReadStream(path[, options])</code></h4><ul><li>创建一个文件可读流，用于读取文件内容</li><li><code>path</code>：读取的文件路径</li><li><code>options</code>：可选配置</li></ul><table><thead><tr><th>配置项</th><th>含义</th></tr></thead><tbody><tr><td><code>encoding</code></td><td>编码方式</td></tr><tr><td><code>start</code></td><td>起始字节</td></tr><tr><td><code>end</code></td><td>结束字节</td></tr><tr><td><code>highWaterMark</code></td><td>每次读取数量<br>如果 encoding 有值，该数量表示一个字符数<br>如果 encoding 为 null，该数量表示字节数</td></tr></tbody></table><ul><li>返回值：Readable 的子类 ReadStream <ul><li><code>rs.pause()</code>：暂停读取，会触发 pause 事件</li><li><code>rs.resume()</code>：恢复读取，会触发 resume 事件</li><li><code>rs.on(事件名, 处理函数)</code></li></ul></li></ul><table><thead><tr><th>事件名</th><th>含义</th></tr></thead><tbody><tr><td><code>open</code></td><td>文件打开事件<br>文件被打开后触发</td></tr><tr><td><code>error</code></td><td>发生错误时触发</td></tr><tr><td><code>close</code></td><td>文件被关闭后触发<br>可通过 <code>rs.close()</code> 手动关闭<br>或文件读取完成后自动关闭（ <code>autoClose</code> 配置项默认值为 true）</td></tr><tr><td><code>data</code></td><td>读取到一部分数据后触发<br>注册该事件后才会真正开始读取<br>每次读取 <code>highWaterMark</code> 配置项指定的数量<br>回调函数中会附带读取到的数据<br>若指定了编码，则读取到的数据会自动按照编码转换为字符串<br>若没有指定编码，则读取到的数据是 Buffer 类型</td></tr><tr><td><code>end</code></td><td>所有数据读取完毕后触发</td></tr></tbody></table><h4 id="_5-fs-createwritestream-path-options" tabindex="-1"><a class="header-anchor" href="#_5-fs-createwritestream-path-options" aria-hidden="true">#</a> 5）<code>fs.createWriteStream(path[, options])</code></h4><ul><li>创建一个写入流</li><li><code>path</code>：写入的文件路径</li><li><code>options</code>：可选配置</li></ul><table><thead><tr><th>配置项</th><th>含义</th></tr></thead><tbody><tr><td><code>flags</code></td><td>操作文件的方式：<br><code>w</code>（覆盖）、<code>a</code>（追加）、其他</td></tr><tr><td><code>encoding</code></td><td>编码方式</td></tr><tr><td><code>start</code></td><td>起始字节</td></tr><tr><td><code>highWaterMark</code></td><td>每次最多写入的字节数</td></tr></tbody></table><ul><li>返回值：Writable 的子类 WriteStream <ul><li><code>ws.on(事件名, 处理函数)</code><ul><li><code>open</code></li><li><code>error</code></li><li><code>close</code></li></ul></li><li><code>ws.end([data])</code><ul><li>结束写入，将自动关闭文件 <ul><li>是否自动关闭取决于 <code>autoClose</code> 配置，默认为 true</li></ul></li><li>data 是可选的 <ul><li>表示关闭前的最后一次写入</li></ul></li></ul></li><li><code>ws.write(data)</code><ul><li>写入一组数据</li><li>data 可以是字符串或 Buffer</li><li>返回一个 Boolean 值 <ul><li>true：写入通道没有被填满，接下来的数据可以直接写入，无需排队（下图一）</li><li>false：写入通道目前已被填满，接下来的数据将进入写入队列（下图二） <ul><li>特别注意背压问题，因为写入队列是内存中的数据 —— 有限</li></ul></li></ul></li><li>当写入队列清空时，会触发 <code>drain</code> 事件</li></ul></li></ul></li></ul><p><img src="/assets/Node09-4d092654.png" alt=""></p><p><img src="/assets/Node10-d8f1f7d3.png" alt=""></p><h4 id="_6-rs-pipe-ws" tabindex="-1"><a class="header-anchor" href="#_6-rs-pipe-ws" aria-hidden="true">#</a> 6）<code>rs.pipe(ws)</code></h4><ul><li>将可读流连接到可写流</li><li>返回参数的值</li><li>该方法可解决背压问题</li></ul><h3 id="_8-net-模块" tabindex="-1"><a class="header-anchor" href="#_8-net-模块" aria-hidden="true">#</a> 8.net 模块</h3><h4 id="_1-回顾-http-请求" tabindex="-1"><a class="header-anchor" href="#_1-回顾-http-请求" aria-hidden="true">#</a> 1）回顾 HTTP 请求</h4><ul><li>普通模式</li></ul><p><img src="/assets/Node11-994da085.png" alt=""></p><ul><li>长连接模式</li></ul><p><img src="/assets/Node12-e5d42dd2.png" alt=""></p><h4 id="_2-作用" tabindex="-1"><a class="header-anchor" href="#_2-作用" aria-hidden="true">#</a> 2）作用</h4><ul><li>net 是一个通信模块</li><li>可以实现进程间的通信 IPC</li><li>可以实现 <mark>网络通信 TCP/IP</mark></li></ul><h4 id="_3-创建客户端" tabindex="-1"><a class="header-anchor" href="#_3-创建客户端" aria-hidden="true">#</a> 3）创建客户端</h4><ul><li><code>net.createConnection(options[, connectListener])</code></li><li>返回： <code>socket</code> 对象 <ul><li>一个特殊的文件</li><li>在 node 中表现为一个双工流对象</li><li>通过向流写入内容发送数据</li><li>通过监听流的内容获取数据</li></ul></li></ul><p><img src="/assets/Node13-902b65fd.png" alt=""></p><h4 id="_4-创建服务器" tabindex="-1"><a class="header-anchor" href="#_4-创建服务器" aria-hidden="true">#</a> 4）创建服务器</h4><ul><li><code>net.createServer()</code></li><li>返回： <code>server</code> 对象 <ul><li><code>server.listen(port)</code>：监听当前计算机中的某个端口</li><li><code>server.on(&quot;listening&quot;, () =&gt; {})</code>：开始监听端口后触发的事件</li><li><code>server.on(&quot;connection&quot;, socket =&gt; {})</code>：当某个连接到来时触发该事件，监听函数会获得一个 socket 对象</li></ul></li></ul><p><img src="/assets/Node14-5d062b40.png" alt=""></p><h3 id="_9-http-模块" tabindex="-1"><a class="header-anchor" href="#_9-http-模块" aria-hidden="true">#</a> 9.http 模块</h3><h4 id="_1-建立在-net-模块上" tabindex="-1"><a class="header-anchor" href="#_1-建立在-net-模块上" aria-hidden="true">#</a> 1）建立在 net 模块上</h4><ul><li>无需手动管理 socket</li><li>无需手动组装消息格式</li></ul><h4 id="_2-http-request-url-options-callback" tabindex="-1"><a class="header-anchor" href="#_2-http-request-url-options-callback" aria-hidden="true">#</a> 2）<code>http.request(url[, options][, callback])</code></h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/http.html#http_http_request_url_options_callback" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_3-http-createserver-options-requestlistener" tabindex="-1"><a class="header-anchor" href="#_3-http-createserver-options-requestlistener" aria-hidden="true">#</a> 3）<code>http.createServer([options][, requestListener])</code></h4><blockquote><p><a href="https://nodejs.org/dist/latest-v12.x/docs/api/http.html#http_http_createserver_options_requestlistener" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_4-总结" tabindex="-1"><a class="header-anchor" href="#_4-总结" aria-hidden="true">#</a> 4）总结</h4><ul><li>客户端 <ul><li>请求： <code>ClientRequest</code> 对象</li><li>响应： <code>IncomingMessage</code> 对象</li></ul></li><li>服务器 <ul><li>请求： <code>IncomingMessage</code> 对象</li><li>响应： <code>ServerResponse</code> 对象</li></ul></li></ul><h3 id="_10-https-协议" tabindex="-1"><a class="header-anchor" href="#_10-https-协议" aria-hidden="true">#</a> 10.https 协议</h3><p><img src="/assets/Node15-a757a204.png" alt=""></p><p><img src="/assets/Node16-6911c983.png" alt=""></p><h4 id="_1-对称加密" tabindex="-1"><a class="header-anchor" href="#_1-对称加密" aria-hidden="true">#</a> 1）对称加密</h4><ul><li>加密过程</li></ul><p><img src="/assets/Node17-09321b37.png" alt=""></p><ul><li>解密过程</li></ul><p><img src="/assets/Node18-cce96e30.png" alt=""></p><ul><li>产生 <mark>一个</mark> 密钥</li><li>可以用其加密，也可以用其解密</li><li>常用算法：DES、3DES、AES、Blowfish 等</li></ul><p><img src="/assets/Node19-711ed9a3.png" alt=""></p><p><img src="/assets/Node20-d2415744.png" alt=""></p><h4 id="_2-非对称加密" tabindex="-1"><a class="header-anchor" href="#_2-非对称加密" aria-hidden="true">#</a> 2）非对称加密</h4><ul><li>加密过程</li></ul><p><img src="/assets/Node21-4b07ae29.png" alt=""></p><ul><li>解密过程</li></ul><p><img src="/assets/Node22-74890bb5.png" alt=""></p><ul><li>产生 <mark>一对</mark> 密钥</li><li>一个用于加密，一个用于解密</li><li>常用算法：RSA、Elgamal、Rabin、D-H、ECC 等</li></ul><p><img src="/assets/Node23-e9817a9c.png" alt=""></p><p><img src="/assets/Node24-8a9db469.png" alt=""></p><h4 id="_3-证书颁发机构" tabindex="-1"><a class="header-anchor" href="#_3-证书颁发机构" aria-hidden="true">#</a> 3）证书颁发机构</h4><ul><li>CA, Certificate Authority</li></ul><h4 id="_4-证书颁发流程" tabindex="-1"><a class="header-anchor" href="#_4-证书颁发流程" aria-hidden="true">#</a> 4）证书颁发流程</h4><p><img src="/assets/Node25-5790dc1c.png" alt=""></p><h4 id="_5-证书" tabindex="-1"><a class="header-anchor" href="#_5-证书" aria-hidden="true">#</a> 5）证书</h4><ul><li>DC, Digital Certificate</li><li>证书中的服务器公钥和证书签名是通过 CA 的私钥加密的</li><li>其他终端只能通过 CA 的公钥解密读取，无法重新加密伪造</li></ul><p><img src="/assets/Node26-c28e80c1.png" alt=""></p><h4 id="_6-证书签名" tabindex="-1"><a class="header-anchor" href="#_6-证书签名" aria-hidden="true">#</a> 6）证书签名</h4><ul><li>Signature</li><li>证书签名的算法是公开的</li><li>使得每一个拿到证书的终端都可以验证签名是否被篡改</li></ul><p><img src="/assets/Node27-80f8f3e1.png" alt=""></p><h4 id="_7-证书验证流程" tabindex="-1"><a class="header-anchor" href="#_7-证书验证流程" aria-hidden="true">#</a> 7）证书验证流程</h4><ul><li>浏览器获取证书</li></ul><p><img src="/assets/Node28-229cc4d4.png" alt=""></p><ul><li>无法被篡改</li></ul><p><img src="/assets/Node29-bc01fda3.png" alt=""></p><ul><li>通信双方正常通信</li></ul><p><img src="/assets/Node30-f09db638.png" alt=""></p><ul><li>第三方无法查看和篡改</li></ul><p><img src="/assets/Node31-0d057e86.png" alt=""></p><h4 id="_8-协议" tabindex="-1"><a class="header-anchor" href="#_8-协议" aria-hidden="true">#</a> 8）协议</h4><p><img src="/assets/Node32-b8fd9fe6.png" alt=""></p><ul><li>浏览器希望，在通过 https 协议请求到的网页中，其他资源都应该使用 https 协议获取</li><li>服务器：申请证书</li><li>客户端：访问时使用 <code>https://xxx</code></li><li>https 协议的默认端口号是 443</li></ul><h3 id="_11-https-模块" tabindex="-1"><a class="header-anchor" href="#_11-https-模块" aria-hidden="true">#</a> 11.https 模块</h3><h4 id="_1-服务器结构" tabindex="-1"><a class="header-anchor" href="#_1-服务器结构" aria-hidden="true">#</a> 1）服务器结构</h4><p><img src="/assets/Node33-485fa294.png" alt=""></p><p><img src="/assets/Node34-41800682.png" alt=""></p><h4 id="_2-证书准备方式-1-网上购买权威机构证书" tabindex="-1"><a class="header-anchor" href="#_2-证书准备方式-1-网上购买权威机构证书" aria-hidden="true">#</a> 2）证书准备方式 1：网上购买权威机构证书</h4><blockquote><p><a href="https://www.aliyun.com/?utm_content=se_1000301881" target="_blank" rel="noopener noreferrer">阿里云<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>准备好资金、服务器、域名</li><li>该方式应用在部署环境中</li></ul><h4 id="_3-证书准备方式-2-本地产生证书" tabindex="-1"><a class="header-anchor" href="#_3-证书准备方式-2-本地产生证书" aria-hidden="true">#</a> 3）证书准备方式 2：本地产生证书</h4><ul><li>开发者作为权威机构发布证书</li><li>安装 openssl <ul><li><a href="https://github.com/openssl/openssl" target="_blank" rel="noopener noreferrer">下载源码，自行构建<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://slproweb.com/products/Win32OpenSSL.html" target="_blank" rel="noopener noreferrer">下载 Windows 安装包<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>Mac 自带</li><li>通过输入命令 openssl 测试</li></ul></li><li>生成 CA 私钥 <ul><li><code>genrsa</code><ul><li>密钥对生成算法</li></ul></li><li><code>-des3</code><ul><li>使用对称加密算法 des3 对私钥进一步加密</li><li>命令运行过程中会让用户输入密码，该密码将作为 des3 算法的 key</li></ul></li><li><code>-out ca-pri-key.pem</code><ul><li>将加密后的私钥保存到当前目录的 <code>ca-pri-key.pem</code> 文件中</li><li>pem, Privacy-Enhanced Mail(PEM)</li></ul></li><li><code>1024</code><ul><li>私钥的字节数</li></ul></li></ul></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl genrsa <span class="token parameter variable">-des3</span> <span class="token parameter variable">-out</span> ca-pri-key.pem <span class="token number">1024</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>生成 CA 公钥（证书请求） <ul><li>通过私钥文件 <code>ca-pri-key.pem</code> 中的内容，生成对应的公钥，保存到 <code>ca-pub-key.pem</code> 文件中</li><li>运行过程中要使用之前输入的密码来实现对私钥文件的解密</li><li>其他输入信息 <ul><li><code>Country Name</code>：国家名 CN</li><li><code>Province Name</code>：省份名 Guangdong</li><li><code>Local Name</code>：城市名</li><li><code>Company Name</code>：公司名</li><li><code>Unit Name</code>：部门名</li><li><code>Common Name</code>：站点名</li><li>...</li></ul></li></ul></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl req <span class="token parameter variable">-new</span> <span class="token parameter variable">-key</span> ca-pri-key.pem <span class="token parameter variable">-out</span> ca-pub-key.pem
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>生成 CA 证书 <ul><li>使用 X.509 证书标准</li><li>通过证书请求文件 <code>ca-pub-key.pem</code> 生成证书</li><li>使用私钥 <code>ca-pri-key.pem</code> 加密</li><li>将证书保存到 <code>ca-cert.crt</code> 文件中</li></ul></li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl x509 <span class="token parameter variable">-req</span> <span class="token parameter variable">-in</span> ca-pub-key.pem <span class="token parameter variable">-signkey</span> ca-pri-key.pem <span class="token parameter variable">-out</span> ca-cert.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>生成服务器私钥</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl genrsa <span class="token parameter variable">-out</span> server-key.pem <span class="token number">1024</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>生成服务器公钥</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl req <span class="token parameter variable">-new</span> <span class="token parameter variable">-key</span> server-key.pem <span class="token parameter variable">-out</span> server-scr.pem
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>生成服务器证书</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>openssl x509 <span class="token parameter variable">-req</span> <span class="token parameter variable">-CA</span> ca-cert.crt <span class="token parameter variable">-CAkey</span> ca-pri-key.pem <span class="token parameter variable">-CAcreateserial</span> <span class="token parameter variable">-in</span> server-scr.pem <span class="token parameter variable">-out</span> server-cert.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_4-https-模块" tabindex="-1"><a class="header-anchor" href="#_4-https-模块" aria-hidden="true">#</a> 4）https 模块</h4><h3 id="_12-node-的生命周期" tabindex="-1"><a class="header-anchor" href="#_12-node-的生命周期" aria-hidden="true">#</a> 12.Node 的生命周期</h3><p><img src="/assets/Node35-8375ac6b.png" alt=""></p><h4 id="_1-timers" tabindex="-1"><a class="header-anchor" href="#_1-timers" aria-hidden="true">#</a> 1）timers</h4><ul><li>存放计时器的回调函数</li></ul><h4 id="_2-poll" tabindex="-1"><a class="header-anchor" href="#_2-poll" aria-hidden="true">#</a> 2）poll</h4><ul><li>轮训队列</li><li>除了 timers 和 check，绝大部分回调都会被放入该队列</li><li>如：文件的读取、监听用户请求</li><li>如果 poll 中有回调 <ul><li>依次执行回调，直到清空队列</li></ul></li><li>如果 poll 中没有回调 <ul><li>等待其他队列中出现回调，结束该阶段，进入下一阶段</li><li>如果其他队列也没有出现回调，持续等待，直到出现回调为止</li></ul></li></ul><h4 id="_3-check" tabindex="-1"><a class="header-anchor" href="#_3-check" aria-hidden="true">#</a> 3）check</h4><ul><li>检查阶段</li><li>使用 <code>setImmediate</code> 的回调会直接进入该队列</li></ul><div class="hint-container danger"><p class="hint-container-title">警告</p><p>在事件循环中，每次执行一个回调之前，都必须先清空 <code>nextTick</code> 和 <code>promise</code> 队列</p></div><h3 id="_13-eventemitter" tabindex="-1"><a class="header-anchor" href="#_13-eventemitter" aria-hidden="true">#</a> 13.EventEmitter</h3><h4 id="_1-node-事件管理的通用机制" tabindex="-1"><a class="header-anchor" href="#_1-node-事件管理的通用机制" aria-hidden="true">#</a> 1）Node 事件管理的通用机制</h4><h4 id="_2-内部维护多个事件队列" tabindex="-1"><a class="header-anchor" href="#_2-内部维护多个事件队列" aria-hidden="true">#</a> 2）内部维护多个事件队列</h4><h2 id="二-mysql" tabindex="-1"><a class="header-anchor" href="#二-mysql" aria-hidden="true">#</a> （二）MySQL</h2><blockquote><p><a href="https://www.runoob.com/mysql/mysql-tutorial.html" target="_blank" rel="noopener noreferrer">菜鸟教程<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_1-数据库简介" tabindex="-1"><a class="header-anchor" href="#_1-数据库简介" aria-hidden="true">#</a> 1.数据库简介</h3><h4 id="_1-作用" tabindex="-1"><a class="header-anchor" href="#_1-作用" aria-hidden="true">#</a> 1）作用</h4><ul><li>持久的存储数据 <ul><li>数据存储在硬盘文件中</li></ul></li><li>备份和恢复数据</li><li>快速地存取数据</li><li>权限控制</li></ul><h4 id="_2-类型" tabindex="-1"><a class="header-anchor" href="#_2-类型" aria-hidden="true">#</a> 2）类型</h4><ul><li>关系型数据库</li></ul><table><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td>特点</td><td>以表和表的关联构成的数据结构</td></tr><tr><td>优点</td><td>能表达复杂的数据关系<br>强大的查询语言，能精确查找想要的数据</td></tr><tr><td>缺点</td><td>读写性能较差，尤其是海量数据的读写<br>数据结构比较死板</td></tr><tr><td>用途</td><td>存储结构复杂的数据</td></tr><tr><td>代表</td><td>Oracle、MySQL、SQL Server</td></tr></tbody></table><ul><li>非关系型数据库</li></ul><table><thead><tr><th>项目</th><th>说明</th></tr></thead><tbody><tr><td>特点</td><td>以极其简单的结构存储数据<br>文档型<br>键值对</td></tr><tr><td>优点</td><td>格式灵活<br>海量数据读写效率很高</td></tr><tr><td>缺点</td><td>难以表示复杂的数据结构<br>对于复杂查询效率低</td></tr><tr><td>用途</td><td>存储结构简单的数据</td></tr><tr><td>代表</td><td>MongoDB、Redis、MemBase</td></tr></tbody></table><ul><li>面向对象数据库</li></ul><h4 id="_3-术语" tabindex="-1"><a class="header-anchor" href="#_3-术语" aria-hidden="true">#</a> 3）术语</h4><table><thead><tr><th>缩写</th><th>全称</th><th>含义</th></tr></thead><tbody><tr><td>DB</td><td>Database</td><td>数据库</td></tr><tr><td>DBA</td><td>Database Administrator</td><td>数据库管理员</td></tr><tr><td>DBMS</td><td>Database Management System</td><td>数据库管理系统</td></tr><tr><td>DBS</td><td>Database System</td><td>数据库系统<br>DBS 包含 DB、DBA、DBMS</td></tr></tbody></table><h3 id="_2-安装-mysql" tabindex="-1"><a class="header-anchor" href="#_2-安装-mysql" aria-hidden="true">#</a> 2.安装 MySQL</h3><h4 id="_1-mysql-特点" tabindex="-1"><a class="header-anchor" href="#_1-mysql-特点" aria-hidden="true">#</a> 1）MySQL 特点</h4><ul><li>关系型数据库</li><li>瑞典 MySQL AB <ul><li>已被 Oracle 收购</li></ul></li><li>开源</li><li>轻量</li><li>快速</li></ul><h4 id="_2-下载" tabindex="-1"><a class="header-anchor" href="#_2-下载" aria-hidden="true">#</a> 2）下载</h4><ul><li><a href="https://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener noreferrer">官方下载源<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://pc.qq.com/detail/3/detail_1303.html" target="_blank" rel="noopener noreferrer">腾讯下载源<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h4 id="_3-使用" tabindex="-1"><a class="header-anchor" href="#_3-使用" aria-hidden="true">#</a> 3）使用</h4><ul><li>进入 mysql 命令交互</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">-uroot</span> <span class="token parameter variable">-p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查看当前数据库字符编码</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>show variables like <span class="token string">&#39;character\_set\_%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>修改 <code>my.ini</code> 文件中的默认字符编码</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\ProgramData\MySQL\MySQL Server 8.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>停止 MySQL</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>net stop mysql80
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>启动 MySQL</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>net start mysql80
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查看当前拥有的数据库</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>show databases
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_4-可视化工具" tabindex="-1"><a class="header-anchor" href="#_4-可视化工具" aria-hidden="true">#</a> 4）可视化工具</h4><ul><li>Navicat</li></ul><h3 id="_3-数据库设计" tabindex="-1"><a class="header-anchor" href="#_3-数据库设计" aria-hidden="true">#</a> 3.数据库设计</h3><h4 id="_1-sql" tabindex="-1"><a class="header-anchor" href="#_1-sql" aria-hidden="true">#</a> 1）SQL</h4><ul><li>Structured Query Language 结构化查询语言</li><li>大部分关系型数据库都拥有基本一致的 SQL 语法</li></ul><table><thead><tr><th>分支</th><th>全称</th><th>操作对象</th></tr></thead><tbody><tr><td>DDL</td><td>Data Definition Language 数据定义语言</td><td>数据库对象（库、表、视图、存储过程）</td></tr><tr><td>DML</td><td>Data Manipulation Language 数据操控语言</td><td>数据库中的记录</td></tr><tr><td>DCL</td><td>Data Control Language 数据控制语句</td><td>用户权限</td></tr></tbody></table><h4 id="_2-管理库" tabindex="-1"><a class="header-anchor" href="#_2-管理库" aria-hidden="true">#</a> 2）管理库</h4><ul><li>创建库</li><li>切换当前库</li><li>删除库</li></ul><h4 id="_3-管理表" tabindex="-1"><a class="header-anchor" href="#_3-管理表" aria-hidden="true">#</a> 3）管理表</h4><ul><li>创建表 <ul><li>字段 <ul><li>字段名</li><li>字段类型</li><li>是否为 null</li><li>是否自增</li><li>默认值</li></ul></li></ul></li></ul><table><thead><tr><th>字段类型</th><th>含义</th></tr></thead><tbody><tr><td><code>bit</code></td><td>占 1 位，0 或 1，true 或 false</td></tr><tr><td><code>int</code></td><td>占 32 位，整数</td></tr><tr><td><code>decimal(M, N)</code></td><td>能精确计算的实数<br>M 是总的数字位数，N 是小数位数</td></tr><tr><td><code>char(n)</code></td><td>固定长度位 n 的字符</td></tr><tr><td><code>varchar(n)</code></td><td>长度可变，最大长度位 n 的字符</td></tr><tr><td><code>text</code></td><td>大量的字符</td></tr><tr><td><code>date</code></td><td>仅日期</td></tr><tr><td><code>datetime</code></td><td>日期和时间</td></tr><tr><td><code>time</code></td><td>仅时间</td></tr></tbody></table><ul><li>修改表</li><li>删除表</li></ul><h4 id="_4-主键和外键" tabindex="-1"><a class="header-anchor" href="#_4-主键和外键" aria-hidden="true">#</a> 4）主键和外键</h4><ul><li>主键 <ul><li>根据设计原则，每张表都要有主键</li><li>主键必须满足以下要求 <ul><li>唯一</li><li>不可更改</li><li>无业务含义</li></ul></li></ul></li><li>外键 <ul><li>用于产生表关系的列</li><li>外键列会连接到另一张表（或自己）的主键</li></ul></li></ul><h4 id="_5-表关系" tabindex="-1"><a class="header-anchor" href="#_5-表关系" aria-hidden="true">#</a> 5）表关系</h4><ul><li>一对一 <ul><li>一个 A 对应一个 B，一个 B 对应一个 A <ul><li>如：用户和用户信息</li></ul></li><li>把任意一张表的主键同时设置为外键</li></ul></li><li>一对多 <ul><li>一个 A 对应多个 B，一个 B 对应一个 A，A 和 B 是一对多，B 和 A 是多对一 <ul><li>如：班级和学生、用户和文章</li></ul></li><li>在多一端的表上设置外键，对应到另一张表的主键</li></ul></li><li>多对多 <ul><li>一个 A 对应多个 B，一个 B 对应多个 A <ul><li>如：学生和老师</li></ul></li><li>需要新建一张关系表，关系表至少包含两个外键，分别对应到两张表</li></ul></li></ul><h4 id="_6-三大设计范式" tabindex="-1"><a class="header-anchor" href="#_6-三大设计范式" aria-hidden="true">#</a> 6）三大设计范式</h4><ul><li>要求数据库表的每一列都是不可分割的原子数据项</li><li>非主键列必须依赖于主键列</li><li>非主键列必须直接依赖于主键列</li></ul><h3 id="_4-表记录的增删改查-crud" tabindex="-1"><a class="header-anchor" href="#_4-表记录的增删改查-crud" aria-hidden="true">#</a> 4.表记录的增删改查（CRUD）</h3><ul><li>DML，Data Manipulation Language，数据操控语言</li></ul><h4 id="_1-增-create" tabindex="-1"><a class="header-anchor" href="#_1-增-create" aria-hidden="true">#</a> 1）增 CREATE</h4><h4 id="_2-查-retrieve" tabindex="-1"><a class="header-anchor" href="#_2-查-retrieve" aria-hidden="true">#</a> 2）查 Retrieve</h4><h4 id="_3-改-update" tabindex="-1"><a class="header-anchor" href="#_3-改-update" aria-hidden="true">#</a> 3）改 UPDATE</h4><h4 id="_4-删-delete" tabindex="-1"><a class="header-anchor" href="#_4-删-delete" aria-hidden="true">#</a> 4）删 DELETE</h4><h3 id="_5-单表基本查询" tabindex="-1"><a class="header-anchor" href="#_5-单表基本查询" aria-hidden="true">#</a> 5.单表基本查询</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> XXX <span class="token keyword">from</span> XXX <span class="token keyword">where</span> XXX <span class="token keyword">order</span> <span class="token keyword">by</span> XXX <span class="token keyword">limit</span> XXX<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_1-select" tabindex="-1"><a class="header-anchor" href="#_1-select" aria-hidden="true">#</a> 1）select</h4><ul><li>别名</li><li><code>*</code></li><li><code>case</code></li><li><code>distinct</code></li></ul><h4 id="_2-from" tabindex="-1"><a class="header-anchor" href="#_2-from" aria-hidden="true">#</a> 2）from</h4><h4 id="_3-where" tabindex="-1"><a class="header-anchor" href="#_3-where" aria-hidden="true">#</a> 3）where</h4><ul><li><code>=</code></li><li><code>in</code></li><li><code>is</code></li><li><code>is not</code></li><li><code>&gt;</code>、<code>&lt;</code>、<code>&gt;=</code>、<code>&lt;=</code></li><li><code>between</code></li><li><code>like</code></li><li><code>and</code></li><li><code>or</code></li></ul><h4 id="_4-order-by" tabindex="-1"><a class="header-anchor" href="#_4-order-by" aria-hidden="true">#</a> 4）order by</h4><ul><li><code>asc</code></li><li><code>desc</code></li></ul><h4 id="_5-limit" tabindex="-1"><a class="header-anchor" href="#_5-limit" aria-hidden="true">#</a> 5）limit</h4><ul><li><code>n, m</code><ul><li>跳过 n 条数据，取出 m 条数据</li></ul></li></ul><h4 id="_6-运行顺序" tabindex="-1"><a class="header-anchor" href="#_6-运行顺序" aria-hidden="true">#</a> 6）运行顺序</h4><ul><li><code>from</code> =&gt; <code>where</code> =&gt; <code>select</code> =&gt; <code>order by</code> =&gt; <code>limit</code></li></ul><h3 id="_6-联表查询" tabindex="-1"><a class="header-anchor" href="#_6-联表查询" aria-hidden="true">#</a> 6.联表查询</h3><h4 id="_1-笛卡尔积" tabindex="-1"><a class="header-anchor" href="#_1-笛卡尔积" aria-hidden="true">#</a> 1）笛卡尔积</h4><h4 id="_2-左连接" tabindex="-1"><a class="header-anchor" href="#_2-左连接" aria-hidden="true">#</a> 2）左连接</h4><ul><li>又叫左外连接，left join</li></ul><h4 id="_3-右连接" tabindex="-1"><a class="header-anchor" href="#_3-右连接" aria-hidden="true">#</a> 3）右连接</h4><ul><li>又叫右外连接，right join</li></ul><h4 id="_4-内连接" tabindex="-1"><a class="header-anchor" href="#_4-内连接" aria-hidden="true">#</a> 4）内连接</h4><ul><li>inner join</li></ul><h3 id="_7-函数和分组" tabindex="-1"><a class="header-anchor" href="#_7-函数和分组" aria-hidden="true">#</a> 7.函数和分组</h3><h4 id="_1-内置函数" tabindex="-1"><a class="header-anchor" href="#_1-内置函数" aria-hidden="true">#</a> 1）内置函数</h4><ul><li>数学函数</li></ul><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td><code>ABS(x)</code></td><td>返回 x 的绝对值</td></tr><tr><td><code>CEILINC(x)</code></td><td>返回大于 x 的最小整数值</td></tr><tr><td><code>FLOOR(X)</code></td><td>返回小于 x 的最大整数值</td></tr><tr><td><code>MOD(x, y)</code></td><td>返回 x/y 的模（余数）</td></tr><tr><td><code>PI()</code></td><td>返回 pi 的值（圆周率）</td></tr><tr><td><code>RAND()</code></td><td>返回 0 到 1 内的随机值</td></tr><tr><td><code>ROUND(x, y)</code></td><td>返回参数 x 的四舍五入的有 y 位小数的值</td></tr><tr><td><code>TRUNCATE(x, y)</code></td><td>返回数字 x 截短为 y 位小数的结果</td></tr></tbody></table><ul><li>聚合函数</li></ul><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td><code>AVC(col)</code></td><td>返回指定列的平均值</td></tr><tr><td><code>COUNT(col)</code></td><td>返回指定列中非 NULL 值的个数</td></tr><tr><td><code>MIN(col)</code></td><td>返回指定列的最小值</td></tr><tr><td><code>MAX(col)</code></td><td>返回指定列的最大值</td></tr><tr><td><code>SUM(col)</code></td><td>返回指定列的所有值之和</td></tr></tbody></table><ul><li>字符函数</li></ul><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td><code>CONCAT(s1, s2, ..., sn)</code></td><td>将 s1, s2, ..., sn 连接成字符串</td></tr><tr><td><code>CONCAT_WS(sep, s1, s2, ..., sn)</code></td><td>将 s1, s2, ..., sn 连接成字符串，并用 sep 字符作间隔</td></tr><tr><td><code>TRIM(str)</code></td><td>去除字符串首部和尾部的所有空格</td></tr><tr><td><code>LTRIM(str)</code></td><td>从字符串 str 中去除首部的空格</td></tr><tr><td><code>RTRIM(str)</code></td><td>从字符串 str 中去除尾部的空格</td></tr></tbody></table><ul><li>日期函数</li></ul><table><thead><tr><th>函数名</th><th>说明</th></tr></thead><tbody><tr><td><code>CURDATE()</code> 或 <code>CURRENT_DATE()</code></td><td>返回当前的日期</td></tr><tr><td><code>CURTIME()</code> 或 <code>CURRENT_TIME()</code></td><td>返回当前的时间</td></tr><tr><td><code>TIMESTAMPDIFF(part, date1, date2)</code></td><td>返回 date1 到 date2 之间相隔的 part 值<br>part 用于指定的相隔的年或月或日等<br>part 取值：MICROSECOND、SECOND、MINUTE、HOUR、DAY、WEEK、MONTH、QUARTER、YEAR</td></tr></tbody></table><h4 id="_2-自定义函数" tabindex="-1"><a class="header-anchor" href="#_2-自定义函数" aria-hidden="true">#</a> 2）自定义函数</h4><h4 id="_3-分组" tabindex="-1"><a class="header-anchor" href="#_3-分组" aria-hidden="true">#</a> 3）分组</h4><ul><li>运行顺序 <ul><li><code>from</code> =&gt; <code>join...on...</code> =&gt; <code>where</code> =&gt; <code>group by</code> =&gt; <code>select</code> =&gt; <code>having</code> =&gt; <code>order by</code> =&gt; <code>limit</code></li></ul></li><li>分组后只能查询分组的列和聚合列</li></ul><h3 id="_8-视图" tabindex="-1"><a class="header-anchor" href="#_8-视图" aria-hidden="true">#</a> 8.视图</h3><ul><li>操作视图属于 DDL</li></ul><h2 id="三-数据驱动和-orm" tabindex="-1"><a class="header-anchor" href="#三-数据驱动和-orm" aria-hidden="true">#</a> （三）数据驱动和 ORM</h2><h3 id="_1-mysql-驱动程序" tabindex="-1"><a class="header-anchor" href="#_1-mysql-驱动程序" aria-hidden="true">#</a> 1.MySQL 驱动程序</h3><h4 id="_1-驱动程序" tabindex="-1"><a class="header-anchor" href="#_1-驱动程序" aria-hidden="true">#</a> 1）驱动程序</h4><ul><li>是连接内存和其他存储介质的桥梁</li><li>MySQL 驱动程序是连接内存数据和 MySQL 数据的桥梁</li><li>MySQL 驱动程序通常使用 <ul><li>MySQL</li><li>MySQL2 <ul><li>MySQL-Native</li></ul></li></ul></li></ul><h4 id="_2-使用-mysql2" tabindex="-1"><a class="header-anchor" href="#_2-使用-mysql2" aria-hidden="true">#</a> 2）使用 MySQL2</h4><blockquote><p><a href="https://github.com/sidorares/node-mysql2#readme" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_3-防止-sql-注入" tabindex="-1"><a class="header-anchor" href="#_3-防止-sql-注入" aria-hidden="true">#</a> 3）防止 SQL 注入</h4><ul><li>SQL 注入 <ul><li>用户通过注入 SQL 语句到最终查询中，导致整个 SQL 与预期行为不符</li></ul></li><li>MySQL 支持变量 <ul><li>变量的内容不作为任何 SQL 关键字</li></ul></li></ul><h3 id="_2-sequelize-简介" tabindex="-1"><a class="header-anchor" href="#_2-sequelize-简介" aria-hidden="true">#</a> 2.Sequelize 简介</h3><blockquote><p><a href="https://github.com/demopark/sequelize-docs-Zh-CN" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_1-orm" tabindex="-1"><a class="header-anchor" href="#_1-orm" aria-hidden="true">#</a> 1）ORM</h4><ul><li>Object Relational Mapping 对象关系映射</li><li>通过 ORM 框架，可以自动地把程序中的对象和数据库关联</li><li>ORM 框架会隐藏具体的数据库底层细节，让开发者使用同样的数据操作接口，完成对不同数据库的操作</li><li>优势 <ul><li>开发者无需关系数据库，仅需关心对象</li><li>可轻易地完成数据库的移植</li><li>无需拼接复杂的 SQL 语句，即可完成精确查询</li></ul></li></ul><p><img src="/assets/Node36-ffdb55d0.png" alt=""></p><h4 id="_2-node-中的-orm" tabindex="-1"><a class="header-anchor" href="#_2-node-中的-orm" aria-hidden="true">#</a> 2）Node 中的 ORM</h4><ul><li>Sequelize <ul><li>JS</li><li>TS</li><li>成熟</li></ul></li><li>TypeORM <ul><li>TS</li><li>不成熟</li></ul></li></ul><h4 id="_3-三层架构" tabindex="-1"><a class="header-anchor" href="#_3-三层架构" aria-hidden="true">#</a> 3）三层架构</h4><p><img src="/assets/Node37-bd029f9e.png" alt=""></p><h3 id="_3-模型定义和同步" tabindex="-1"><a class="header-anchor" href="#_3-模型定义和同步" aria-hidden="true">#</a> 3.模型定义和同步</h3><ul><li>案例：学校数据库 <ul><li>管理员：id、账号、密码、姓名</li><li>班级：id、名称、开班时间</li><li>学生：id、姓名、出生日期、性别、联系电话、所属班级</li><li>书籍：id、名称、图片、出版时间、作者</li></ul></li></ul><h3 id="_4-模型的增删改" tabindex="-1"><a class="header-anchor" href="#_4-模型的增删改" aria-hidden="true">#</a> 4.模型的增删改</h3><h3 id="_5-模拟数据" tabindex="-1"><a class="header-anchor" href="#_5-模拟数据" aria-hidden="true">#</a> 5.模拟数据</h3><blockquote><p><a href="http://mockjs.com/" target="_blank" rel="noopener noreferrer">MockJS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_6-数据抓取" tabindex="-1"><a class="header-anchor" href="#_6-数据抓取" aria-hidden="true">#</a> 6.数据抓取</h3><h4 id="_1-抓取豆瓣读书中的书籍信息" tabindex="-1"><a class="header-anchor" href="#_1-抓取豆瓣读书中的书籍信息" aria-hidden="true">#</a> 1）抓取豆瓣读书中的书籍信息</h4><ul><li><a href="https://book.douban.com/latest" target="_blank" rel="noopener noreferrer">豆瓣读书<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h4 id="_2-涉及的库" tabindex="-1"><a class="header-anchor" href="#_2-涉及的库" aria-hidden="true">#</a> 2）涉及的库</h4><ul><li><a href="https://github.com/axios/axios" target="_blank" rel="noopener noreferrer">Axios<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>发送一个 http 请求，得到服务器的响应结果</li><li>客户端和服务器通用</li></ul></li><li><a href="https://github.com/cheeriojs/cheerio#readme" target="_blank" rel="noopener noreferrer">Cheerio<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>JQuery 的核心库</li><li>与 DOM 无关</li></ul></li></ul><h3 id="_7-数据查询" tabindex="-1"><a class="header-anchor" href="#_7-数据查询" aria-hidden="true">#</a> 7.数据查询</h3><table><thead><tr><th>API</th><th>说明</th></tr></thead><tbody><tr><td><code>findOne</code></td><td>查询单条数据</td></tr><tr><td><code>findByPK</code></td><td>根据主键查询单条数据</td></tr><tr><td><code>findAll</code></td><td>查询多条数据</td></tr><tr><td><code>count</code></td><td>查询数量</td></tr><tr><td><code>include</code></td><td>查询包含关系</td></tr></tbody></table><h3 id="_8-md5-加密" tabindex="-1"><a class="header-anchor" href="#_8-md5-加密" aria-hidden="true">#</a> 8.MD5 加密</h3><blockquote><p><a href="https://www.npmjs.com/package/md5" target="_blank" rel="noopener noreferrer">NPM 包地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>hash 加密算法的一种</li><li>可以将任何一个字符串加密成一个固定长度的字符串</li><li>单向加密：只能加密无法解密</li><li>同样的源字符串加密后得到的结果固定</li></ul><h3 id="_9-moment" tabindex="-1"><a class="header-anchor" href="#_9-moment" aria-hidden="true">#</a> 9.moment</h3><blockquote><p><a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><br><p><a href="http://momentjs.cn/" target="_blank" rel="noopener noreferrer">民间中文网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_1-utc" tabindex="-1"><a class="header-anchor" href="#_1-utc" aria-hidden="true">#</a> 1）UTC</h4><ul><li>世界协调时</li><li>以英国格林威治时间为标准</li><li>UTC 时间和北京时间相差 8 小时</li><li>UTC 的凌晨相当于北京时间的上午 8 时</li></ul><h4 id="_2-时间戳-timestamp" tabindex="-1"><a class="header-anchor" href="#_2-时间戳-timestamp" aria-hidden="true">#</a> 2）时间戳 timestamp</h4><ul><li>某个 UTC 时间到 UTC1970-1-1 凌晨经过的毫秒数 <ul><li>也可以是秒数，用小数部分记录毫秒</li></ul></li><li>时间戳表示的是 UTC 时间的差异</li></ul><h4 id="_3-对于服务器的影响" tabindex="-1"><a class="header-anchor" href="#_3-对于服务器的影响" aria-hidden="true">#</a> 3）对于服务器的影响</h4><ul><li>服务器可能会部署到世界的任何位置</li><li>服务器内部应该统一使用 UTC 时间或时间戳，包括数据库</li></ul><h4 id="_4-对于客户端的影响" tabindex="-1"><a class="header-anchor" href="#_4-对于客户端的影响" aria-hidden="true">#</a> 4）对于客户端的影响</h4><ul><li>客户端要给不同地区的客户友好的时间显示</li><li>客户端应该把 UTC 时间或时间戳转换为本地时间</li></ul><p><img src="/assets/Node38-db314c95.png" alt=""></p><h3 id="_10-数据验证" tabindex="-1"><a class="header-anchor" href="#_10-数据验证" aria-hidden="true">#</a> 10.数据验证</h3><h4 id="_1-作用-1" tabindex="-1"><a class="header-anchor" href="#_1-作用-1" aria-hidden="true">#</a> 1）作用</h4><table><thead><tr><th>位置</th><th>作用</th></tr></thead><tbody><tr><td>前端（客户端）</td><td>优化用户体验</td></tr><tr><td>路由层</td><td>验证接口格式是否正常</td></tr><tr><td>业务逻辑层</td><td>保证业务完整性</td></tr><tr><td>数据库验证（约束）</td><td>保证数据完整性</td></tr></tbody></table><h4 id="_2-相关库" tabindex="-1"><a class="header-anchor" href="#_2-相关库" aria-hidden="true">#</a> 2）相关库</h4><ul><li><a href="https://github.com/validatorjs/validator.js" target="_blank" rel="noopener noreferrer">Validator<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>用于验证某个字符串是否满足某个规则</li></ul></li><li><a href="http://validatejs.org/" target="_blank" rel="noopener noreferrer">Validate.js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><ul><li>用于验证某个对象的属性是否满足某些规则</li></ul></li></ul><h3 id="_11-访问器和虚拟字段" tabindex="-1"><a class="header-anchor" href="#_11-访问器和虚拟字段" aria-hidden="true">#</a> 11.访问器和虚拟字段</h3><h3 id="_12-日志记录" tabindex="-1"><a class="header-anchor" href="#_12-日志记录" aria-hidden="true">#</a> 12.日志记录</h3><ul><li><a href="https://log4js-node.github.io/log4js-node/" target="_blank" rel="noopener noreferrer">log4js<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h4 id="_1-日志级别-level" tabindex="-1"><a class="header-anchor" href="#_1-日志级别-level" aria-hidden="true">#</a> 1）日志级别 level</h4><ul><li>如：调试日志、信息日志、错误日志等</li></ul><p><img src="/assets/Node39-53a5785e.png" alt=""></p><h4 id="_2-日志分类-category" tabindex="-1"><a class="header-anchor" href="#_2-日志分类-category" aria-hidden="true">#</a> 2）日志分类 category</h4><ul><li>如：SQL 日志、请求日志等</li></ul><h4 id="_3-日志出口-appender" tabindex="-1"><a class="header-anchor" href="#_3-日志出口-appender" aria-hidden="true">#</a> 3）日志出口 appender</h4><ul><li>应该把日志写到哪里</li><li>日志的书写格式是什么（layouts）</li></ul><h2 id="四-express" tabindex="-1"><a class="header-anchor" href="#四-express" aria-hidden="true">#</a> （四）Express</h2><h3 id="_1-express-的基本使用" tabindex="-1"><a class="header-anchor" href="#_1-express-的基本使用" aria-hidden="true">#</a> 1.Express 的基本使用</h3><blockquote><p><a href="http://expressjs.com/" target="_blank" rel="noopener noreferrer">官方文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><br><p><a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer">民间中文网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_2-nodemon" tabindex="-1"><a class="header-anchor" href="#_2-nodemon" aria-hidden="true">#</a> 2.nodemon</h3><blockquote><p><a href="https://github.com/remy/nodemon#nodemon" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><ul><li>nodemon 是一个监视器</li><li>用于监控工程中的文件变化</li><li>如果发现文件有变化，可以执行一段脚本</li></ul><h3 id="_3-express-中间件" tabindex="-1"><a class="header-anchor" href="#_3-express-中间件" aria-hidden="true">#</a> 3.Express 中间件</h3><h4 id="_1-匹配到请求后" tabindex="-1"><a class="header-anchor" href="#_1-匹配到请求后" aria-hidden="true">#</a> 1）匹配到请求后</h4><ul><li>交给第一个处理函数处理</li><li>函数中需要手动地交给后续中间件处理</li></ul><h4 id="_2-中间件处理的细节" tabindex="-1"><a class="header-anchor" href="#_2-中间件处理的细节" aria-hidden="true">#</a> 2）中间件处理的细节</h4><ul><li>如果后续已经没有中间件 <ul><li>express 如果发现响应没有结束，则响应 404</li></ul></li><li>如果中间件发生错误 <ul><li>服务器不会停止</li><li>相当于调用了 <code>next(错误对象)</code></li><li>寻找后续的错误处理中间件 <ul><li>如果没有，则响应 500</li></ul></li></ul></li></ul><h3 id="_4-常用中间件" tabindex="-1"><a class="header-anchor" href="#_4-常用中间件" aria-hidden="true">#</a> 4.常用中间件</h3><h4 id="_1-express-static" tabindex="-1"><a class="header-anchor" href="#_1-express-static" aria-hidden="true">#</a> 1）<code>express.static()</code></h4><h4 id="_2-express-json" tabindex="-1"><a class="header-anchor" href="#_2-express-json" aria-hidden="true">#</a> 2）<code>express.json()</code></h4><h4 id="_3-express-urlencoded" tabindex="-1"><a class="header-anchor" href="#_3-express-urlencoded" aria-hidden="true">#</a> 3）<code>express.urlencoded()</code></h4><h3 id="_5-express-路由" tabindex="-1"><a class="header-anchor" href="#_5-express-路由" aria-hidden="true">#</a> 5.Express 路由</h3><h3 id="_6-cookie" tabindex="-1"><a class="header-anchor" href="#_6-cookie" aria-hidden="true">#</a> 6.Cookie</h3><h4 id="_1-一个不大不小的问题" tabindex="-1"><a class="header-anchor" href="#_1-一个不大不小的问题" aria-hidden="true">#</a> 1）一个不大不小的问题</h4><ul><li>假设服务器有一个接口，通过请求这个接口，可以添加一个管理员 <ul><li>但是，不是任何人都有权力做这种操作的</li><li>那么服务器如何知道请求接口的人是有权力的呢？</li></ul></li><li>答案是：只有登录过的管理员才能做这种操作</li><li>可问题是，客户端和服务器的传输使用的是 http 协议 <ul><li><mark>http 协议是无状态的</mark></li><li>无状态，就是服务器不知道这一次请求的人，跟之前登录请求成功的人是不是同一个人</li></ul></li></ul><p><img src="/assets/Node40-57e3897c.png" alt=""></p><p><img src="/assets/Node41-1ec7c709.png" alt=""></p><ul><li>由于 http 协议的无状态，服务器忘记了之前的所有请求</li><li>无法确定这一次请求的客户端，就是之前登录成功的那个客户端</li><li>于是，服务器想了一个办法，按照下面的流程来认证客户端的身份 <ul><li>客户端登录成功后，服务器会给客户端一个出入证（令牌 token）</li><li>后续客户端的每次请求，都必须要附带这个出入证（令牌 token）</li></ul></li></ul><p><img src="/assets/Node42-0849f709.png" alt=""></p><ul><li>服务器发扬了认证不认人的优良传统，就可以很轻松的识别身份了</li><li>但是，用户不可能只在一个网站登录，于是客户端会收到来自各个网站的出入证</li><li>因此，就要求客户端要有一个类似于卡包的东西，能够具备下面的功能： <ul><li><mark>能够存放多个出入证</mark><ul><li>这些出入证来自不同的网站</li><li>也可能是一个网站有多个出入证，分别用于出入不同的地方</li></ul></li><li><mark>能够自动出示出入证</mark><ul><li>客户端在访问不同的网站时，能够自动的把对应的出入证附带请求发送出去</li></ul></li><li><mark>正确的出示出入证</mark><ul><li>客户端不能将肯德基的出入证发送给麦当劳</li></ul></li><li><mark>管理出入证的有效期</mark><ul><li>客户端要能够自动的发现那些已经过期的出入证，并把它从卡包内移除</li></ul></li></ul></li><li>能够满足上面所有要求的，就是 cookie</li><li>cookie 类似于一个卡包，专门用于存放各种出入证，并有着一套机制来自动管理这些证件</li><li>卡包内的每一张卡片，称之为 <mark>一个 cookie</mark></li></ul><h4 id="_2-cookie-的组成" tabindex="-1"><a class="header-anchor" href="#_2-cookie-的组成" aria-hidden="true">#</a> 2）Cookie 的组成</h4><blockquote><p>cookie 是浏览器中特有的一个概念，就像浏览器的专属卡包，管理着各个网站的身份信息</p><br><p>每个 cookie 就相当于是属于某个网站的一个卡片</p><br><p>当浏览器向服务器发送一个请求的时候，会瞄一眼自己的卡包，看看哪些卡片适合附带捎给服务器</p></blockquote><table><thead><tr><th>属性</th><th>说明</th></tr></thead><tbody><tr><td>key</td><td>键</td></tr><tr><td>value</td><td>值，可以是任何信息</td></tr><tr><td>domain</td><td>域，表示这个 cookie 属于哪个网站</td></tr><tr><td>path</td><td>路径，表示这个 cookie 属于该网站的哪个基路径</td></tr><tr><td>secure</td><td>是否使用安全传输</td></tr><tr><td>expire</td><td>过期时间，表示该 cookie 在什么时候过期</td></tr></tbody></table><ul><li>如果一个 cookie <mark>同时满足</mark> 以下条件，则这个 cookie 会自动被浏览器附带到请求中 <ul><li>cookie 没有过期</li><li>cookie 中的域和这次请求的域是匹配的 <ul><li>如：cookie 中的域是 <code>yuanjin.tech</code>，则可以匹配的请求域是 <code>yuanjin.tech</code> 、 <code>www.yuanjin.tech</code> 、 <code>blogs.yuanjin.tech</code> 等等</li><li>如：cookie 中的域是 <code>www.yuanjin.tech</code>，则只能匹配 <code>www.yuanjin.tech</code> 这样的请求域</li><li>cookie 不关心端口，只要域匹配即可</li></ul></li><li>cookie 中的 path 和这次请求的 path 是匹配的 <ul><li><code>path: &#39;/news&#39;</code>，则匹配的请求路径可以是 <code>/news</code> 、 <code>/news/detail</code> 、 <code>/news/a/b/c</code> 等等，但不能匹配 <code>/blogs</code></li><li><code>path: &#39;/&#39;</code>，则能够匹配所有的路径</li></ul></li><li>验证 cookie 的安全传输 <ul><li><code>secure: true</code>，则请求协议必须是 <code>https</code>，否则不会发送该 cookie</li><li><code>secure: false</code>，则请求协议可以是 <code>http</code>，也可以是 <code>https</code></li></ul></li></ul></li><li>浏览器会将符合条件的 cookie，自动放置到请求头中 <ul><li>如：当在浏览器中访问百度的时候，在请求头中附带了下面的 cookie：</li></ul></li></ul><p><img src="/assets/Node43-f16313f6.png" alt=""></p><ul><li>打马赛克的地方就是通过请求头 <code>cookie</code> 发送到服务器的</li><li>格式： <code>键=值; 键=值; 键=值; ...</code></li><li>每一个键值对就是一个符合条件的 cookie</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>cookie 中包含了重要的身份信息，永远不要把 cookie 泄露给别人</p></div><h4 id="_3-设置-cookie" tabindex="-1"><a class="header-anchor" href="#_3-设置-cookie" aria-hidden="true">#</a> 3）设置 Cookie</h4><ul><li>由于 cookie 是保存在浏览器端的，同时，很多证件又是服务器颁发的</li><li>所以，cookie 的设置有两种模式： <ul><li>服务器响应 <ul><li>这种模式非常普遍</li><li>当服务器决定给客户端颁发一个证件时，会在响应的消息中包含 cookie</li><li>浏览器会自动的把 cookie 保存到卡包中</li></ul></li><li>客户端自行设置 <ul><li>这种模式少见一些，不过也有可能会发生</li><li>如：用户关闭了某个广告，并选择了「以后不要再弹出」</li><li>此时就可以把这种小信息直接通过浏览器的 JS 代码保存到 cookie 中</li><li>后续请求服务器时，服务器会看到客户端不想要再次弹出广告的 cookie，于是就不会再发送广告过来了</li></ul></li></ul></li></ul><h4 id="_4-服务器端设置-cookie" tabindex="-1"><a class="header-anchor" href="#_4-服务器端设置-cookie" aria-hidden="true">#</a> 4）服务器端设置 Cookie</h4><ul><li>服务器可以通过设置响应头，告诉浏览器应该如何设置 cookie</li><li>响应头按照下面的格式设置：</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie1
<span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie2
<span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> cookie3
<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>通过这种模式，就可以在一次响应中设置多个 cookie</li><li>其中，每个 cookie 的格式如下：</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>键=值; path=<span class="token punctuation">?</span>; domain=<span class="token punctuation">?</span>; expire=<span class="token punctuation">?</span>; max<span class="token punctuation">-</span>age=<span class="token punctuation">?</span>; secure; httponly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>每个 cookie 除了键值对必须设置，其他属性都是可选的，并且顺序不限</li><li>当这样的响应头到达客户端后，<mark>浏览器会自动的将 cookie 保存到卡包中，如果卡包中已经存在一模一样的卡片（其他 key、path、domain 相同），则会自动的覆盖之前的设置</mark></li></ul><table><thead><tr><th>属性</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td><code>path</code></td><td>设置 cookie 的路径<br>如果不设置，浏览器会将其自动设置为当前请求的路径</td><td>浏览器请求的地址是 <code>/login</code><br>服务器响应了 <code>set-cookie: a=1</code><br>浏览器会将该 cookie 的 path 设置为请求的路径 <code>/login</code></td></tr><tr><td><code>domain</code></td><td>设置 cookie 的域<br>如果不设置，浏览器会自动将其设置为当前的请求域<br>如果服务器响应了一个无效的域，浏览器是不认的</td><td>浏览器请求的地址是 <code>http://www.yuanjin.tech</code><br>服务器响应了 <code>set-cookie: a=1</code><br>浏览器会将该 cookie 的 domain 设置为请求的域 <code>www.yuanjin.tech</code></td></tr><tr><td><code>expire</code></td><td>设置 cookie 的过期时间<br>必须是一个有效的 GMT 时间，即格林威治标准时间字符串</td><td><code>Fri, 17 Apr 2020 09:35:59 GMT</code> 表示格林威治时间 <code>2020-04-17 09:35:59</code><br>即北京时间 <code>2020-04-17 17:35:59</code><br>当客户端的时间达到这个时间点后，会自动销毁该 cookie</td></tr><tr><td><code>max-age</code></td><td>设置 cookie 的相对有效期<br>expire 和 max-age 通常仅设置一个即可</td><td>设置<code>max-age</code> 为 <code>1000</code><br>浏览器在添加 cookie 时，会自动设置 <code>expire</code> 为当前时间加上 1000 秒作为过期时间<br>如果不设置 expire，又没有设置 max-age，则表示会话结束后过期<br>对于大部分浏览器而言，关闭所有浏览器窗口意味着会话结束</td></tr><tr><td><code>secure</code></td><td>设置 cookie 是否是安全连接<br>如果设置了该值，则表示该 cookie 后续只能随着 <code>https</code> 请求发送<br>如果不设置，则表示该 cookie 会随着所有请求发送</td><td></td></tr><tr><td><code>httponly</code></td><td>设置 cookie 是否仅能用于传输<br>如果设置了该值，则表示该 cookie 仅能用于传输<br>而不允许在客户端通过 JS 获取，有利于防止跨站脚本攻击（XSS）</td><td></td></tr></tbody></table><div class="hint-container info"><p class="hint-container-title">无效的域</p><ul><li>响应的域连根域都不一样</li><li>如：浏览器请求的域是 <code>yuanjin.tech</code>，服务器响应的 cookie 是 <code>set-cookie: a=1; domain=baidu.com</code>，这样的域浏览器是不认的</li><li>如果浏览器连这样的情况都允许，就意味着张三的服务器，有权利给用户一个 cookie，用于访问李四的服务器，这会造成很多安全性的问题</li></ul></div><h4 id="_5-应用示例" tabindex="-1"><a class="header-anchor" href="#_5-应用示例" aria-hidden="true">#</a> 5）应用示例</h4><ul><li>客户端通过 <code>post</code> 请求服务器 <code>http://yuanjin.tech/login</code></li><li>并在消息体中给予了账号和密码</li><li>服务器验证登录成功后，在响应头中加入了以下内容：</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">set-cookie</span><span class="token punctuation">:</span> token=123456; path=/; max<span class="token punctuation">-</span>age=3600; httponly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>当该响应到达浏览器后，浏览器会创建下面的 cookie</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">key</span><span class="token punctuation">:</span> token
<span class="token key atrule">value</span><span class="token punctuation">:</span> <span class="token number">123456</span>
<span class="token key atrule">domain</span><span class="token punctuation">:</span> yuanjin.tech
<span class="token key atrule">path</span><span class="token punctuation">:</span> /
<span class="token key atrule">expire</span><span class="token punctuation">:</span> <span class="token datetime number">2020-04-17 18:55:00</span> <span class="token comment"># 假设当前时间是2020-04-17 17:55:00</span>
<span class="token key atrule">secure</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 任何请求都可以附带这个cookie，只要满足其他要求</span>
<span class="token key atrule">httponly</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 不允许JS获取该cookie</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>随着浏览器后续对服务器的请求，只要满足要求，这个 cookie 就会被附带到请求头中传给服务器</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">cookie</span><span class="token punctuation">:</span> token=123456; 其他cookie<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_6-删除浏览器的一个-cookie" tabindex="-1"><a class="header-anchor" href="#_6-删除浏览器的一个-cookie" aria-hidden="true">#</a> 6）删除浏览器的一个 cookie</h4><ul><li>只需要让服务器响应一个同样的域、同样的路径、同样的 key，只是时间过期的 cookie 即可</li><li><mark>删除 cookie 其实就是修改 cookie</mark></li><li>下面的响应会让浏览器删除 <code>token</code></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">cookie</span><span class="token punctuation">:</span> token=; domain=yuanjin.tech; path=/; max<span class="token punctuation">-</span>age=<span class="token punctuation">-</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>浏览器按照要求修改了 cookie 后，会发现 cookie 已经过期，自然就会删除了</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><ul><li>无论是修改还是删除，都要注意 cookie 的域和路径</li><li>因为完全可能存在域或路径不同，但 key 相同的 cookie</li><li>因此无法仅通过 key 确定是哪一个 cookie</li></ul></div><h4 id="_7-客户端设置-cookie" tabindex="-1"><a class="header-anchor" href="#_7-客户端设置-cookie" aria-hidden="true">#</a> 7）客户端设置 Cookie</h4><ul><li>cookie 是存放在浏览器端的</li><li>所以浏览器向 JS 开放了接口，让其可以设置 cookie</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">&quot;键=值; path=?; domain=?; expire=?; max-age=?; secure&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在客户端设置 cookie 和服务器设置 cookie 的格式一样 <ul><li><mark>没有 httponly</mark><ul><li>httponly 本来就是为了限制在客户端访问的</li></ul></li><li><mark>path 的默认值</mark><ul><li>在服务器端设置 cookie 时，如果没有写 path，使用的是请求的 path</li><li>在客户端设置 cookie 时，也许根本没有请求发生</li><li>因此，path 在客户端设置时的默认值是 <mark>当前网页的 path</mark></li></ul></li><li>domain 的默认值 <ul><li>和 path 同理，客户端设置时的默认值是 <mark>当前网页的 domain</mark></li></ul></li></ul></li><li>删除 cookie <ul><li>和服务器一样，修改 cookie 的过期时间即可</li></ul></li></ul><h4 id="_8-将-cookie-用于登录场景" tabindex="-1"><a class="header-anchor" href="#_8-将-cookie-用于登录场景" aria-hidden="true">#</a> 8）将 Cookie 用于登录场景</h4><ul><li>登录请求 <ul><li>浏览器发送请求到服务器，附带账号密码</li><li>服务器验证账号密码是否正确 <ul><li>如果不正确，响应错误</li><li>如果正确，在响应头中设置 cookie，附带登录认证信息（如：JWT）</li></ul></li><li>客户端收到 cookie，浏览器自动记录下来</li></ul></li><li>后续请求 <ul><li>浏览器发送请求到服务器，希望添加一个管理员，并将 cookie 自动附带到请求中</li><li>服务器先获取 cookie，验证 cookie 中的信息是否正确 <ul><li>如果不正确，不予以操作</li><li>如果正确，完成正常的业务流程</li></ul></li></ul></li></ul><h3 id="_7-实现登录和认证" tabindex="-1"><a class="header-anchor" href="#_7-实现登录和认证" aria-hidden="true">#</a> 7.实现登录和认证</h3><h4 id="_1-使用-cookie-parser" tabindex="-1"><a class="header-anchor" href="#_1-使用-cookie-parser" aria-hidden="true">#</a> 1）使用 cookie-parser</h4><blockquote><p><a href="https://github.com/expressjs/cookie-parser#readme" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_2-登录成功后给予-token" tabindex="-1"><a class="header-anchor" href="#_2-登录成功后给予-token" aria-hidden="true">#</a> 2）登录成功后给予 token</h4><ul><li>通过 cookie 给予 <ul><li>适配浏览器</li></ul></li><li>通过 header 给予 <ul><li>适配其他终端</li></ul></li></ul><h4 id="_3-对后续请求进行认证" tabindex="-1"><a class="header-anchor" href="#_3-对后续请求进行认证" aria-hidden="true">#</a> 3）对后续请求进行认证</h4><ul><li>解析 cookie 或 header 中的 token</li><li>验证 token <ul><li>通过，继续后续处理</li><li>未通过，给予错误</li></ul></li></ul><h3 id="_8-断点调试" tabindex="-1"><a class="header-anchor" href="#_8-断点调试" aria-hidden="true">#</a> 8.断点调试</h3><ul><li>启动模块</li><li>node 进程会监听 9229 端口</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">node</span> <span class="token parameter variable">--inspect</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_9-跨域-——-jsonp" tabindex="-1"><a class="header-anchor" href="#_9-跨域-——-jsonp" aria-hidden="true">#</a> 9.跨域 —— JSONP</h3><h4 id="_1-同源策略" tabindex="-1"><a class="header-anchor" href="#_1-同源策略" aria-hidden="true">#</a> 1）同源策略</h4><ul><li>同源，协议、端口、主机名完全相同</li><li>浏览器不允许使用非同源的数据</li></ul><h4 id="_2-解决方案" tabindex="-1"><a class="header-anchor" href="#_2-解决方案" aria-hidden="true">#</a> 2）解决方案</h4><ul><li>JSONP</li><li>CORS</li></ul><h4 id="_3-jsonp" tabindex="-1"><a class="header-anchor" href="#_3-jsonp" aria-hidden="true">#</a> 3）JSONP</h4><ul><li>浏览器端生成一个 script 元素，访问数据接口</li><li>服务器响应一段 JS 代码，调用某个函数，并把响应的数据传入</li></ul><h4 id="_4-缺陷" tabindex="-1"><a class="header-anchor" href="#_4-缺陷" aria-hidden="true">#</a> 4）缺陷</h4><ul><li>会严重影响服务器的正常响应格式 <ul><li>JSONP 要求服务器响应一段 JS 代码</li><li>但在非跨域的情况下，服务器又需要响应一个正常的 JSON 格式</li></ul></li><li>只能使用 GET 请求 <ul><li><code>script</code> 元素发出的请求只能是 <code>GET</code> 请求</li></ul></li></ul><h3 id="_10-跨域-——-cors" tabindex="-1"><a class="header-anchor" href="#_10-跨域-——-cors" aria-hidden="true">#</a> 10.跨域 —— CORS</h3><ul><li><code>CORS</code> 是基于 <code>http1.1</code> 的一种跨域解决方案</li><li>Cross-Origin Resource Sharing 跨域资源共享</li><li><mark>如果浏览器要跨域访问服务器的资源，需要获得服务器的允许</mark></li></ul><h4 id="_1-交互模式" tabindex="-1"><a class="header-anchor" href="#_1-交互模式" aria-hidden="true">#</a> 1）交互模式</h4><ul><li>一个请求可以附带很多信息，从而会对服务器造成不同程度的影响</li><li>如：有的请求只是获取一些新闻，有的请求会改动服务器的数据</li><li>针对不同的请求，CORS 规定了三种不同的交互模式 <ul><li>简单请求</li><li>需要预检的请求</li><li>附带身份凭证的请求</li></ul></li><li>这三种模式从上到下层层递进 <ul><li>请求可以做的事越来越多，要求也越来越严格</li></ul></li><li>当浏览器端运行了一段 Ajax 代码 <ul><li>无论是使用 XMLHttpRequest 还是 Fetch API</li><li>浏览器会首先判断它属于哪一种请求模式</li></ul></li></ul><h4 id="_2-简单请求的判定" tabindex="-1"><a class="header-anchor" href="#_2-简单请求的判定" aria-hidden="true">#</a> 2）简单请求的判定</h4><ul><li>当请求 <mark>同时满足</mark> 以下条件时，浏览器会认为是一个简单请求</li></ul><table><thead><tr><th>条件</th><th>取值</th></tr></thead><tbody><tr><td>请求方法</td><td>GET<br>POST<br>HEAD</td></tr><tr><td>请求头仅包含安全的字段</td><td><code>Accept</code><br><code>Accept-Language</code><br><code>Content-Language</code><br><code>Content-Type</code><br><code>DPR</code><br><code>Downlink</code><br><code>Save-Data</code><br><code>Viewport-Width</code><br><code>Width</code></td></tr><tr><td>请求头如果包含 <code>Content-Type</code></td><td><code>text/plain</code><br><code>multipart/form-data</code><br><code>application/x-www-form-urlencoded</code></td></tr></tbody></table><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 请求方法不满足要求，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 加入了额外的请求头，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// content-type不满足要求，不是简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-简单请求的交互规范" tabindex="-1"><a class="header-anchor" href="#_3-简单请求的交互规范" aria-hidden="true">#</a> 3）简单请求的交互规范</h4><ul><li>当浏览器判定某个 ajax 跨域请求是简单请求时</li><li>请求头中会自动添加 <code>Origin</code> 字段</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 在页面 `http://my.com/index.html` 中有以下代码造成了跨域</span>
<span class="token comment">// 简单请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># 请求头</span>
GET /api/news/ HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive
<span class="token punctuation">...</span>
<span class="token key atrule">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com/index.html
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com <span class="token comment"># 告诉服务器是哪个源地址在跨域请求</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>服务器响应头中应包含 <code>Access-Control-Allow-Origin</code><ul><li><code>*</code>：表示允许所有源地址跨域访问</li><li>具体的源：如：<code>http://my.com</code> 表示仅允许该源地址跨域访问</li></ul></li></ul><div class="hint-container info"><p class="hint-container-title">相关信息</p><ul><li>实际上，这两个值对于客户端 <code>http://my.com</code> 而言都一样 <ul><li>因为客户端才不会管其他源服务器允不允许，就关心自己是否被允许</li></ul></li><li>当然，服务器也可以维护一个可被允许的源列表 <ul><li>如果请求的 <code>Origin</code> 命中该列表，就响应 <code>*</code> 或具体的源</li></ul></li><li>为了避免后续的麻烦，强烈推荐响应具体的源</li></ul></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Tue<span class="token punctuation">,</span> 21 Apr 2020 08<span class="token punctuation">:</span>03<span class="token punctuation">:</span>35 GMT
<span class="token punctuation">...</span>
<span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token punctuation">...</span>

消息体中的数据
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/Node44-6858658c.png" alt=""></p><h4 id="_4-需要预检的请求" tabindex="-1"><a class="header-anchor" href="#_4-需要预检的请求" aria-hidden="true">#</a> 4）需要预检的请求</h4><ul><li>简单的请求对服务器的威胁不大，所以允许使用上述的简单交互即可完成</li><li>但是如果浏览器不认为这是一种简单请求，就会按照下面的流程进行 <ul><li>浏览器发送预检请求，询问服务器是否允许</li><li>服务器允许</li><li>浏览器发送真实请求</li><li>服务器完成真实的响应</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 在页面 `http://my.com/index.html` 中有以下代码造成了跨域</span>
<span class="token comment">// 需要预检的请求</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://crossdomain.com/api/user&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token comment">// post 请求</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置请求头</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;content-type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;袁小进&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 设置请求体</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-预检请求的交互规范" tabindex="-1"><a class="header-anchor" href="#_5-预检请求的交互规范" aria-hidden="true">#</a> 5）预检请求的交互规范</h4><ul><li>浏览器发送预检请求，询问服务器是否允许 <ul><li>这并非要发出的真实请求，请求中不包含响应头，也没有消息体</li><li>这是一个预检请求，目的是询问服务器，是否允许后续的真实请求</li><li>预检请求 <mark>没有请求体</mark>，包含了后续真实请求要做的事情 <ul><li>请求方法为<code>OPTIONS</code></li><li>没有请求体</li><li>请求头中包含 <ul><li><code>Origin</code>：请求的源，和简单请求的含义一致</li><li><code>Access-Control-Request-Method</code>：后续的真实请求将使用的请求方法</li><li><code>Access-Control-Request-Headers</code>：后续的真实请求会改动的请求头</li></ul></li></ul></li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>OPTIONS /api/user HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token punctuation">...</span>
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token key atrule">Access-Control-Request-Method</span><span class="token punctuation">:</span> POST
<span class="token key atrule">Access-Control-Request-Headers</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> content<span class="token punctuation">-</span>type
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>服务器允许 <ul><li>服务器收到预检请求后，可以检查预检请求中包含的信息</li><li>如果允许这样的请求，需要响应下面的消息格式</li><li>对于预检请求，不需要响应任何的消息体，只需要在响应头中添加： <ul><li><code>Access-Control-Allow-Origin</code>：和简单请求一样，表示允许的源</li><li><code>Access-Control-Allow-Methods</code>：表示允许的后续真实的请求方法</li><li><code>Access-Control-Allow-Headers</code>：表示允许改动的请求头</li><li><code>Access-Control-Max-Age</code>：告诉浏览器，多少秒内，对于同样的请求源、方法、头，都不需要再发送预检请求了</li></ul></li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Tue<span class="token punctuation">,</span> 21 Apr 2020 08<span class="token punctuation">:</span>03<span class="token punctuation">:</span>35 GMT
<span class="token punctuation">...</span>
<span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token key atrule">Access-Control-Allow-Methods</span><span class="token punctuation">:</span> POST
<span class="token key atrule">Access-Control-Allow-Headers</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> content<span class="token punctuation">-</span>type
<span class="token key atrule">Access-Control-Max-Age</span><span class="token punctuation">:</span> <span class="token number">86400</span>
<span class="token punctuation">...</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>浏览器发送真实请求 <ul><li>预检被服务器允许后，浏览器就会发送真实请求了</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>POST /api/user HTTP/1.1
<span class="token key atrule">Host</span><span class="token punctuation">:</span> crossdomain.com
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive
<span class="token punctuation">...</span>
<span class="token key atrule">Referer</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com/index.html
<span class="token key atrule">Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com

<span class="token punctuation">{</span><span class="token key atrule">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;袁小进&quot;</span><span class="token punctuation">,</span> <span class="token key atrule">&quot;age&quot;</span><span class="token punctuation">:</span> <span class="token number">18</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>服务器响应真实请求</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Tue<span class="token punctuation">,</span> 21 Apr 2020 08<span class="token punctuation">:</span>03<span class="token punctuation">:</span>35 GMT
<span class="token punctuation">...</span>
<span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//my.com
<span class="token punctuation">...</span>

添加用户成功
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>当完成预检之后，后续的处理与简单请求相同</li></ul><p><img src="/assets/Node45-b0ac45ab.png" alt=""></p><h4 id="_6-附带身份凭证的请求" tabindex="-1"><a class="header-anchor" href="#_6-附带身份凭证的请求" aria-hidden="true">#</a> 6）附带身份凭证的请求</h4><ul><li>默认情况下，ajax 的跨域请求并不会附带 cookie</li><li>某些需要权限的操作就无法进行 <ul><li>可以通过简单的配置实现附带 cookie</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// xhr</span>
<span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// fetch api</span>
<span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">credentials</span><span class="token operator">:</span> <span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>此时，该跨域的 ajax 请求就是一个附带身份凭证的请求</li><li>当一个请求需要附带 cookie 时，无论是简单请求，还是预检请求，都会在请求头中添加 <code>cookie</code> 字段 <ul><li>而服务器响应时，需要明确告知客户端：服务器允许这样的凭据</li></ul></li><li>只需要在响应头中添加 <code>Access-Control-Allow-Credentials: true</code> 即可</li><li>对于一个附带身份凭证的请求，若服务器没有明确告知，浏览器仍然视为跨域被拒绝</li></ul><div class="hint-container warning"><p class="hint-container-title">注意</p><p>对于附带身份凭证的请求，服务器不得设置 <code>Access-Control-Allow-Origin: *</code>，所以不推荐使用 <code>*</code></p></div><h4 id="_7-js-访问指定的响应头" tabindex="-1"><a class="header-anchor" href="#_7-js-访问指定的响应头" aria-hidden="true">#</a> 7）JS 访问指定的响应头</h4><ul><li>在跨域访问时，JS 只能拿到一些最基本的响应头 <ul><li>如：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma</li></ul></li><li>如果要访问其他头，则需要服务器设置 <code>Access-Control-Expose-Headers</code><ul><li>让服务器把允许浏览器访问的头放入白名单</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Expose-Headers</span><span class="token punctuation">:</span> authorization<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_11-cors-中间件" tabindex="-1"><a class="header-anchor" href="#_11-cors-中间件" aria-hidden="true">#</a> 11.CORS 中间件</h3><blockquote><p><a href="https://github.com/expressjs/cors#readme" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_12-session" tabindex="-1"><a class="header-anchor" href="#_12-session" aria-hidden="true">#</a> 12.Session</h3><blockquote><p><a href="https://github.com/expressjs/session" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_1-cookie" tabindex="-1"><a class="header-anchor" href="#_1-cookie" aria-hidden="true">#</a> 1）Cookie</h4><ul><li>存储在客户端</li><li>优点 <ul><li>存储在客户端，不占用服务器资源</li></ul></li><li>缺点 <ul><li>只能是字符串格式</li><li>存储量有限 <ul><li>sessionStorage</li><li>localStorage</li></ul></li><li>数据容易被获取</li><li>数据容易被篡改</li><li>容易丢失</li></ul></li></ul><h4 id="_2-session" tabindex="-1"><a class="header-anchor" href="#_2-session" aria-hidden="true">#</a> 2）Session</h4><ul><li>存储在服务器端</li><li>优点 <ul><li>可以是任何格式</li><li>存储量理论上是无限的</li><li>数据难以被获取</li><li>数据难以被篡改</li><li>不易丢失</li></ul></li><li>缺点 <ul><li>占用服务器资源</li></ul></li></ul><h4 id="_3-uuid" tabindex="-1"><a class="header-anchor" href="#_3-uuid" aria-hidden="true">#</a> 3）UUID</h4><ul><li>Universal Unique Identity</li></ul><h3 id="_13-jwt" tabindex="-1"><a class="header-anchor" href="#_13-jwt" aria-hidden="true">#</a> 13.JWT</h3><blockquote><p>随着前后端分离的发展，以及数据中心的建立，越来越多的公司会创建一个中心服务器，服务于各种产品线</p><br><p>而这些产品线上的产品可能有着各种终端设备，包括但不仅限于浏览器、桌面应用、移动端应用、平板应用、甚至智能家居</p><br><p>实际上，不同的产品线通常有自己的服务器，产品内部的数据一般和自己的服务器交互</p><br><p>但中心服务器仍然有必要存在，因为同一家公司的产品总是会存在共享的数据，比如用户数据</p></blockquote><p><img src="/assets/Node46-6c9c5f58.png" alt=""></p><ul><li>这些设备与中心服务器之间会进行 http 通信</li><li>一般来说，中心服务器至少承担着认证和授权的功能 <ul><li>如：登录</li><li>各种设备发送消息到中心服务器，然后中心服务器响应一个身份令牌</li><li>参见 <a href="http://www.yuanjin.tech/article/98" target="_blank" rel="noopener noreferrer">cookie 原理详解<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li>当这种结构出现后，就出现一个问题：它们之间还能使用传统的 cookie 方式传递令牌信息吗？</li><li>其实，也是可以的，因为 cookie 在传输中无非是一个消息头而已，只不过浏览器对这个消息头有特殊处理罢了</li><li>但浏览器之外的设备肯定不喜欢 cookie，因为浏览器有着对 cookie 完善的管理机制，但是在其他设备上，就需要开发者自己手动处理了</li><li>jwt 的出现就是为了解决这个问题</li></ul><h4 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介" aria-hidden="true">#</a> 1）简介</h4><ul><li>JWT, JSON Web Token</li><li>为多种终端设备提供统一的、安全的令牌格式</li></ul><p><img src="/assets/Node47-a9eb104c.png" alt=""></p><ul><li>可以存储到 cookie，也可以存储到 localStorage，没有任何限制</li><li>可以使用任何传输方式来传输 jwt <ul><li>一般来说，会使用消息头来传输</li></ul></li><li>如：当登录成功后，服务器可以给客户端响应一个 jwt</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>HTTP/1.1 200 OK
<span class="token punctuation">---</span>
set<span class="token punctuation">-</span>cookie<span class="token punctuation">:</span>token=jwt令牌
authorization<span class="token punctuation">:</span>jwt令牌
<span class="token punctuation">---</span>
<span class="token punctuation">{</span> <span class="token punctuation">...</span><span class="token punctuation">,</span> token<span class="token punctuation">:</span>jwt令牌 <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>jwt 令牌可以出现在响应的任何一个地方，客户端和服务器自行约定即可</li><li>也可以出现在响应的多个地方 <ul><li>如：为了充分利用浏览器的 cookie，同时为了照顾其他设备</li><li>可以让 jwt 出现在 <code>set-cookie</code> 和 <code>authorization</code> 或 <code>body</code>中</li><li>这会增加额外的传输量</li></ul></li><li>可以存储到任何位置 <ul><li>如：手机文件、PC 文件、localStorage、cookie</li></ul></li><li>当后续请求发生时，只需要将它作为请求的一部分发送到服务器即可</li><li>虽然 jwt 没有明确要求应该如何附带到请求中，但通常会使用如下的格式 <ul><li>这种格式是 OAuth2 附带 token 的一种规范格式</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>GET /api/resources HTTP/1.1
<span class="token punctuation">---</span>
<span class="token key atrule">authorization</span><span class="token punctuation">:</span> bearer jwt令牌
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="/assets/Node48-afce9773.png" alt=""></p><h4 id="_2-令牌的组成" tabindex="-1"><a class="header-anchor" href="#_2-令牌的组成" aria-hidden="true">#</a> 2）令牌的组成</h4><ul><li>为了保证令牌的安全性，jwt 令牌由三个部分组成</li><li>完整格式：<code>header.payload.signature</code></li></ul><table><thead><tr><th>组成</th><th>说明</th></tr></thead><tbody><tr><td>header</td><td>令牌头部，记录了整个令牌的类型和签名算法</td></tr><tr><td>payload</td><td>令牌负荷，记录了保存的主体信息<br>如：要保存的用户信息</td></tr><tr><td>signature</td><td>令牌签名，按照头部固定的签名算法对整个令牌进行签名<br>该签名的作用是：保证令牌不被伪造和篡改</td></tr></tbody></table><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9.BCwUy3jnUQ_E6TqCayc7rCHkx<span class="token punctuation">-</span>vxxdagUwPOWqwYCFc
<span class="token comment"># header：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>
<span class="token comment"># payload：eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</span>
<span class="token comment"># signature: BCwUy3jnUQ_E6TqCayc7rCHkx-vxxdagUwPOWqwYCFc</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-header" tabindex="-1"><a class="header-anchor" href="#_3-header" aria-hidden="true">#</a> 3）header</h4><ul><li>令牌头部，记录了整个令牌的类型和签名算法</li><li>格式是一个 JSON 对象</li><li>alg <ul><li>signature 部分使用的签名算法，通常可以取两个值</li><li>HS256：一种对称加密算法，使用同一个秘钥对 signature 加密解密</li><li>RS256：一种非对称加密算法，使用私钥加密，公钥解密</li></ul></li><li>typ <ul><li>整个令牌的类型，固定写 <code>JWT</code> 即可</li></ul></li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;typ&quot;</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>设置好 <code>header</code> 后就可以生成 <code>header</code> 部分了</li><li>把 <code>header</code> 部分使用 <code>base64 url</code> 编码即可 <ul><li><code>base64 url</code> 不是一个加密算法，而是一种编码方式</li><li>是在 <code>base64</code> 算法的基础上对 <code>+</code> 、 <code>=</code> 、 <code>/</code> 三个字符做出特殊处理的算法</li><li>而 <code>base64</code> 是使用 64 个可打印字符来表示一个二进制数据</li><li>具体的做法参考 <a href="https://baike.baidu.com/item/base64/8545775?fr=aladdin" target="_blank" rel="noopener noreferrer">百度百科<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li>浏览器提供了 <code>btoa</code> 函数对 header 编码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">alg</span><span class="token operator">:</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">typ</span><span class="token operator">:</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>同样的，浏览器也提供了 <code>atob</code> 函数对其解码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">atob</span><span class="token punctuation">(</span><span class="token string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><ul><li>NodeJS 中没有提供这两个函数，可以安装第三方库 <code>atob</code> 和 <code>bota</code></li><li>或者手动编码解码</li></ul></div><h4 id="_4-payload" tabindex="-1"><a class="header-anchor" href="#_4-payload" aria-hidden="true">#</a> 4）payload</h4><ul><li>jwt 的主体信息，仍然是一个 JSON 对象</li><li>可以包含以下内容</li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;ss&quot;</span>：<span class="token string">&quot;发行者&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;iat&quot;</span>：<span class="token string">&quot;发布时间&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;exp&quot;</span>：<span class="token string">&quot;到期时间&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;sub&quot;</span>：<span class="token string">&quot;主题&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;aud&quot;</span>：<span class="token string">&quot;听众&quot;</span><span class="token punctuation">,</span>
	<span class="token string">&quot;nbf&quot;</span>：<span class="token string">&quot;在此之前不可用&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;jti&quot;</span>：<span class="token string">&quot;JWT ID&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>可以全写，也可以一个都不写，只是一个规范</li><li>就算写了，也需要在将来验证这个 jwt 令牌时手动处理才能发挥作用</li></ul><table><thead><tr><th>属性</th><th>含义</th></tr></thead><tbody><tr><td><code>ss</code></td><td>发行该 jwt 的是谁<br>可以写公司名字，也可以写服务名称</td></tr><tr><td><code>iat</code></td><td>该 jwt 的发放时间<br>通常写当前时间的时间戳</td></tr><tr><td><code>exp</code></td><td>该 jwt 的到期时间<br>通常写时间戳</td></tr><tr><td><code>sub</code></td><td>该 jwt 是用于干嘛的</td></tr><tr><td><code>aud</code></td><td>该 jwt 是发放给哪个终端的<br>可以是终端类型，也可以是用户名称，随意一点</td></tr><tr><td><code>nbf</code></td><td>一个时间点<br>在该时间点到达之前，这个令牌是不可用的</td></tr><tr><td><code>jti</code></td><td>jwt 的唯一编号<br>设置此项的目的，主要是为了防止重放攻击</td></tr></tbody></table><div class="hint-container info"><p class="hint-container-title">重放攻击</p><p>在某些场景下，用户使用之前的令牌发送到服务器，被服务器正确的识别，从而导致不可预期的行为发生</p></div><ul><li>payload 这一部分只是一个 json 对象而已</li><li>可以向对象中加入任何想要加入的信息 <ul><li><code>foo: bar</code>是自定义的信息</li><li><code>iat: 1587548215</code>是 jwt 规范中的信息</li></ul></li></ul><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;foo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;iat&quot;</span><span class="token operator">:</span> <span class="token number">1587548215</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>payload 部分和 header 一样，需要通过 <code>base64 url</code> 编码</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">btoa</span><span class="token punctuation">(</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">foo</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">iat</span><span class="token operator">:</span> <span class="token number">1587548215</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-signature" tabindex="-1"><a class="header-anchor" href="#_5-signature" aria-hidden="true">#</a> 5）signature</h4><ul><li>jwt 的签名，保证了整个 jwt 不被篡改</li><li>这部分的生成，是对前面两个部分的编码结果，按照头部指定的方式进行加密 <ul><li>如：头部指定的加密方法是 <code>HS256</code>，前面两部分的编码结果是<code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</code></li><li>则第三部分就是用对称加密算法 <code>HS256</code> 对字符串 <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</code> 进行加密</li><li>当然需要指定一个秘钥，比如 <code>shhhhh</code></li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token constant">HS256</span><span class="token punctuation">(</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token string">&quot;shhhhh&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// BCwUy3jnUQ_E6TqCayc7rCHkx-vxxdagUwPOWqwYCFc</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>将三部分组合在一起，就得到了完整的 jwt</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmb28iOiJiYXIiLCJpYXQiOjE1ODc1NDgyMTV9.BCwUy3jnUQ_E6TqCayc7rCHkx<span class="token punctuation">-</span>vxxdagUwPOWqwYCFc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>由于签名使用的秘钥保存在服务器，客户端就无法伪造出签名，因为拿不到秘钥</li><li>之所以说无法伪造 jwt，就是因为第三部分 signature 的存在</li><li>而前面两部分并没有加密，只是一个编码结果而已，可以认为几乎是明文传输 <ul><li>不要把敏感的信息存放到 jwt 中，如：密码</li></ul></li></ul><h4 id="_6-令牌的验证" tabindex="-1"><a class="header-anchor" href="#_6-令牌的验证" aria-hidden="true">#</a> 6）令牌的验证</h4><ul><li>令牌在服务器组装完成后，会以任意的方式发送到客户端</li><li>客户端会把令牌保存起来，后续的请求会将令牌发送给服务器</li><li>而服务器需要验证令牌是否正确 <ul><li>对 <code>header + payload</code> 用同样的秘钥和加密算法进行重新加密</li><li>把加密的结果和传入 jwt 的 <code>signature</code> 进行对比</li><li>如果完全相同，则表示 jwt 没有被篡改</li><li>如果不同，肯定是被篡改过了</li></ul></li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>传入的header.传入的payload.传入的signature
新的signature = header中的加密算法(传入的header.传入的payload, 秘钥)
验证：新的signature === 传入的signature
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>当令牌验证为没有被篡改后，服务器可以进行其他验证 <ul><li>如：是否过期、听众是否满足要求等等</li></ul></li><li>这些验证都需要服务器手动完成，没有哪个服务器会自动验证 <ul><li>可以借助第三方库来完成</li></ul></li></ul><h4 id="_7-jwt-的特点" tabindex="-1"><a class="header-anchor" href="#_7-jwt-的特点" aria-hidden="true">#</a> 7）jwt 的特点</h4><ul><li>jwt 本质上是一种令牌格式</li><li>和终端设备无关，同样和服务器无关，甚至与如何传输无关，只是规范了令牌的格式而已</li><li>jwt 由三部分组成：header、payload、signature <ul><li>主体信息在 payload</li></ul></li><li>jwt 难以被篡改和伪造 <ul><li>因为有第三部分的签名存在</li></ul></li></ul><h3 id="_14-登录和认证-——-服务器开发" tabindex="-1"><a class="header-anchor" href="#_14-登录和认证-——-服务器开发" aria-hidden="true">#</a> 14.登录和认证 —— 服务器开发</h3><ul><li><a href="https://github.com/auth0/node-jsonwebtoken#readme" target="_blank" rel="noopener noreferrer">jsonwebtoken<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>使用 express-jwt</li></ul><h4 id="_1-颁发-jwt" tabindex="-1"><a class="header-anchor" href="#_1-颁发-jwt" aria-hidden="true">#</a> 1）颁发 jwt</h4><ul><li>确定过期时间</li><li>确定主体</li><li>确定密钥</li><li>确定传输方式 <ul><li>Cookie</li><li>Authorization</li></ul></li></ul><h4 id="_2-认证-jwt" tabindex="-1"><a class="header-anchor" href="#_2-认证-jwt" aria-hidden="true">#</a> 2）认证 jwt</h4><ul><li>获取 jwt <ul><li>从 Cookie 中</li><li>从 Authorization 中 <ul><li>带 Bearer</li><li>不带 Bearer</li></ul></li></ul></li><li>验证 jwt</li></ul><h4 id="_3-添加-whoami-接口" tabindex="-1"><a class="header-anchor" href="#_3-添加-whoami-接口" aria-hidden="true">#</a> 3）添加 whoami 接口</h4><h3 id="_15-登录和认证-——-客户端开发" tabindex="-1"><a class="header-anchor" href="#_15-登录和认证-——-客户端开发" aria-hidden="true">#</a> 15.登录和认证 —— 客户端开发</h3><ul><li><a href="https://www.npmjs.com/package/connect-history-api-fallback" target="_blank" rel="noopener noreferrer">history api fallback<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="_16-场景-——-日志记录" tabindex="-1"><a class="header-anchor" href="#_16-场景-——-日志记录" aria-hidden="true">#</a> 16.场景 —— 日志记录</h3><h3 id="_17-场景-——-文件上传" tabindex="-1"><a class="header-anchor" href="#_17-场景-——-文件上传" aria-hidden="true">#</a> 17.场景 —— 文件上传</h3><h4 id="_1-文件上传使用的-http-报文格式" tabindex="-1"><a class="header-anchor" href="#_1-文件上传使用的-http-报文格式" aria-hidden="true">#</a> 1）文件上传使用的 http 报文格式</h4><h4 id="_2-服务器解析处理请求体" tabindex="-1"><a class="header-anchor" href="#_2-服务器解析处理请求体" aria-hidden="true">#</a> 2）服务器解析处理请求体</h4><ul><li><a href="https://github.com/expressjs/multer#readme" target="_blank" rel="noopener noreferrer">multer<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="_18-场景-——-文件下载" tabindex="-1"><a class="header-anchor" href="#_18-场景-——-文件下载" aria-hidden="true">#</a> 18.场景 —— 文件下载</h3><h3 id="_19-场景-——-图片水印" tabindex="-1"><a class="header-anchor" href="#_19-场景-——-图片水印" aria-hidden="true">#</a> 19.场景 —— 图片水印</h3><ul><li><a href="https://github.com/oliver-moran/jimp" target="_blank" rel="noopener noreferrer">Jimp<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="_20-场景-——-图片防盗链" tabindex="-1"><a class="header-anchor" href="#_20-场景-——-图片防盗链" aria-hidden="true">#</a> 20.场景 —— 图片防盗链</h3><h3 id="_21-场景-——-代理【重要】" tabindex="-1"><a class="header-anchor" href="#_21-场景-——-代理【重要】" aria-hidden="true">#</a> 21.场景 —— 代理【重要】</h3><p><img src="/assets/Node49-c370b30f.png" alt=""></p><ul><li><a href="https://github.com/chimurai/http-proxy-middleware" target="_blank" rel="noopener noreferrer">http-proxy-middleware<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="_22-场景-——-模版引擎" tabindex="-1"><a class="header-anchor" href="#_22-场景-——-模版引擎" aria-hidden="true">#</a> 22.场景 —— 模版引擎</h3><h4 id="_1-两种渲染方式" tabindex="-1"><a class="header-anchor" href="#_1-两种渲染方式" aria-hidden="true">#</a> 1）两种渲染方式</h4><p><img src="/assets/Node50-62f9b5c0.png" alt=""></p><h4 id="_2-模板引擎" tabindex="-1"><a class="header-anchor" href="#_2-模板引擎" aria-hidden="true">#</a> 2）模板引擎</h4><ul><li>在静态内容中插入动态内容</li><li>常见模板引擎 <ul><li>mustache</li><li><a href="https://github.com/mde/ejs" target="_blank" rel="noopener noreferrer">ejs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li></ul><h3 id="_23-场景-——-生成二维码" tabindex="-1"><a class="header-anchor" href="#_23-场景-——-生成二维码" aria-hidden="true">#</a> 23.场景 —— 生成二维码</h3><blockquote><p><a href="https://github.com/soldair/node-qrcode" target="_blank" rel="noopener noreferrer">GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h4 id="_1-矩阵点" tabindex="-1"><a class="header-anchor" href="#_1-矩阵点" aria-hidden="true">#</a> 1）矩阵点</h4><ul><li>通常是黑色或白色的小点</li><li>深色表示 1</li><li>白色表示 0</li></ul><h4 id="_2-位置探测组" tabindex="-1"><a class="header-anchor" href="#_2-位置探测组" aria-hidden="true">#</a> 2）位置探测组</h4><ul><li>三个位于角落的嵌套矩形</li><li>用于定位二维码图片的方向</li></ul><h4 id="_3-version" tabindex="-1"><a class="header-anchor" href="#_3-version" aria-hidden="true">#</a> 3）Version</h4><ul><li>1 ～ 40 的数字</li><li>数字越大，表示整个二维码的矩阵越大 <ul><li>1 表示 <code>21 * 21</code></li><li>40 表示 <code>177 * 177</code></li></ul></li></ul><h4 id="_4-mode" tabindex="-1"><a class="header-anchor" href="#_4-mode" aria-hidden="true">#</a> 4）mode</h4><ul><li>字符编码方式</li><li>Numeric</li><li>Alphanumeric</li><li>Kanji</li><li>Byte</li></ul><h4 id="_5-纠错等级" tabindex="-1"><a class="header-anchor" href="#_5-纠错等级" aria-hidden="true">#</a> 5）纠错等级</h4><ul><li>L</li><li>M</li><li>Q</li><li>H</li><li>纠错等级越高，能够表达的字符量越少</li></ul><h3 id="_24-场景-——-生成验证码" tabindex="-1"><a class="header-anchor" href="#_24-场景-——-生成验证码" aria-hidden="true">#</a> 24.场景 —— 生成验证码</h3><h4 id="_1-作用-2" tabindex="-1"><a class="header-anchor" href="#_1-作用-2" aria-hidden="true">#</a> 1）作用</h4><ul><li>防止机器提交</li></ul><h4 id="_2-类型-1" tabindex="-1"><a class="header-anchor" href="#_2-类型-1" aria-hidden="true">#</a> 2）类型</h4><ul><li>普通验证码</li><li>行为验证码</li></ul><h4 id="_3-流程" tabindex="-1"><a class="header-anchor" href="#_3-流程" aria-hidden="true">#</a> 3）流程</h4><ul><li>获取验证码图片 <ul><li>客户端通过 img 元素的 src 地址获取验证码图片</li><li>服务器生成 <a href="https://github.com/produck/svg-captcha/blob/1.x/README_CN.md" target="_blank" rel="noopener noreferrer">随机图片<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>服务器保存随机图片中的文字</li></ul></li><li>验证 <ul><li>服务器判断是否对验证码进行验证</li><li>验证客户端传递的验证码是否和服务器保存的一致</li></ul></li></ul><h3 id="_25-场景-——-客户端缓存" tabindex="-1"><a class="header-anchor" href="#_25-场景-——-客户端缓存" aria-hidden="true">#</a> 25.场景 —— 客户端缓存</h3><ul><li>在一个 C/S 结构中，最基本的缓存分为两种 <ul><li>客户端缓存</li><li>服务器缓存</li></ul></li></ul><h4 id="_1-缓存的基本原理" tabindex="-1"><a class="header-anchor" href="#_1-缓存的基本原理" aria-hidden="true">#</a> 1）缓存的基本原理</h4><ul><li>客户端缓存，将某一次的响应结果保存在客户端（如：浏览器）中</li><li>后续的请求仅需要从缓存中读取即可</li><li>极大的降低了服务器的处理压力</li></ul><p><img src="/assets/Node51-63f83bac.png" alt=""></p><blockquote><p>这只是一个简易的原理图，实际情况可能有差异</p><br><p>这里就涉及到缓存策略的问题</p><br><p>哪些资源需要加入到缓存，哪些不需要？</p><br><p>缓存的时间是多久呢？</p><br><p>如果服务器的资源有改动，客户端如何更新缓存呢？</p><br><p>如果缓存过期了，可是服务器上的资源并没有发生变动，又该如何处理呢？</p><br><p>.......</p><br><p>要回答这些问题，就必须要清楚 <code>http</code> 中关于缓存的协议</p></blockquote><h4 id="_2-来自服务器的缓存指令" tabindex="-1"><a class="header-anchor" href="#_2-来自服务器的缓存指令" aria-hidden="true">#</a> 2）来自服务器的缓存指令</h4><blockquote><p>当客户端发出一个 GET 请求到服务器，服务器可能有以下的内心活动</p><br><p>你请求的这个资源，我很少会改动它，干脆你把它缓存起来吧，以后就不要来烦我了</p></blockquote><ul><li>为了表达这个美好的愿望，服务器在 <mark>响应头</mark> 中加入了以下内容</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Cache-Control</span><span class="token punctuation">:</span> max<span class="token punctuation">-</span>age=3600
<span class="token key atrule">ETag</span><span class="token punctuation">:</span> W/&quot;121<span class="token punctuation">-</span>171ca289ebf&quot;
<span class="token key atrule">Date</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 12<span class="token punctuation">:</span>39<span class="token punctuation">:</span>56 GMT
<span class="token key atrule">Last-Modified</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 08<span class="token punctuation">:</span>16<span class="token punctuation">:</span>31 GMT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>这个响应头表达了下面的信息</p><br><p><code>Cache-Control: max-age=3600</code></p><br><p>我希望你把这个资源缓存起来，缓存时间是 3600 秒（1 小时）</p><br><p><code>ETag: W/&quot;121-171ca289ebf&quot;</code></p><br><p>这个资源的编号是 <code>W/&quot;121-171ca289ebf&quot;</code></p><br><p><code>Date: Thu, 30 Apr 2020 12:39:56 GMT</code></p><br><p>我给你响应这个资源的服务器时间是格林威治时间 <code>2020-04-30 12:39:56</code></p><br><p><code>Last-Modified: Thu, 30 Apr 2020 08:16:31 GMT</code></p><br><p>这个资源的上一次修改时间是格林威治时间 <code>2020-04-30 08:16:31</code></p></blockquote><ul><li>如果客户端是其他应用程序，可能并不会理会服务器的愿望 <ul><li>可能根本不会缓存任何东西</li></ul></li><li>但是凑巧客户端是一个浏览器，它和服务器一直以来都是相亲相爱的小伙伴</li><li>当它看到服务器的这个响应头表达的美好愿望后，立即忙起来： <ul><li>浏览器把这次请求得到的响应体缓存到本地文件中</li><li>浏览器标记这次请求的请求方法和请求路径</li><li>浏览器标记这次缓存的时间是 3600 秒</li><li>浏览器记录服务器的响应时间是格林威治时间 <code>2020-04-30 12:39:56</code></li><li>浏览器记录服务器给予的资源编号 <code>W/&quot;121-171ca289ebf&quot;</code></li><li>浏览器记录资源的上一次修改时间是格林威治时间 <code>2020-04-30 08:16:31</code></li></ul></li><li>这一次的记录非常重要，为以后浏览器要不要去请求服务器提供了各种依据</li></ul><p><img src="/assets/Node52-4a08e02d.png" alt=""></p><h4 id="_3-来自客户端的缓存指令" tabindex="-1"><a class="header-anchor" href="#_3-来自客户端的缓存指令" aria-hidden="true">#</a> 3）来自客户端的缓存指令</h4><blockquote><p>当客户端收拾好行李，准备再次请求 <code>GET /index.js</code> 时</p><br><p>突然想起了一件事：我需要的东西在不在缓存里呢？</p></blockquote><ul><li>此时，客户端会到缓存中去寻找是否有缓存的资源 <ul><li>缓存中是否有匹配的请求方法和路径？</li><li>如果有，该缓存资源是否还有效呢？</li></ul></li><li>以上两个验证会导致浏览器产生不同的行为</li></ul><p><img src="/assets/Node53-adeb6a24.png" alt=""></p><p><img src="/assets/Node54-c6d9c186.png" alt=""></p><ul><li>验证是否有匹配的缓存 <ul><li>只需要验证当前的请求方法 <code>GET</code> 和当前的请求路径 <code>/index.js</code> 是否有对应的缓存存在即可</li><li>如果没有，就直接请求服务器，和第一次请求服务器时一样</li></ul></li><li>关键在于验证缓存是否有效 <ul><li><code>max-age + Date</code> 得到一个过期时间，看看这个过期时间是否大于当前时间</li><li>如果是，则表示缓存还没有过期，仍然有效</li><li>如果不是，则表示缓存失效</li></ul></li><li>缓存有效 <ul><li>当浏览器发现缓存有效时，完全不会请求服务器，直接使用缓存即可得到结果</li><li>此时，如果断开网络，会发现资源仍然可用，极大地降低服务器压力</li><li>但当服务器更改了资源后，浏览器不知道，只要缓存有效，就会直接使用缓存</li></ul></li><li>缓存无效 <ul><li>当浏览器发现缓存已经过期，并不会简单的把缓存删除</li><li>而是抱着一丝希望，想问问服务器，这个缓存还能继续使用吗</li><li>于是，浏览器向服务器发出了一个 <mark>带缓存的请求</mark></li><li>即加入了以下的请求头</li></ul></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">If-Modified-Since</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 08<span class="token punctuation">:</span>16<span class="token punctuation">:</span>31 GMT
<span class="token key atrule">If-None-Match</span><span class="token punctuation">:</span> W/&quot;121<span class="token punctuation">-</span>171ca289ebf&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>If-Modified-Since: Thu, 30 Apr 2020 08:16:31 GMT</code></p><br><p>亲，你曾经告诉我，这个资源的上一次修改时间是格林威治时间 <code>2020-04-30 08:16:31</code>，请问这个资源在这个时间之后有发生变动吗？</p><br><p><code>If-None-Match: W/&quot;121-171ca289ebf&quot;</code></p><br><p>亲，你曾经告诉我，这个资源的编号是 <code>W/&quot;121-171ca289ebf</code>，请问这个资源的编号发生变动了吗？</p><br><p>其实，这两个问题可以合并为一个问题：快说！资源到底变了没有！</p></blockquote><ul><li>之所以要发两个信息，是为了兼容不同的服务器 <ul><li>有些服务器只认 <code>If-Modified-Since</code></li><li>有些服务器只认 <code>If-None-Match</code></li><li>有些服务器两个都认</li></ul></li><li>目前的很多服务器，只要发现 <code>If-None-Match</code> 存在，就不会看 <code>If-Modified-Since</code></li><li><code>If-Modified-Since</code> 是 <code>http1.0</code> 版本的规范</li><li><code>If-None-Match</code> 是 <code>http1.1</code> 的规范</li><li>服务器可能会产生两个情况 <ul><li>缓存已经失效 <ul><li>服务器再次给予一个正常的响应：响应码 200 带响应体</li><li>同时可以附带上新的缓存指令</li><li>客户端就会重新缓存新的内容</li></ul></li><li>缓存仍然有效 <ul><li>服务器给予一个简单的响应：响应码 <code>304 Not Modified</code> 无响应体</li><li>响应头带上新的缓存指令</li></ul></li></ul></li></ul><blockquote><p>相当于告诉客户端</p><br><p>你的缓存资源仍然可用，我给你一个新的缓存时间，你那边更新一下就可以了</p></blockquote><ul><li>可以最大程度的减少网络传输</li><li>因为如果资源还有效，服务器就不会传输消息体</li></ul><p><img src="/assets/Node55-463f09ce.png" alt=""></p><h4 id="_4-cache-control" tabindex="-1"><a class="header-anchor" href="#_4-cache-control" aria-hidden="true">#</a> 4）Cache-Control</h4><ul><li>服务器向客户端响应的一个消息头</li><li>提供了一个 <code>max-age</code> 用于指定缓存时间</li><li>还可以设置下面一个或多个值</li></ul><table><thead><tr><th>属性</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td><code>public</code></td><td>指示服务器资源是公开的</td><td>如：有一个页面资源，所有人看到的都是一样的<br>这个值对于浏览器而言没有什么意义，但可能在某些场景可能有用<br>本着「我告知，你随意」的原则，<code>http</code> 协议中很多时候都是客户端或服务器告诉另一端详细的信息，至于另一端用不用，完全看它自己</td></tr><tr><td><code>private</code></td><td>指示服务器资源是私有的</td><td>如：有一个页面资源，每个用户看到的都不一样<br>这个值对于浏览器而言没有什么意义，但可能在某些场景可能有用<br>本着「我告知，你随意」的原则，<code>http</code> 协议中很多时候都是客户端或服务器告诉另一端详细的信息，至于另一端用不用，完全看它自己</td></tr><tr><td><code>no-cache</code></td><td>告知客户端可以缓存这个资源，但不要 <mark>直接</mark> 使用它</td><td>缓存之后，后续的每一次请求都需要附带缓存指令，让服务器验证这个资源有没有过期</td></tr><tr><td><code>no-store</code></td><td>告知客户端不要对这个资源做任何的缓存，之后的每一次请求都按照正常的普通请求进行</td><td>若设置了这个值，浏览器将不会对该资源做出任何的缓存处理</td></tr><tr><td><code>max-age</code></td><td></td><td></td></tr></tbody></table><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Cache-Control</span><span class="token punctuation">:</span> public<span class="token punctuation">,</span> max<span class="token punctuation">-</span>age=3600
<span class="token comment"># 表示这是一个公开资源，请缓存1个小时</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-expire" tabindex="-1"><a class="header-anchor" href="#_5-expire" aria-hidden="true">#</a> 5）Expire</h4><ul><li>在 <code>http1.0</code> 版本中，是通过 <code>Expire</code> 响应头来指定过期时间点的</li><li><code>http1.1</code> 版本更改为通过 <code>Cache-Control</code> 的 <code>max-age</code> 来记录</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Expire</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 30 Apr 2020 23<span class="token punctuation">:</span>38<span class="token punctuation">:</span>38 GMT
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_6-记录缓存时的有效期" tabindex="-1"><a class="header-anchor" href="#_6-记录缓存时的有效期" aria-hidden="true">#</a> 6）记录缓存时的有效期</h4><ul><li>浏览器会按照服务器响应头的要求，自动记录缓存到本地文件，并设置各种相关信息 <ul><li>在这些信息中， <mark>有效期</mark> 尤为关键，决定了这个缓存可以使用多久</li></ul></li><li>浏览器会根据服务器不同的响应情况，设置不同的有效期</li></ul><p><img src="/assets/Node56-fda93b9a.png" alt=""></p><ul><li>如：当 <code>max-age</code> 设置为 0 时，缓存立即过期 <ul><li>虽然立即过期，但缓存仍然被记录下来</li><li>后续的请求通过缓存指令发送到服务器，来确认资源是否被更改</li></ul></li><li>因此 <code>Cache-Control: max-age=0</code> 类似于 <code>Cache-Control: no-cache</code></li></ul><h4 id="_7-pragma" tabindex="-1"><a class="header-anchor" href="#_7-pragma" aria-hidden="true">#</a> 7）Pragma</h4><ul><li><code>http1.0</code> 版本的消息头 <ul><li>当该消息头出现在请求中时，是向服务器表达：不要考虑任何缓存，返回一个正常的结果</li></ul></li><li>在 <code>http1.1</code> 版本中，可以在 <mark>请求头</mark> 中加入 <code>Cache-Control: no-cache</code> 实现</li><li>在 Chrome 浏览器中调试时，如果勾选了 <code>Disable Cache</code>，则发送的请求中会附带该信息</li></ul><h4 id="_8-vary" tabindex="-1"><a class="header-anchor" href="#_8-vary" aria-hidden="true">#</a> 8）Vary</h4><ul><li>有时是否有缓存，不仅仅是判断请求方法和请求路径是否匹配，可能还要判断头部信息是否匹配</li><li>此时，就可以使用 <code>Vary</code> 字段来指定要区分的消息头</li><li>如：当使用 <code>GET /personal.html</code> 请求服务器时，请求头中 cookie 的值不一样，得到的页面也不一样 <ul><li>如果还按照之前的做法，仅仅匹配请求方法和请求路径，如果 cookie 变动，可能得到的仍然是之前的页面</li></ul></li><li>正确的做法如下</li></ul><p><img src="/assets/Node57-fddba6bb.png" alt=""></p><h4 id="_9-使用版本号或-hash" tabindex="-1"><a class="header-anchor" href="#_9-使用版本号或-hash" aria-hidden="true">#</a> 9）使用版本号或 hash</h4><ul><li>vue 或其他基于 webpack 搭建的工程中，打包的结果很多文件名类似于 <code>app.68297cd8.css</code></li><li>文件的中间部分使用了 <code>hash</code> 值</li><li>可以让客户端长时间地缓存该文件，减轻服务器的压力 <ul><li>当文件改动后，文件 hash 值也会随之而变，如：<code>app.446fccb8.css</code></li><li>客户端要请求新的文件时，就会发现路径从 <code>app.68297cd8.css</code> 变成了 <code>app.446fccb8.css</code><ul><li>由于之前的缓存路径无法匹配到，因此就会发送新的请求来获取新资源</li></ul></li></ul></li><li>在构建工具出现前，通常是在资源路径后面加入版本号来获取新版本的文件 <ul><li>如：页面中引入了一个 css 资源 <code>app.css</code></li></ul></li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app.css?v=1.0.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>缓存的路径是 <code>/app.css?v=1.0.0</code></li><li>当服务器的版本发生变化时，可以给予新的版本号，让 html 中的路径发生变动</li></ul><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/app.css?v=1.0.1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>由于新的路径无法命中缓存，于是浏览器就会发送新的普通请求来获取这个资源</li></ul><h4 id="_10-总结" tabindex="-1"><a class="header-anchor" href="#_10-总结" aria-hidden="true">#</a> 10）总结</h4><ul><li>服务器无法知道客户端到底有没有像浏览器那样缓存文件</li><li>只管根据请求的情况来决定如何响应</li><li>很多后端语言搭建的服务器都会自带自己的默认缓存规则，当然也支持不同程度的修改</li></ul><p><img src="/assets/Node58-f5d16681.png" alt=""></p><ul><li>浏览器在发出请求时会判断要不要使用缓存</li><li>当收到服务器响应时，会自动根据缓存指令进行处理</li></ul><p><img src="/assets/Node59-d71f9e8d.png" alt=""></p><h3 id="_26-场景-——-富文本框" tabindex="-1"><a class="header-anchor" href="#_26-场景-——-富文本框" aria-hidden="true">#</a> 26.场景 —— 富文本框</h3><ul><li><a href="https://www.wangeditor.com/" target="_blank" rel="noopener noreferrer">wangEditor<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>一个可以被编辑的 div</li><li>编辑后得到的结果是一个 html 字符串</li></ul><h2 id="五-补充" tabindex="-1"><a class="header-anchor" href="#五-补充" aria-hidden="true">#</a> （五）补充</h2><h3 id="_1-websocket-原理" tabindex="-1"><a class="header-anchor" href="#_1-websocket-原理" aria-hidden="true">#</a> 1.WebSocket 原理</h3><h4 id="_1-socket" tabindex="-1"><a class="header-anchor" href="#_1-socket" aria-hidden="true">#</a> 1）Socket</h4><ul><li>客户端连接服务器（TCP / IP），三次握手，建立了连接通道</li><li>客户端和服务器通过 socket 接口发送消息和接收消息 <ul><li>任何一端在任何时候，都可以向另一端发送任何消息</li></ul></li><li>有一端断开了，通道销毁</li></ul><h4 id="_2-http" tabindex="-1"><a class="header-anchor" href="#_2-http" aria-hidden="true">#</a> 2）HTTP</h4><ul><li>客户端连接服务器（TCP / IP），三次握手，建立了连接通道</li><li>客户端发送一个 http 格式的消息（消息头 消息体），服务器响应 http 格式的消息（消息头 消息体）</li><li>客户端或服务器断开，通道销毁</li></ul><h4 id="_4-实时性的问题" tabindex="-1"><a class="header-anchor" href="#_4-实时性的问题" aria-hidden="true">#</a> 4）实时性的问题</h4><ul><li>轮询</li><li>长连接</li></ul><h4 id="_5-websocket" tabindex="-1"><a class="header-anchor" href="#_5-websocket" aria-hidden="true">#</a> 5）WebSocket</h4><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>专门用于解决实时传输的问题</p></div><ul><li>客户端连接服务器（TCP / IP），三次握手，建立了连接通道</li><li>客户端发送一个 http 格式的消息（特殊格式），服务器也响应一个 http 格式的消息（特殊格式），称之为 http 握手</li><li>双发自由通信，通信格式按照 websocket 的要求进行</li><li>客户端或服务器断开，通道销毁</li></ul><h4 id="_6-服务端的握手响应" tabindex="-1"><a class="header-anchor" href="#_6-服务端的握手响应" aria-hidden="true">#</a> 6）服务端的握手响应</h4><ul><li>在 websocket 的 http 握手阶段，服务器响应头中需要包含如下内容</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Upgrade</span><span class="token punctuation">:</span> websocket
<span class="token key atrule">Connection</span><span class="token punctuation">:</span> Upgrade
<span class="token key atrule">Sec-WebSocket-Accept</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>key<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>Sec-WebSocket-Accept</code> 来自于以下算法</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">base64</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span>Sec <span class="token operator">-</span> WebSocket <span class="token operator">-</span> Key<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在 node 中可以使用以下代码获得</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;crypto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">&quot;sha1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>requestKey <span class="token operator">+</span> <span class="token string">&quot;258EAFA5-E914-47DA-95CA-C5AB0DC85B11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> key <span class="token operator">=</span> hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">&quot;base64&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>requestKey</code> 来自于请求头中的 <code>Sec-WebSocket-Key</code></li></ul><h3 id="_2-socket-io" tabindex="-1"><a class="header-anchor" href="#_2-socket-io" aria-hidden="true">#</a> 2.socket.io</h3><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span>发送数据到服务器<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdn.bootcdn.net/ajax/libs/socket.io/2.3.0/socket.io.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">const</span> socket <span class="token operator">=</span> io<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;button&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;msg from client&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">chunk</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;disconnect&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;closed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-在线聊天室" tabindex="-1"><a class="header-anchor" href="#_3-在线聊天室" aria-hidden="true">#</a> 3.在线聊天室</h3><h4 id="_1-客户端发送" tabindex="-1"><a class="header-anchor" href="#_1-客户端发送" aria-hidden="true">#</a> 1）客户端发送</h4><ul><li>获取当前所有在线用户 <ul><li>消息名称：users</li><li>消息内容：无</li></ul></li><li>登录 <ul><li>消息名称：login</li><li>消息内容：用户名</li></ul></li><li>消息 <ul><li>消息名称：msg</li><li>消息内容：<code>{to:&quot;目标用户名，null表示所有人&quot;, content:&quot;消息内容&quot;}</code></li></ul></li></ul><h4 id="_2-服务器发送" tabindex="-1"><a class="header-anchor" href="#_2-服务器发送" aria-hidden="true">#</a> 2）服务器发送</h4><ul><li>获取当前所有在线用户 <ul><li>消息名称：users</li><li>消息内容：用户数组</li></ul></li><li>登录 <ul><li>消息名称：login</li><li>消息内容：true 或 false <ul><li>true 表示登录成功</li><li>false 表示登录失败（昵称已存在）</li></ul></li></ul></li><li>新用户进入 <ul><li>消息名称：userin</li><li>消息内容：用户名</li></ul></li><li>用户离开 <ul><li>消息名称：userout</li><li>消息内容：用户名</li></ul></li><li>新消息来了 <ul><li>消息名称：new msg</li><li>消息内容：<code>{from:&quot;用户名&quot;, content:&quot;消息内容&quot;, to:&quot;接收消息的人，如果是null，表示所有人&quot;}</code></li></ul></li></ul><h3 id="_4-csrf-攻击和防御" tabindex="-1"><a class="header-anchor" href="#_4-csrf-攻击和防御" aria-hidden="true">#</a> 4.CSRF 攻击和防御</h3><h4 id="_1-csrf-特点和原理" tabindex="-1"><a class="header-anchor" href="#_1-csrf-特点和原理" aria-hidden="true">#</a> 1）CSRF 特点和原理</h4><ul><li>CSRF，Cross Site Request Forgery，跨站请求伪造</li><li>本质是：恶意网站把正常用户作为媒介，通过模拟正常用户的操作，攻击其登录过的站点</li></ul><p><img src="/assets/Node60-31757917.png" alt=""></p><ul><li>用户访问正常站点，登录后，获取到正常站点的令牌，以 cookie 的形式保存</li></ul><p><img src="/assets/Node61-845153ad.png" alt=""></p><ul><li>用户访问恶意站点，恶意站点通过某种形式去请求正常站点（请求伪造），迫使正常用户把令牌传递到正常站点，完成攻击</li></ul><p><img src="/assets/Node62-c527520d.png" alt=""></p><h4 id="_2-防御-cookie-的-samesite" tabindex="-1"><a class="header-anchor" href="#_2-防御-cookie-的-samesite" aria-hidden="true">#</a> 2）防御：cookie 的 SameSite</h4><ul><li>现在很多浏览器都支持 <mark>禁止跨域附带的 cookie</mark></li><li>只需要把 cookie 设置的 <code>SameSite</code> 设置为 <code>Strict</code> 即可</li><li>这种方法非常简单，极其有效，但前提条件是：用户不能使用太旧的浏览器</li></ul><table><thead><tr><th>SamSite 取值</th><th>说明</th></tr></thead><tbody><tr><td>Strict</td><td>严格，所有跨站请求都不附带 cookie，有时会导致用户体验不好</td></tr><tr><td>Lax</td><td>宽松，所有跨站的超链接、GET 请求的表单、预加载连接时会发送 cookie，其他情况不发送</td></tr><tr><td>None</td><td>无限制</td></tr></tbody></table><h4 id="_3-防御-验证-referer-和-origin" tabindex="-1"><a class="header-anchor" href="#_3-防御-验证-referer-和-origin" aria-hidden="true">#</a> 3）防御：验证 referer 和 Origin</h4><ul><li>页面中的二次请求都会附带 referer 或 Origin 请求头</li><li>向服务器表示该请求来自于哪个源或页面，服务器可以通过这个头进行验证</li><li>但某些浏览器的 referer 是可以被用户禁止的，尽管这种情况极少</li></ul><h4 id="_4-防御-使用非-cookie-令牌" tabindex="-1"><a class="header-anchor" href="#_4-防御-使用非-cookie-令牌" aria-hidden="true">#</a> 4）防御：使用非 cookie 令牌</h4><ul><li>要求每次请求需要在请求体或请求头中附带 token</li><li>请求的时候：<code>authorization: token</code></li></ul><h4 id="_5-防御-验证码" tabindex="-1"><a class="header-anchor" href="#_5-防御-验证码" aria-hidden="true">#</a> 5）防御：验证码</h4><ul><li>要求每个要防止 CSRF 的请求都必须要附带验证码</li><li>容易把正常的用户逼疯</li></ul><h4 id="_6-防御-表单随机数" tabindex="-1"><a class="header-anchor" href="#_6-防御-表单随机数" aria-hidden="true">#</a> 6）防御：表单随机数</h4><ul><li>服务端渲染时，生成一个随机数</li><li>客户端提交时要提交这个随机数，然后服务器端进行对比</li><li>该随机数是一次性的</li><li>流程 <ul><li>客户端请求服务器，请求添加学生的页面，传递 cookie</li><li>服务器 <ul><li>生成一个随机数，放到 session 中</li><li>生成页面时，表单中加入一个隐藏的表单域</li><li><code>&lt;input type=&quot;hidden&quot; name=&quot;hash&quot; value=&quot;&lt;%=session[&#39;key&#39;] %&gt;&quot;&gt;</code></li></ul></li><li>填写好信息后，提交表单，会自动提交隐藏的随机数</li><li>服务器 <ul><li>先拿到 cookie，判断是否登录过</li><li>对比提交过来的随机数和之前的随机数是否一致</li><li>清除掉 session 中的随机数</li></ul></li></ul></li></ul><h4 id="_7-防御-二次验证" tabindex="-1"><a class="header-anchor" href="#_7-防御-二次验证" aria-hidden="true">#</a> 7）防御：二次验证</h4><ul><li>当做出敏感操作时，进行二次验证</li></ul><h3 id="_5-xss-攻击和防御" tabindex="-1"><a class="header-anchor" href="#_5-xss-攻击和防御" aria-hidden="true">#</a> 5.XSS 攻击和防御</h3><ul><li>XSS，Cross Site Scripting，跨站脚本攻击</li></ul><h4 id="_1-存储型-xss" tabindex="-1"><a class="header-anchor" href="#_1-存储型-xss" aria-hidden="true">#</a> 1）存储型 XSS</h4><ul><li>恶意用户提交了恶意内容到服务器</li><li>服务器没有识别，保存了恶意内容到数据库</li><li>正常用户访问服务器</li><li>服务器在不知情的情况下，给予了之前的恶意内容，让正常用户遭到攻击</li></ul><h4 id="_2-反射型-xss" tabindex="-1"><a class="header-anchor" href="#_2-反射型-xss" aria-hidden="true">#</a> 2）反射型 XSS</h4><ul><li>恶意用户分享了一个正常网站的链接，链接中带有恶意内容</li><li>正常用户点击了该链接</li><li>服务器在不知情的情况，把链接的恶意内容读取了出来，放进了页面中，让正常用户遭到攻击</li></ul><h4 id="_3-dom-型-xss" tabindex="-1"><a class="header-anchor" href="#_3-dom-型-xss" aria-hidden="true">#</a> 3）DOM 型 XSS</h4><ul><li>恶意用户通过任何方式，向服务器中注入了一些 dom 元素，从而影响了服务器的 dom 结构</li><li>普通用户访问时，运行的是服务器的正常 js 代码</li></ul><h3 id="_6-nodejs-组成原理" tabindex="-1"><a class="header-anchor" href="#_6-nodejs-组成原理" aria-hidden="true">#</a> 6.NodeJS 组成原理</h3><p><img src="/assets/Node63-9cb4216f.png" alt=""></p><h4 id="_1-用户代码" tabindex="-1"><a class="header-anchor" href="#_1-用户代码" aria-hidden="true">#</a> 1）用户代码</h4><ul><li>JS 代码，开发者编写的</li></ul><h4 id="_2-第三方库" tabindex="-1"><a class="header-anchor" href="#_2-第三方库" aria-hidden="true">#</a> 2）第三方库</h4><ul><li>大部分仍然是 JS 代码，由其他开发者编写</li></ul><h4 id="_3-本地模块代码" tabindex="-1"><a class="header-anchor" href="#_3-本地模块代码" aria-hidden="true">#</a> 3）本地模块代码</h4><ul><li>JS 代码</li></ul><h4 id="_4-v8-引擎" tabindex="-1"><a class="header-anchor" href="#_4-v8-引擎" aria-hidden="true">#</a> 4）V8 引擎</h4><ul><li>C/C++代码</li><li>作用：把 JS 代码解释成为机器码</li><li>可以通过 V8 引擎的某种机制，扩展其功能</li><li>V8 引擎的扩展和对扩展的编译是通过 gyp 工具</li><li>某些第三方库需要使用 <code>node-gyp</code> 工具进行构建，因此需要先安装 <code>node-gyp</code></li></ul><h3 id="_7-进程和线程" tabindex="-1"><a class="header-anchor" href="#_7-进程和线程" aria-hidden="true">#</a> 7.进程和线程</h3><h4 id="_1-进程" tabindex="-1"><a class="header-anchor" href="#_1-进程" aria-hidden="true">#</a> 1）进程</h4><ul><li>一个应用程序，总是通过操作系统启动的，当操作系统启动一个应用程序时，会给其分配一个进程</li><li>一个进程拥有 <mark>独立的、可伸缩的</mark> 内存空间，原则上不受其他进程干扰</li><li>进程之间是可以通信的，只要两个进程双方遵守一定的协议，如：IPC</li></ul><div class="hint-container danger"><p class="hint-container-title">警告</p><p>CPU 在不同的进程之间切换执行</p></div><ul><li>虽然一个应用程序在启动时只有一个进程，但在运行的过程中，可以开启新的进程，进程之间仍然保持相对独立</li><li>如果一个进程是直接由操作系统开启，则叫做主进程</li><li>如果一个进程 B 是由进程 A 开启，则 A 是 B 的父进程，B 是 A 的子进程 <ul><li>子进程会继承父进程的一些信息，但仍然保持相对独立</li></ul></li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// nodejs 中开启子进程</span>
<span class="token keyword">const</span> childProcess <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;child_process&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 导入内置模块</span>

childProcess<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>在子进程运行的命令<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> out<span class="token punctuation">,</span> stdErr</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
   * 回调函数中可以获取子进程的标准输出，这种数据交互是通过IPC完成的，nodejs已经完成了处理
   * err：开启进程过程中发生的错误
   * out: 子进程输出的正常内容
   * stdErr: 子进程输出的错误内容
   * 子进程发生任何的错误，绝不会影响到父进程，它们的内存空间是完全隔离的
   */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><ul><li>过去，nodejs 没有提供给用户创建线程的接口，只能使用进程的方式</li><li>过去，nodejs 还提供了 cluster 模块，通过另一种模式来创建进程</li><li>现在，nodejs 提供了线程模块，对进程的操作已经很少使用了</li></ul></div><h4 id="_2-线程" tabindex="-1"><a class="header-anchor" href="#_2-线程" aria-hidden="true">#</a> 2）线程</h4><ul><li>操作系统启动一个进程（无论是主进程，还是子进程），都会自动为它分配一个线程，称之为主线程 <ul><li>主线程在运行的过程中，可以创建多个线程，这些线程称之为子线程</li></ul></li><li>当操作系统命令 CPU 去执行一个进程时，实际上，是在该进程的多个线程中切换执行</li></ul><div class="hint-container danger"><p class="hint-container-title">警告</p><p>程序一定在线程上运行</p></div><ul><li>线程和进程很相似，它们都是独立运行</li><li>最大的区别在于：<mark>线程的内存空间没有隔离</mark>，共享进程的内存空间，线程之间的数据不用遵守任何协议，可以随意使用</li><li>使用线程的主要目的，是为了充分使用多核 CPU</li><li>线程执行过程中，尽量的不要阻塞</li></ul><div class="hint-container tip"><p class="hint-container-title">最理想的线程效果</p><ul><li>线程数等于 CPU 的核数</li><li>线程永不阻塞 <ul><li>没有 IO</li><li>只存在大量运算</li></ul></li><li>线程相对独立，几乎不使用共享数据</li></ul></div><ul><li>线程一般处理 CPU 密集型操作（运算操作）</li><li>而 IO 密集型操作不适合使用线程，适合使用异步</li><li>为了避免线程执行过程中共享数据产生的麻烦，nodejs 使用独特的线程机制来尽力规避</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 创建子线程的父线程</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Worker <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;worker_threads&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span>线程执行的入口文件<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">workerData</span><span class="token operator">:</span> 开启线程时向其传递的数据<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// worker是子线程实例</span>

<span class="token comment">// 通过EventEmitter监听子线程的事件</span>
worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;exit&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当子线程退出时运行的事件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 收到子线程发送的消息时运行的事件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>任意消息<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 父线程向子线程发送任意消息</span>
worker<span class="token punctuation">.</span><span class="token function">terminate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 退出子线程</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  isMainThread<span class="token punctuation">,</span> <span class="token comment">// 是否是主线程</span>
  parentPort<span class="token punctuation">,</span> <span class="token comment">// 用于与父线程通信的端口</span>
  workerData<span class="token punctuation">,</span> <span class="token comment">// 获取线程启动时传递的数据</span>
  threadId<span class="token punctuation">,</span> <span class="token comment">// 获取线程的唯一编号</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;worker_threads&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

parentPort<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当收到父线程发送的消息时，触发的事件</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
parentPort<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>workerData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 向父线程发送消息</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><!----><!----></div></footer><nav class="page-nav"><a href="/notes/DuYi/03Strengthen/01.html" class="nav-link prev" aria-label="一、前端必会算法"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->一、前端必会算法</div></a><!----></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed | Copyright © 2022-present <a href="/aboutMe">郁子IKUKO</a></div><!----></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-76ddb839.js" defer></script>
  </body>
</html>
